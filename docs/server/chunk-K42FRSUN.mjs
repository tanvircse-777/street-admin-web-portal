import './polyfills.server.mjs';
import{$ as j0,$a as K0,A as y2,B as P0,Ba as v8,C as b2,Ca as G0,D as pe,E as ge,G as o1,Ga as $0,H as r1,I as d4,K as j,L as a1,M as H,Ma as m4,Na as m8,P as W1,R as q0,Ra as p8,S as C2,T as g,Ta as H2,X as U0,_ as f4,ab as Y0,b as j1,c as k1,ca as W0,d as w2,e as T0,eb as x2,f as h4,fa as T,fb as Q0,g as D4,h as u4,ha as V2,i as w1,ia as v4,j as G,k as A0,ka as E1,l as me,la as D1,m as N4,mb as S2,n as O0,o as I0,oa as _e,p as k0,q as B0,r as D0,s as N0,t as h8,u as M2,ua as f8,v as u8,w as R0,x as B1,y as d8,ya as E2,z as F0}from"./chunk-IXDV25ZN.mjs";import{A as an,B as we,C as K,D as N1,E as O2,F as z8,G as ln,H as F4,I as Me,J as hn,K as un,L as $1,M as t1,a as f,b as R4,c as T2,d as Z0,e as X0,f as P,g as J0,h as g8,i as en,j as H1,k as tn,l as nn,m as L2,n as D,o as sn,p as cn,q as m1,r as G1,s as A2,t as ze,u as on,v as rn,w as _,x as e1,y as N,z as _8}from"./chunk-UMWUTMKF.mjs";import{b as L0}from"./chunk-7ZPQ2KLE.mjs";import{a as F,b as v1,c as S,f as E,h as Io,j as V1}from"./chunk-H6KHSOBK.mjs";var S1=E((n6,T5)=>{"use strict";var i3=S("buffer"),x1=i3.Buffer;function S5(t,e){for(var n in t)e[n]=t[n]}x1.from&&x1.alloc&&x1.allocUnsafe&&x1.allocUnsafeSlow?T5.exports=i3:(S5(i3,n6),n6.Buffer=w4);function w4(t,e,n){return x1(t,e,n)}w4.prototype=Object.create(x1.prototype);S5(x1,w4);w4.from=function(t,e,n){if(typeof t=="number")throw new TypeError("Argument must not be a number");return x1(t,e,n)};w4.alloc=function(t,e,n){if(typeof t!="number")throw new TypeError("Argument must be a number");var i=x1(t);return e!==void 0?typeof n=="string"?i.fill(e,n):i.fill(e):i.fill(0),i};w4.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return x1(t)};w4.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return i3.SlowBuffer(t)}});var O5=E(i6=>{"use strict";var L5=S("stream").Stream,A5=S("util"),M4=function(t){this.readable=this.writable=!0,this._paused=!1,this._driver=t};A5.inherits(M4,L5);M4.prototype.pause=function(){this._paused=!0,this._driver.messages._paused=!0};M4.prototype.resume=function(){this._paused=!1,this.emit("drain");var t=this._driver.messages;t._paused=!1,t.emit("drain")};M4.prototype.write=function(t){return this.writable?(this._driver.parse(t),!this._paused):!1};M4.prototype.end=function(t){if(this.writable){t!==void 0&&this.write(t),this.writable=!1;var e=this._driver.messages;e.readable&&(e.readable=e.writable=!1,e.emit("end"))}};M4.prototype.destroy=function(){this.end()};var y4=function(t){this.readable=this.writable=!0,this._paused=!1,this._driver=t};A5.inherits(y4,L5);y4.prototype.pause=function(){this._driver.io._paused=!0};y4.prototype.resume=function(){this._driver.io._paused=!1,this._driver.io.emit("drain")};y4.prototype.write=function(t){return this.writable?(typeof t=="string"?this._driver.text(t):this._driver.binary(t),!this._paused):!1};y4.prototype.end=function(t){t!==void 0&&this.write(t)};y4.prototype.destroy=function(){};i6.IO=M4;i6.Messages=y4});var s3=E((ym,I5)=>{"use strict";var K4=function(){this.clear()};K4.prototype.ALLOWED_DUPLICATES=["set-cookie","set-cookie2","warning","www-authenticate"];K4.prototype.clear=function(){this._sent={},this._lines=[]};K4.prototype.set=function(t,e){if(e!==void 0){t=this._strip(t),e=this._strip(e);var n=t.toLowerCase();(!this._sent.hasOwnProperty(n)||this.ALLOWED_DUPLICATES.indexOf(n)>=0)&&(this._sent[n]=!0,this._lines.push(t+": "+e+`\r
`))}};K4.prototype.toString=function(){return this._lines.join("")};K4.prototype._strip=function(t){return t.toString().replace(/^ */,"").replace(/ *$/,"")};I5.exports=K4});var B5=E((bm,k5)=>{"use strict";var c3=S1().Buffer,o3=function(){this._queue=[],this._queueSize=0,this._offset=0};o3.prototype.put=function(t){!t||t.length===0||(c3.isBuffer(t)||(t=c3.from(t)),this._queue.push(t),this._queueSize+=t.length)};o3.prototype.read=function(t){if(t>this._queueSize)return null;if(t===0)return c3.alloc(0);this._queueSize-=t;var e=this._queue,n=t,i=e[0],s,c;if(i.length>=t)return i.length===t?e.shift():(c=i.slice(0,t),e[0]=i.slice(t),c);for(var o=0,r=e.length;o<r&&!(n<e[o].length);o++)n-=e[o].length;return s=e.splice(0,o),n>0&&e.length>0&&(s.push(e[0].slice(0,n)),e[0]=e[0].slice(n)),c3.concat(s,t)};o3.prototype.eachByte=function(t,e){for(var n,i,s;this._queue.length>0;){for(n=this._queue[0],i=n.length;this._offset<i;)s=this._offset,this._offset+=1,t.call(e,n[s]);this._offset=0,this._queue.shift()}};k5.exports=o3});var X1=E((Cm,q5)=>{"use strict";var D5=S1().Buffer,F5=S("events").EventEmitter,ja=S("util"),N5=O5(),P5=s3(),Wa=B5(),Y=function(t,e,n){F5.call(this),Y.validateOptions(n||{},["maxLength","masking","requireMasking","protocols"]),this._request=t,this._reader=new Wa,this._options=n||{},this._maxLength=this._options.maxLength||this.MAX_LENGTH,this._headers=new P5,this.__queue=[],this.readyState=0,this.url=e,this.io=new N5.IO(this),this.messages=new N5.Messages(this),this._bindEventListeners()};ja.inherits(Y,F5);Y.isWebSocket=function(t){var e=t.headers.connection||"",n=t.headers.upgrade||"";return t.method==="GET"&&e.toLowerCase().split(/ *, */).indexOf("upgrade")>=0&&n.toLowerCase()==="websocket"};Y.validateOptions=function(t,e){for(var n in t)if(e.indexOf(n)<0)throw new Error("Unrecognized option: "+n)};var R5={MAX_LENGTH:67108863,STATES:["connecting","open","closing","closed"],_bindEventListeners:function(){var t=this;this.messages.on("error",function(){}),this.on("message",function(e){var n=t.messages;n.readable&&n.emit("data",e.data)}),this.on("error",function(e){var n=t.messages;n.readable&&n.emit("error",e)}),this.on("close",function(){var e=t.messages;e.readable&&(e.readable=e.writable=!1,e.emit("end"))})},getState:function(){return this.STATES[this.readyState]||null},addExtension:function(t){return!1},setHeader:function(t,e){return this.readyState>0?!1:(this._headers.set(t,e),!0)},start:function(){if(this.readyState!==0)return!1;if(!Y.isWebSocket(this._request))return this._failHandshake(new Error("Not a WebSocket request"));var t;try{t=this._handshakeResponse()}catch(e){return this._failHandshake(e)}return this._write(t),this._stage!==-1&&this._open(),!0},_failHandshake:function(t){var e=new P5;return e.set("Content-Type","text/plain"),e.set("Content-Length",D5.byteLength(t.message,"utf8")),e=["HTTP/1.1 400 Bad Request",e.toString(),t.message],this._write(D5.from(e.join(`\r
`),"utf8")),this._fail("protocol_error",t.message),!1},text:function(t){return this.frame(t)},binary:function(t){return!1},ping:function(){return!1},pong:function(){return!1},close:function(t,e){return this.readyState!==1?!1:(this.readyState=3,this.emit("close",new Y.CloseEvent(null,null)),!0)},_open:function(){this.readyState=1,this.__queue.forEach(function(t){this.frame.apply(this,t)},this),this.__queue=[],this.emit("open",new Y.OpenEvent)},_queue:function(t){return this.__queue.push(t),!0},_write:function(t){var e=this.io;e.readable&&e.emit("data",t)},_fail:function(t,e){this.readyState=2,this.emit("error",new Error(e)),this.close()}};for(s6 in R5)Y.prototype[s6]=R5[s6];var s6;Y.ConnectEvent=function(){};Y.OpenEvent=function(){};Y.CloseEvent=function(t,e){this.code=t,this.reason=e};Y.MessageEvent=function(t){this.data=t};Y.PingEvent=function(t){this.data=t};Y.PongEvent=function(t){this.data=t};q5.exports=Y});var $5=E(a6=>{"use strict";var o6=S("assert");a6.HTTPParser=p;function p(t){o6.ok(t===p.REQUEST||t===p.RESPONSE||t===void 0),t===void 0||this.initialize(t),this.maxHeaderSize=p.maxHeaderSize}p.prototype.initialize=function(t,e){o6.ok(t===p.REQUEST||t===p.RESPONSE),this.type=t,this.state=t+"_LINE",this.info={headers:[],upgrade:!1},this.trailers=[],this.line="",this.isChunked=!1,this.connection="",this.headerSize=0,this.body_bytes=null,this.isUserCall=!1,this.hadError=!1};p.encoding="ascii";p.maxHeaderSize=80*1024;p.REQUEST="REQUEST";p.RESPONSE="RESPONSE";var U5=p.kOnHeaders=1,c6=p.kOnHeadersComplete=2,r3=p.kOnBody=3,r6=p.kOnMessageComplete=4;p.prototype[U5]=p.prototype[c6]=p.prototype[r3]=p.prototype[r6]=function(){};var j5=!0;Object.defineProperty(p,"kOnExecute",{get:function(){return j5=!1,99}});var W5=a6.methods=p.methods=["DELETE","GET","HEAD","POST","PUT","CONNECT","OPTIONS","TRACE","COPY","LOCK","MKCOL","MOVE","PROPFIND","PROPPATCH","SEARCH","UNLOCK","BIND","REBIND","UNBIND","ACL","REPORT","MKACTIVITY","CHECKOUT","MERGE","M-SEARCH","NOTIFY","SUBSCRIBE","UNSUBSCRIBE","PATCH","PURGE","MKCALENDAR","LINK","UNLINK","SOURCE"],G5=W5.indexOf("CONNECT");p.prototype.reinitialize=p;p.prototype.close=p.prototype.pause=p.prototype.resume=p.prototype.free=function(){};p.prototype._compatMode0_11=!1;p.prototype.getAsyncId=function(){return 0};var Ga={REQUEST_LINE:!0,RESPONSE_LINE:!0,HEADER:!0};p.prototype.execute=function(t,e,n){if(!(this instanceof p))throw new TypeError("not a HTTPParser");e=e||0,n=typeof n=="number"?n:t.length,this.chunk=t,this.offset=e;var i=this.end=e+n;try{for(;this.offset<i&&!this[this.state](););}catch(s){if(this.isUserCall)throw s;return this.hadError=!0,s}return this.chunk=null,n=this.offset-e,Ga[this.state]&&(this.headerSize+=n,this.headerSize>(this.maxHeaderSize||p.maxHeaderSize))?new Error("max header size exceeded"):n};var $a={REQUEST_LINE:!0,RESPONSE_LINE:!0,BODY_RAW:!0};p.prototype.finish=function(){if(!this.hadError){if(!$a[this.state])return new Error("invalid state for EOF");this.state==="BODY_RAW"&&this.userCall()(this[r6]())}};p.prototype.consume=p.prototype.unconsume=p.prototype.getCurrentBuffer=function(){};p.prototype.userCall=function(){this.isUserCall=!0;var t=this;return function(e){return t.isUserCall=!1,e}};p.prototype.nextRequest=function(){this.userCall()(this[r6]()),this.reinitialize(this.type)};p.prototype.consumeLine=function(){for(var t=this.end,e=this.chunk,n=this.offset;n<t;n++)if(e[n]===10){var i=this.line+e.toString(p.encoding,this.offset,n);return i.charAt(i.length-1)==="\r"&&(i=i.substr(0,i.length-1)),this.line="",this.offset=n+1,i}this.line+=e.toString(p.encoding,this.offset,this.end),this.offset=this.end};var Ka=/^([^: \t]+):[ \t]*((?:.*[^ \t])|)/,Ya=/^[ \t]+(.*[^ \t])/;p.prototype.parseHeader=function(t,e){if(t.indexOf("\r")!==-1)throw a3("HPE_LF_EXPECTED");var n=Ka.exec(t),i=n&&n[1];if(i)e.push(i),e.push(n[2]);else{var s=Ya.exec(t);s&&e.length&&(e[e.length-1]&&(e[e.length-1]+=" "),e[e.length-1]+=s[1])}};var Qa=/^([A-Z-]+) ([^ ]+) HTTP\/(\d)\.(\d)$/;p.prototype.REQUEST_LINE=function(){var t=this.consumeLine();if(t){var e=Qa.exec(t);if(e===null)throw a3("HPE_INVALID_CONSTANT");if(this.info.method=this._compatMode0_11?e[1]:W5.indexOf(e[1]),this.info.method===-1)throw new Error("invalid request method");this.info.url=e[2],this.info.versionMajor=+e[3],this.info.versionMinor=+e[4],this.body_bytes=0,this.state="HEADER"}};var Za=/^HTTP\/(\d)\.(\d) (\d{3}) ?(.*)$/;p.prototype.RESPONSE_LINE=function(){var t=this.consumeLine();if(t){var e=Za.exec(t);if(e===null)throw a3("HPE_INVALID_CONSTANT");this.info.versionMajor=+e[1],this.info.versionMinor=+e[2];var n=this.info.statusCode=+e[3];this.info.statusMessage=e[4],((n/100|0)===1||n===204||n===304)&&(this.body_bytes=0),this.state="HEADER"}};p.prototype.shouldKeepAlive=function(){if(this.info.versionMajor>0&&this.info.versionMinor>0){if(this.connection.indexOf("close")!==-1)return!1}else if(this.connection.indexOf("keep-alive")===-1)return!1;return!!(this.body_bytes!==null||this.isChunked)};p.prototype.HEADER=function(){var t=this.consumeLine();if(t!==void 0){var e=this.info;if(t)this.parseHeader(t,e.headers);else{for(var n=e.headers,i=!1,s,c=!1,o=0;o<n.length;o+=2)switch(n[o].toLowerCase()){case"transfer-encoding":this.isChunked=n[o+1].toLowerCase()==="chunked";break;case"content-length":if(s=+n[o+1],i){if(s!==this.body_bytes)throw a3("HPE_UNEXPECTED_CONTENT_LENGTH")}else i=!0,this.body_bytes=s;break;case"connection":this.connection+=n[o+1].toLowerCase();break;case"upgrade":c=!0;break}this.isChunked&&i&&(i=!1,this.body_bytes=null),c&&this.connection.indexOf("upgrade")!=-1?e.upgrade=this.type===p.REQUEST||e.statusCode===101:e.upgrade=e.method===G5,this.isChunked&&e.upgrade&&(this.isChunked=!1),e.shouldKeepAlive=this.shouldKeepAlive();var r;if(j5?r=this.userCall()(this[c6](e)):r=this.userCall()(this[c6](e.versionMajor,e.versionMinor,e.headers,e.method,e.url,e.statusCode,e.statusMessage,e.upgrade,e.shouldKeepAlive)),r===2)return this.nextRequest(),!0;if(this.isChunked&&!r)this.state="BODY_CHUNKHEAD";else{if(r||this.body_bytes===0)return this.nextRequest(),e.upgrade;this.body_bytes===null?this.state="BODY_RAW":this.state="BODY_SIZED"}}}};p.prototype.BODY_CHUNKHEAD=function(){var t=this.consumeLine();t!==void 0&&(this.body_bytes=parseInt(t,16),this.body_bytes?this.state="BODY_CHUNK":this.state="BODY_CHUNKTRAILERS")};p.prototype.BODY_CHUNK=function(){var t=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[r3](this.chunk,this.offset,t)),this.offset+=t,this.body_bytes-=t,this.body_bytes||(this.state="BODY_CHUNKEMPTYLINE")};p.prototype.BODY_CHUNKEMPTYLINE=function(){var t=this.consumeLine();t!==void 0&&(o6.equal(t,""),this.state="BODY_CHUNKHEAD")};p.prototype.BODY_CHUNKTRAILERS=function(){var t=this.consumeLine();t!==void 0&&(t?this.parseHeader(t,this.trailers):(this.trailers.length&&this.userCall()(this[U5](this.trailers,"")),this.nextRequest()))};p.prototype.BODY_RAW=function(){var t=this.end-this.offset;this.userCall()(this[r3](this.chunk,this.offset,t)),this.offset=this.end};p.prototype.BODY_SIZED=function(){var t=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[r3](this.chunk,this.offset,t)),this.offset+=t,this.body_bytes-=t,this.body_bytes||this.nextRequest()};["Headers","HeadersComplete","Body","MessageComplete"].forEach(function(t){var e=p["kOn"+t];Object.defineProperty(p.prototype,"on"+t,{get:function(){return this[e]},set:function(n){return this._compatMode0_11=!0,G5="CONNECT",this[e]=n}})});function a3(t){var e=new Error("Parse Error");return e.code=t,e}});var h3=E((Em,Y5)=>{"use strict";var l3=$5().HTTPParser,Xa=S1().Buffer,Ja={request:l3.REQUEST||"request",response:l3.RESPONSE||"response"},Q=function(t){this._type=t,this._parser=new l3(Ja[t]),this._complete=!1,this.headers={};var e=null,n=this;this._parser.onHeaderField=function(i,s,c){e=i.toString("utf8",s,s+c).toLowerCase()},this._parser.onHeaderValue=function(i,s,c){var o=i.toString("utf8",s,s+c);n.headers.hasOwnProperty(e)?n.headers[e]+=", "+o:n.headers[e]=o},this._parser.onHeadersComplete=this._parser[l3.kOnHeadersComplete]=function(i,s,c,o,r,a){var l=arguments[0];if(typeof l=="object"&&(o=l.method,r=l.url,a=l.statusCode,c=l.headers),n.method=typeof o=="number"?Q.METHODS[o]:o,n.statusCode=a,n.url=r,!!c){for(var h=0,u=c.length,d,v;h<u;h+=2)d=c[h].toLowerCase(),v=c[h+1],n.headers.hasOwnProperty(d)?n.headers[d]+=", "+v:n.headers[d]=v;n._complete=!0}}};Q.METHODS={0:"DELETE",1:"GET",2:"HEAD",3:"POST",4:"PUT",5:"CONNECT",6:"OPTIONS",7:"TRACE",8:"COPY",9:"LOCK",10:"MKCOL",11:"MOVE",12:"PROPFIND",13:"PROPPATCH",14:"SEARCH",15:"UNLOCK",16:"BIND",17:"REBIND",18:"UNBIND",19:"ACL",20:"REPORT",21:"MKACTIVITY",22:"CHECKOUT",23:"MERGE",24:"M-SEARCH",25:"NOTIFY",26:"SUBSCRIBE",27:"UNSUBSCRIBE",28:"PATCH",29:"PURGE",30:"MKCALENDAR",31:"LINK",32:"UNLINK"};var K5=process.version?process.version.match(/[0-9]+/g).map(function(t){return parseInt(t,10)}):[];K5[0]===0&&K5[1]===12&&(Q.METHODS[16]="REPORT",Q.METHODS[17]="MKACTIVITY",Q.METHODS[18]="CHECKOUT",Q.METHODS[19]="MERGE",Q.METHODS[20]="M-SEARCH",Q.METHODS[21]="NOTIFY",Q.METHODS[22]="SUBSCRIBE",Q.METHODS[23]="UNSUBSCRIBE",Q.METHODS[24]="PATCH",Q.METHODS[25]="PURGE");Q.prototype.isComplete=function(){return this._complete};Q.prototype.parse=function(t){var e=this._parser.execute(t,0,t.length);if(typeof e!="number"){this.error=e,this._complete=!0;return}this._complete&&(this.body=e<t.length?t.slice(e):Xa.alloc(0))};Y5.exports=Q});var X5=E((Hm,Z5)=>{"use strict";var l6=/([!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+)/,el=/([^!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z])/g,tl=/"((?:\\[\x00-\x7f]|[^\x00-\x08\x0a-\x1f\x7f"\\])*)"/,h6=new RegExp(l6.source+"(?:=(?:"+l6.source+"|"+tl.source+"))?"),u6=new RegExp(l6.source+"(?: *; *"+h6.source+")*","g"),nl=new RegExp("^"+u6.source+"(?: *, *"+u6.source+")*$"),il=/^-?(0|[1-9][0-9]*)(\.[0-9]+)?$/,Q5=Object.prototype.hasOwnProperty,sl={parseHeader:function(t){var e=new Te;if(t===""||t===void 0)return e;if(!nl.test(t))throw new SyntaxError("Invalid Sec-WebSocket-Extensions header: "+t);var n=t.match(u6);return n.forEach(function(i){var s=i.match(new RegExp(h6.source,"g")),c=s.shift(),o={};s.forEach(function(r){var a=r.match(h6),l=a[1],h;a[2]!==void 0?h=a[2]:a[3]!==void 0?h=a[3].replace(/\\/g,""):h=!0,il.test(h)&&(h=parseFloat(h)),Q5.call(o,l)?(o[l]=[].concat(o[l]),o[l].push(h)):o[l]=h},this),e.push(c,o)},this),e},serializeParams:function(t,e){var n=[],i=function(c,o){o instanceof Array?o.forEach(function(r){i(c,r)}):o===!0?n.push(c):typeof o=="number"?n.push(c+"="+o):el.test(o)?n.push(c+'="'+o.replace(/"/g,'\\"')+'"'):n.push(c+"="+o)};for(var s in e)i(s,e[s]);return[t].concat(n).join("; ")}},Te=function(){this._byName={},this._inOrder=[]};Te.prototype.push=function(t,e){Q5.call(this._byName,t)||(this._byName[t]=[]),this._byName[t].push(e),this._inOrder.push({name:t,params:e})};Te.prototype.eachOffer=function(t,e){for(var n=this._inOrder,i=0,s=n.length;i<s;i++)t.call(e,n[i].name,n[i].params)};Te.prototype.byName=function(t){return this._byName[t]||[]};Te.prototype.toArray=function(){return this._inOrder.slice()};Z5.exports=sl});var d6=E((xm,J5)=>{"use strict";var Le=function(t){this._bufferSize=t,this.clear()};Le.prototype.clear=function(){this._buffer=new Array(this._bufferSize),this._ringOffset=0,this._ringSize=this._bufferSize,this._head=0,this._tail=0,this.length=0};Le.prototype.push=function(t){var e=!1,n=!1;this._ringSize<this._bufferSize?e=this._tail===0:this._ringOffset===this._ringSize&&(e=!0,n=this._tail===0),e&&(this._tail=this._bufferSize,this._buffer=this._buffer.concat(new Array(this._bufferSize)),this._bufferSize=this._buffer.length,n&&(this._ringSize=this._bufferSize)),this._buffer[this._tail]=t,this.length+=1,this._tail<this._ringSize&&(this._ringOffset+=1),this._tail=(this._tail+1)%this._bufferSize};Le.prototype.peek=function(){if(this.length!==0)return this._buffer[this._head]};Le.prototype.shift=function(){if(this.length!==0){var t=this._buffer[this._head];return this._buffer[this._head]=void 0,this.length-=1,this._ringOffset-=1,this._ringOffset===0&&this.length>0?(this._head=this._ringSize,this._ringOffset=this.length,this._ringSize=this._bufferSize):this._head=(this._head+1)%this._ringSize,t}};J5.exports=Le});var ts=E((Sm,es)=>{"use strict";var cl=d6(),Y4=function(t,e){this._session=t,this._method=e,this._queue=new cl(Y4.QUEUE_SIZE),this._stopped=!1,this.pending=0};Y4.QUEUE_SIZE=8;Y4.prototype.call=function(t,e,n,i){if(!this._stopped){var s={error:t,message:e,callback:n,context:i,done:!1},c=!1,o=this;if(this._queue.push(s),s.error)return s.done=!0,this._stop(),this._flushQueue();var r=function(a,l){c^(c=!0)&&(a?(o._stop(),s.error=a,s.message=null):s.message=l,s.done=!0,o._flushQueue())};try{this._session[this._method](e,r)}catch(a){r(a)}}};Y4.prototype._stop=function(){this.pending=this._queue.length,this._stopped=!0};Y4.prototype._flushQueue=function(){for(var t=this._queue,e;t.length>0&&t.peek().done;)e=t.shift(),e.error?(this.pending=0,t.clear()):this.pending-=1,e.callback.call(e.context,e.error,e.message)};es.exports=Y4});var f6=E((Tm,ns)=>{"use strict";var ol=d6(),b4=function(){this._complete=!1,this._callbacks=new ol(b4.QUEUE_SIZE)};b4.QUEUE_SIZE=4;b4.all=function(t){var e=new b4,n=t.length,i=n;for(n===0&&e.done();i--;)t[i].then(function(){n-=1,n===0&&e.done()});return e};b4.prototype.then=function(t){this._complete?t():this._callbacks.push(t)};b4.prototype.done=function(){this._complete=!0;for(var t=this._callbacks,e;e=t.shift();)e()};ns.exports=b4});var cs=E((Lm,ss)=>{"use strict";var is=ts(),rl=f6(),C4=function(t){this._ext=t[0],this._session=t[1],this._functors={incoming:new is(this._session,"processIncomingMessage"),outgoing:new is(this._session,"processOutgoingMessage")}};C4.prototype.pending=function(t){var e=this._functors[t];e._stopped||(e.pending+=1)};C4.prototype.incoming=function(t,e,n,i){this._exec("incoming",t,e,n,i)};C4.prototype.outgoing=function(t,e,n,i){this._exec("outgoing",t,e,n,i)};C4.prototype.close=function(){return this._closed=this._closed||new rl,this._doClose(),this._closed};C4.prototype._exec=function(t,e,n,i,s){this._functors[t].call(e,n,function(c,o){c&&(c.message=this._ext.name+": "+c.message),i.call(s,c,o),this._doClose()},this)};C4.prototype._doClose=function(){var t=this._functors.incoming,e=this._functors.outgoing;!this._closed||t.pending+e.pending!==0||(this._session&&this._session.close(),this._session=null,this._closed.done())};ss.exports=C4});var rs=E((Am,os)=>{"use strict";var al=cs(),ll=f6(),Ae=function(t){this._cells=t.map(function(e){return new al(e)}),this._stopped={incoming:!1,outgoing:!1}};Ae.prototype.processIncomingMessage=function(t,e,n){this._stopped.incoming||this._loop("incoming",this._cells.length-1,-1,-1,t,e,n)};Ae.prototype.processOutgoingMessage=function(t,e,n){this._stopped.outgoing||this._loop("outgoing",0,this._cells.length,1,t,e,n)};Ae.prototype.close=function(t,e){this._stopped={incoming:!0,outgoing:!0};var n=this._cells.map(function(i){return i.close()});t&&ll.all(n).then(function(){t.call(e)})};Ae.prototype._loop=function(t,e,n,i,s,c,o){for(var r=this._cells,a=r.length,l=this;a--;)r[a].pending(t);var h=function(u,d,v){if(u===n)return c.call(o,d,v);r[u][t](d,v,function(m,w){m&&(l._stopped[t]=!0),h(u+i,m,w)})};h(e,null,s)};os.exports=Ae});var us=E((Om,hs)=>{"use strict";var Oe=X5(),as=rs(),u3=function(){this._rsv1=this._rsv2=this._rsv3=null,this._byName={},this._inOrder=[],this._sessions=[],this._index={}};u3.MESSAGE_OPCODES=[1,2];var ls={add:function(t){if(typeof t.name!="string")throw new TypeError("extension.name must be a string");if(t.type!=="permessage")throw new TypeError('extension.type must be "permessage"');if(typeof t.rsv1!="boolean")throw new TypeError("extension.rsv1 must be true or false");if(typeof t.rsv2!="boolean")throw new TypeError("extension.rsv2 must be true or false");if(typeof t.rsv3!="boolean")throw new TypeError("extension.rsv3 must be true or false");if(this._byName.hasOwnProperty(t.name))throw new TypeError('An extension with name "'+t.name+'" is already registered');this._byName[t.name]=t,this._inOrder.push(t)},generateOffer:function(){var t=[],e=[],n={};return this._inOrder.forEach(function(i){var s=i.createClientSession();if(s){var c=[i,s];t.push(c),n[i.name]=c;var o=s.generateOffer();o=o?[].concat(o):[],o.forEach(function(r){e.push(Oe.serializeParams(i.name,r))},this)}},this),this._sessions=t,this._index=n,e.length>0?e.join(", "):null},activate:function(t){var e=Oe.parseHeader(t),n=[];e.eachOffer(function(i,s){var c=this._index[i];if(!c)throw new Error('Server sent an extension response for unknown extension "'+i+'"');var o=c[0],r=c[1],a=this._reserved(o);if(a)throw new Error("Server sent two extension responses that use the RSV"+a[0]+' bit: "'+a[1]+'" and "'+o.name+'"');if(r.activate(s)!==!0)throw new Error("Server sent unacceptable extension parameters: "+Oe.serializeParams(i,s));this._reserve(o),n.push(c)},this),this._sessions=n,this._pipeline=new as(n)},generateResponse:function(t){var e=[],n=[],i=Oe.parseHeader(t);return this._inOrder.forEach(function(s){var c=i.byName(s.name);if(!(c.length===0||this._reserved(s))){var o=s.createServerSession(c);o&&(this._reserve(s),e.push([s,o]),n.push(Oe.serializeParams(s.name,o.generateResponse())))}},this),this._sessions=e,this._pipeline=new as(e),n.length>0?n.join(", "):null},validFrameRsv:function(t){var e={rsv1:!1,rsv2:!1,rsv3:!1},n;if(u3.MESSAGE_OPCODES.indexOf(t.opcode)>=0)for(var i=0,s=this._sessions.length;i<s;i++)n=this._sessions[i][0],e.rsv1=e.rsv1||n.rsv1,e.rsv2=e.rsv2||n.rsv2,e.rsv3=e.rsv3||n.rsv3;return(e.rsv1||!t.rsv1)&&(e.rsv2||!t.rsv2)&&(e.rsv3||!t.rsv3)},processIncomingMessage:function(t,e,n){this._pipeline.processIncomingMessage(t,e,n)},processOutgoingMessage:function(t,e,n){this._pipeline.processOutgoingMessage(t,e,n)},close:function(t,e){if(!this._pipeline)return t.call(e);this._pipeline.close(t,e)},_reserve:function(t){this._rsv1=this._rsv1||t.rsv1&&t.name,this._rsv2=this._rsv2||t.rsv2&&t.name,this._rsv3=this._rsv3||t.rsv3&&t.name},_reserved:function(t){return this._rsv1&&t.rsv1?[1,this._rsv1]:this._rsv2&&t.rsv2?[2,this._rsv2]:this._rsv3&&t.rsv3?[3,this._rsv3]:!1}};for(v6 in ls)u3.prototype[v6]=ls[v6];var v6;hs.exports=u3});var ms=E((Im,vs)=>{"use strict";var fs=function(){},ds={final:!1,rsv1:!1,rsv2:!1,rsv3:!1,opcode:null,masked:!1,maskingKey:null,lengthBytes:1,length:0,payload:null};for(m6 in ds)fs.prototype[m6]=ds[m6];var m6;vs.exports=fs});var zs=E((km,_s)=>{"use strict";var hl=S1().Buffer,gs=function(){this.rsv1=!1,this.rsv2=!1,this.rsv3=!1,this.opcode=null,this.length=0,this._chunks=[]},ps={read:function(){return this.data=this.data||hl.concat(this._chunks,this.length)},pushFrame:function(t){this.rsv1=this.rsv1||t.rsv1,this.rsv2=this.rsv2||t.rsv2,this.rsv3=this.rsv3||t.rsv3,this.opcode===null&&(this.opcode=t.opcode),this._chunks.push(t.payload),this.length+=t.length}};for(p6 in ps)gs.prototype[p6]=ps[p6];var p6;_s.exports=gs});var _6=E((Bm,Cs)=>{"use strict";var Ie=S1().Buffer,bs=S("crypto"),ul=S("util"),dl=us(),V4=X1(),ws=ms(),Ms=zs(),l1=function(t,e,n){if(V4.apply(this,arguments),this._extensions=new dl,this._stage=0,this._masking=this._options.masking,this._protocols=this._options.protocols||[],this._requireMasking=this._options.requireMasking,this._pingCallbacks={},typeof this._protocols=="string"&&(this._protocols=this._protocols.split(/ *, */)),!!this._request){var i=this._request.headers["sec-websocket-protocol"],s=this._protocols;i!==void 0&&(typeof i=="string"&&(i=i.split(/ *, */)),this.protocol=i.filter(function(c){return s.indexOf(c)>=0})[0]),this.version="hybi-"+l1.VERSION}};ul.inherits(l1,V4);l1.VERSION="13";l1.mask=function(t,e,n){if(!e||e.length===0)return t;n=n||0;for(var i=0,s=t.length-n;i<s;i++)t[n+i]=t[n+i]^e[i%4];return t};l1.generateAccept=function(t){var e=bs.createHash("sha1");return e.update(t+l1.GUID),e.digest("base64")};l1.GUID="258EAFA5-E914-47DA-95CA-C5AB0DC85B11";var ys={FIN:128,MASK:128,RSV1:64,RSV2:32,RSV3:16,OPCODE:15,LENGTH:127,OPCODES:{continuation:0,text:1,binary:2,close:8,ping:9,pong:10},OPCODE_CODES:[0,1,2,8,9,10],MESSAGE_OPCODES:[0,1,2],OPENING_OPCODES:[1,2],ERRORS:{normal_closure:1e3,going_away:1001,protocol_error:1002,unacceptable:1003,encoding_error:1007,policy_violation:1008,too_large:1009,extension_error:1010,unexpected_condition:1011},ERROR_CODES:[1e3,1001,1002,1003,1007,1008,1009,1010,1011],DEFAULT_ERROR_CODE:1e3,MIN_RESERVED_ERROR:3e3,MAX_RESERVED_ERROR:4999,UTF8_MATCH:/^([\x00-\x7F]|[\xC2-\xDF][\x80-\xBF]|\xE0[\xA0-\xBF][\x80-\xBF]|[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}|\xED[\x80-\x9F][\x80-\xBF]|\xF0[\x90-\xBF][\x80-\xBF]{2}|[\xF1-\xF3][\x80-\xBF]{3}|\xF4[\x80-\x8F][\x80-\xBF]{2})*$/,addExtension:function(t){return this._extensions.add(t),!0},parse:function(t){this._reader.put(t);for(var e=!0;e;)switch(this._stage){case 0:e=this._reader.read(1),e&&this._parseOpcode(e[0]);break;case 1:e=this._reader.read(1),e&&this._parseLength(e[0]);break;case 2:e=this._reader.read(this._frame.lengthBytes),e&&this._parseExtendedLength(e);break;case 3:e=this._reader.read(4),e&&(this._stage=4,this._frame.maskingKey=e);break;case 4:e=this._reader.read(this._frame.length),e&&(this._stage=0,this._emitFrame(e));break;default:e=null}},text:function(t){return this.readyState>1?!1:this.frame(t,"text")},binary:function(t){return this.readyState>1?!1:this.frame(t,"binary")},ping:function(t,e){return this.readyState>1?!1:(t=t||"",e&&(this._pingCallbacks[t]=e),this.frame(t,"ping"))},pong:function(t){return this.readyState>1?!1:(t=t||"",this.frame(t,"pong"))},close:function(t,e){return t=t||"",e=e||this.ERRORS.normal_closure,this.readyState<=0?(this.readyState=3,this.emit("close",new V4.CloseEvent(e,t)),!0):this.readyState===1?(this.readyState=2,this._extensions.close(function(){this.frame(t,"close",e)},this),!0):!1},frame:function(t,e,n){if(this.readyState<=0)return this._queue([t,e,n]);if(this.readyState>2)return!1;t instanceof Array&&(t=Ie.from(t)),typeof t=="number"&&(t=t.toString());var i=new Ms,s=typeof t=="string",c,o;i.rsv1=i.rsv2=i.rsv3=!1,i.opcode=this.OPCODES[e||(s?"text":"binary")],c=s?Ie.from(t,"utf8"):t,n&&(o=c,c=Ie.allocUnsafe(2+o.length),c.writeUInt16BE(n,0),o.copy(c,2)),i.data=c;var r=function(a){var l=new ws;l.final=!0,l.rsv1=a.rsv1,l.rsv2=a.rsv2,l.rsv3=a.rsv3,l.opcode=a.opcode,l.masked=!!this._masking,l.length=a.data.length,l.payload=a.data,l.masked&&(l.maskingKey=bs.randomBytes(4)),this._sendFrame(l)};return this.MESSAGE_OPCODES.indexOf(i.opcode)>=0?this._extensions.processOutgoingMessage(i,function(a,l){if(a)return this._fail("extension_error",a.message);r.call(this,l)},this):r.call(this,i),!0},_sendFrame:function(t){var e=t.length,n=e<=125?2:e<=65535?4:10,i=n+(t.masked?4:0),s=Ie.allocUnsafe(i+e),c=t.masked?this.MASK:0;s[0]=(t.final?this.FIN:0)|(t.rsv1?this.RSV1:0)|(t.rsv2?this.RSV2:0)|(t.rsv3?this.RSV3:0)|t.opcode,e<=125?s[1]=c|e:e<=65535?(s[1]=c|126,s.writeUInt16BE(e,2)):(s[1]=c|127,s.writeUInt32BE(Math.floor(e/4294967296),2),s.writeUInt32BE(e%4294967296,6)),t.payload.copy(s,i),t.masked&&(t.maskingKey.copy(s,n),l1.mask(s,t.maskingKey,i)),this._write(s)},_handshakeResponse:function(){var t=this._request.headers["sec-websocket-key"],e=this._request.headers["sec-websocket-version"];if(e!==l1.VERSION)throw new Error("Unsupported WebSocket version: "+e);if(typeof t!="string")throw new Error("Missing handshake request header: Sec-WebSocket-Key");this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Accept",l1.generateAccept(t)),this.protocol&&this._headers.set("Sec-WebSocket-Protocol",this.protocol);var n=this._extensions.generateResponse(this._request.headers["sec-websocket-extensions"]);n&&this._headers.set("Sec-WebSocket-Extensions",n);var i="HTTP/1.1 101 Switching Protocols",s=[i,this._headers.toString(),""];return Ie.from(s.join(`\r
`),"utf8")},_shutdown:function(t,e,n){delete this._frame,delete this._message,this._stage=5;var i=this.readyState===1;this.readyState=2,this._extensions.close(function(){i&&this.frame(e,"close",t),this.readyState=3,n&&this.emit("error",new Error(e)),this.emit("close",new V4.CloseEvent(t,e))},this)},_fail:function(t,e){this.readyState>1||this._shutdown(this.ERRORS[t],e,!0)},_parseOpcode:function(t){var e=[this.RSV1,this.RSV2,this.RSV3].map(function(i){return(t&i)===i}),n=this._frame=new ws;if(n.final=(t&this.FIN)===this.FIN,n.rsv1=e[0],n.rsv2=e[1],n.rsv3=e[2],n.opcode=t&this.OPCODE,this._stage=1,!this._extensions.validFrameRsv(n))return this._fail("protocol_error","One or more reserved bits are on: reserved1 = "+(n.rsv1?1:0)+", reserved2 = "+(n.rsv2?1:0)+", reserved3 = "+(n.rsv3?1:0));if(this.OPCODE_CODES.indexOf(n.opcode)<0)return this._fail("protocol_error","Unrecognized frame opcode: "+n.opcode);if(this.MESSAGE_OPCODES.indexOf(n.opcode)<0&&!n.final)return this._fail("protocol_error","Received fragmented control frame: opcode = "+n.opcode);if(this._message&&this.OPENING_OPCODES.indexOf(n.opcode)>=0)return this._fail("protocol_error","Received new data frame but previous continuous frame is unfinished")},_parseLength:function(t){var e=this._frame;if(e.masked=(t&this.MASK)===this.MASK,e.length=t&this.LENGTH,e.length>=0&&e.length<=125){if(this._stage=e.masked?3:4,!this._checkFrameLength())return}else this._stage=2,e.lengthBytes=e.length===126?2:8;if(this._requireMasking&&!e.masked)return this._fail("unacceptable","Received unmasked frame but masking is required")},_parseExtendedLength:function(t){var e=this._frame;if(e.length=this._readUInt(t),this._stage=e.masked?3:4,this.MESSAGE_OPCODES.indexOf(e.opcode)<0&&e.length>125)return this._fail("protocol_error","Received control frame having too long payload: "+e.length);this._checkFrameLength()},_checkFrameLength:function(){var t=this._message?this._message.length:0;return t+this._frame.length>this._maxLength?(this._fail("too_large","WebSocket frame length too large"),!1):!0},_emitFrame:function(t){var e=this._frame,n=e.payload=l1.mask(t,e.maskingKey),i=e.opcode,s,c,o,r,a;if(delete this._frame,i===this.OPCODES.continuation){if(!this._message)return this._fail("protocol_error","Received unexpected continuation frame");this._message.pushFrame(e)}if((i===this.OPCODES.text||i===this.OPCODES.binary)&&(this._message=new Ms,this._message.pushFrame(e)),e.final&&this.MESSAGE_OPCODES.indexOf(i)>=0)return this._emitMessage(this._message);i===this.OPCODES.close&&(c=n.length>=2?n.readUInt16BE(0):null,o=n.length>2?this._encode(n.slice(2)):null,n.length!==0&&!(c!==null&&c>=this.MIN_RESERVED_ERROR&&c<=this.MAX_RESERVED_ERROR)&&this.ERROR_CODES.indexOf(c)<0&&(c=this.ERRORS.protocol_error),(n.length>125||n.length>2&&!o)&&(c=this.ERRORS.protocol_error),this._shutdown(c||this.DEFAULT_ERROR_CODE,o||"")),i===this.OPCODES.ping&&(this.frame(n,"pong"),this.emit("ping",new V4.PingEvent(n.toString()))),i===this.OPCODES.pong&&(r=this._pingCallbacks,s=this._encode(n),a=r[s],delete r[s],a&&a(),this.emit("pong",new V4.PongEvent(n.toString())))},_emitMessage:function(e){var e=this._message;e.read(),delete this._message,this._extensions.processIncomingMessage(e,function(n,i){if(n)return this._fail("extension_error",n.message);var s=i.data;if(i.opcode===this.OPCODES.text&&(s=this._encode(s)),s===null)return this._fail("encoding_error","Could not decode a text frame as UTF-8");this.emit("message",new V4.MessageEvent(s))},this)},_encode:function(t){try{var e=t.toString("binary",0,t.length);if(!this.UTF8_MATCH.test(e))return null}catch{}return t.toString("utf8",0,t.length)},_readUInt:function(t){return t.length===2?t.readUInt16BE(0):t.readUInt32BE(0)*4294967296+t.readUInt32BE(4)}};for(g6 in ys)l1.prototype[g6]=ys[g6];var g6;Cs.exports=l1});var Ss=E((Dm,xs)=>{"use strict";var Hs=S1().Buffer,fl=S("stream").Stream,Vs=S("url"),vl=S("util"),ml=X1(),pl=s3(),gl=h3(),_l={"ws:":80,"wss:":443},w6=function(t,e,n){this._client=t,this._http=new gl("response"),this._origin=typeof t.url=="object"?t.url:Vs.parse(t.url),this._url=typeof e=="object"?e:Vs.parse(e),this._options=n||{},this._state=0,this.readable=this.writable=!0,this._paused=!1,this._headers=new pl,this._headers.set("Host",this._origin.host),this._headers.set("Connection","keep-alive"),this._headers.set("Proxy-Connection","keep-alive");var i=this._url.auth&&Hs.from(this._url.auth,"utf8").toString("base64");i&&this._headers.set("Proxy-Authorization","Basic "+i)};vl.inherits(w6,fl);var Es={setHeader:function(t,e){return this._state!==0?!1:(this._headers.set(t,e),!0)},start:function(){if(this._state!==0)return!1;this._state=1;var t=this._origin,e=t.port||_l[t.protocol],n="CONNECT "+t.hostname+":"+e+" HTTP/1.1",i=[n,this._headers.toString(),""];return this.emit("data",Hs.from(i.join(`\r
`),"utf8")),!0},pause:function(){this._paused=!0},resume:function(){this._paused=!1,this.emit("drain")},write:function(t){if(!this.writable)return!1;if(this._http.parse(t),!this._http.isComplete())return!this._paused;if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this.statusCode===200)this.emit("connect",new ml.ConnectEvent);else{var e="Can't establish a connection to the server at "+this._origin.href;this.emit("error",new Error(e))}return this.end(),!this._paused},end:function(t){this.writable&&(t!==void 0&&this.write(t),this.readable=this.writable=!1,this.emit("close"),this.emit("end"))},destroy:function(){this.end()}};for(z6 in Es)w6.prototype[z6]=Es[z6];var z6;xs.exports=w6});var Os=E((Nm,As)=>{"use strict";var Ls=S1().Buffer,zl=S("crypto"),wl=S("url"),Ml=S("util"),yl=h3(),bl=X1(),Q4=_6(),Cl=Ss(),ke=function(t,e){this.version="hybi-"+Q4.VERSION,Q4.call(this,null,t,e),this.readyState=-1,this._key=ke.generateKey(),this._accept=Q4.generateAccept(this._key),this._http=new yl("response");var n=wl.parse(this.url),i=n.auth&&Ls.from(n.auth,"utf8").toString("base64");if(this.VALID_PROTOCOLS.indexOf(n.protocol)<0)throw new Error(this.url+" is not a valid WebSocket URL");this._pathname=(n.pathname||"/")+(n.search||""),this._headers.set("Host",n.host),this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Key",this._key),this._headers.set("Sec-WebSocket-Version",Q4.VERSION),this._protocols.length>0&&this._headers.set("Sec-WebSocket-Protocol",this._protocols.join(", ")),i&&this._headers.set("Authorization","Basic "+i)};Ml.inherits(ke,Q4);ke.generateKey=function(){return zl.randomBytes(16).toString("base64")};var Ts={VALID_PROTOCOLS:["ws:","wss:"],proxy:function(t,e){return new Cl(this,t,e)},start:function(){return this.readyState!==-1?!1:(this._write(this._handshakeRequest()),this.readyState=0,!0)},parse:function(t){if(this.readyState!==3){if(this.readyState>0)return Q4.prototype.parse.call(this,t);this._http.parse(t),this._http.isComplete()&&(this._validateHandshake(),this.readyState!==3&&(this._open(),this.parse(this._http.body)))}},_handshakeRequest:function(){var t=this._extensions.generateOffer();t&&this._headers.set("Sec-WebSocket-Extensions",t);var e="GET "+this._pathname+" HTTP/1.1",n=[e,this._headers.toString(),""];return Ls.from(n.join(`\r
`),"utf8")},_failHandshake:function(t){t="Error during WebSocket handshake: "+t,this.readyState=3,this.emit("error",new Error(t)),this.emit("close",new bl.CloseEvent(this.ERRORS.protocol_error,t))},_validateHandshake:function(){if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this._http.error)return this._failHandshake(this._http.error.message);if(this._http.statusCode!==101)return this._failHandshake("Unexpected response code: "+this._http.statusCode);var t=this._http.headers,e=t.upgrade||"",n=t.connection||"",i=t["sec-websocket-accept"]||"",s=t["sec-websocket-protocol"]||"";if(e==="")return this._failHandshake("'Upgrade' header is missing");if(e.toLowerCase()!=="websocket")return this._failHandshake("'Upgrade' header value is not 'WebSocket'");if(n==="")return this._failHandshake("'Connection' header is missing");if(n.toLowerCase()!=="upgrade")return this._failHandshake("'Connection' header value is not 'Upgrade'");if(i!==this._accept)return this._failHandshake("Sec-WebSocket-Accept mismatch");if(this.protocol=null,s!==""){if(this._protocols.indexOf(s)<0)return this._failHandshake("Sec-WebSocket-Protocol mismatch");this.protocol=s}try{this._extensions.activate(this.headers["sec-websocket-extensions"])}catch(c){return this._failHandshake(c.message)}}};for(M6 in Ts)ke.prototype[M6]=Ts[M6];var M6;As.exports=ke});var C6=E((Rm,ks)=>{"use strict";var d3=S1().Buffer,f3=X1(),Vl=S("util"),b6=function(t,e,n){f3.apply(this,arguments),this._stage=0,this.version="hixie-75",this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("WebSocket-Origin",this._request.headers.origin),this._headers.set("WebSocket-Location",this.url)};Vl.inherits(b6,f3);var Is={close:function(){return this.readyState===3?!1:(this.readyState=3,this.emit("close",new f3.CloseEvent(null,null)),!0)},parse:function(t){this.readyState>1||(this._reader.put(t),this._reader.eachByte(function(e){var n;switch(this._stage){case-1:this._body.push(e),this._sendHandshakeBody();break;case 0:this._parseLeadingByte(e);break;case 1:if(this._length=(e&127)+128*this._length,this._closing&&this._length===0)return this.close();(e&128)!==128&&(this._length===0?this._stage=0:(this._skipped=0,this._stage=2));break;case 2:if(e===255)this._stage=0,n=d3.from(this._buffer).toString("utf8",0,this._buffer.length),this.emit("message",new f3.MessageEvent(n));else if(this._length)this._skipped+=1,this._skipped===this._length&&(this._stage=0);else if(this._buffer.push(e),this._buffer.length>this._maxLength)return this.close();break}},this))},frame:function(t){if(this.readyState===0)return this._queue([t]);if(this.readyState>1)return!1;typeof t!="string"&&(t=t.toString());var e=d3.byteLength(t),n=d3.allocUnsafe(e+2);return n[0]=0,n.write(t,1),n[n.length-1]=255,this._write(n),!0},_handshakeResponse:function(){var t="HTTP/1.1 101 Web Socket Protocol Handshake",e=[t,this._headers.toString(),""];return d3.from(e.join(`\r
`),"utf8")},_parseLeadingByte:function(t){(t&128)===128?(this._length=0,this._stage=1):(delete this._length,delete this._skipped,this._buffer=[],this._stage=2)}};for(y6 in Is)b6.prototype[y6]=Is[y6];var y6;ks.exports=b6});var Fs=E((Fm,Rs)=>{"use strict";var Be=S1().Buffer,El=X1(),v3=C6(),Hl=S("crypto"),xl=S("util"),Bs=function(t){return parseInt((t.match(/[0-9]/g)||[]).join(""),10)},Ds=function(t){return(t.match(/ /g)||[]).length},E6=function(t,e,n){v3.apply(this,arguments),this._stage=-1,this._body=[],this.version="hixie-76",this._headers.clear(),this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Origin",this._request.headers.origin),this._headers.set("Sec-WebSocket-Location",this.url)};xl.inherits(E6,v3);var Ns={BODY_SIZE:8,start:function(){return v3.prototype.start.call(this)?(this._started=!0,this._sendHandshakeBody(),!0):!1},close:function(){return this.readyState===3?!1:(this.readyState===1&&this._write(Be.from([255,0])),this.readyState=3,this.emit("close",new El.CloseEvent(null,null)),!0)},_handshakeResponse:function(){var r=this._request.headers,t=r["sec-websocket-key1"],e=r["sec-websocket-key2"];if(!t)throw new Error("Missing required header: Sec-WebSocket-Key1");if(!e)throw new Error("Missing required header: Sec-WebSocket-Key2");var n=Bs(t),i=Ds(t),s=Bs(e),c=Ds(e);if(n%i!==0||s%c!==0)throw new Error("Client sent invalid Sec-WebSocket-Key headers");this._keyValues=[n/i,s/c];var o="HTTP/1.1 101 WebSocket Protocol Handshake",r=[o,this._headers.toString(),""];return Be.from(r.join(`\r
`),"binary")},_handshakeSignature:function(){if(this._body.length<this.BODY_SIZE)return null;var t=Hl.createHash("md5"),e=Be.allocUnsafe(8+this.BODY_SIZE);return e.writeUInt32BE(this._keyValues[0],0),e.writeUInt32BE(this._keyValues[1],4),Be.from(this._body).copy(e,8,0,this.BODY_SIZE),t.update(e),Be.from(t.digest("binary"),"binary")},_sendHandshakeBody:function(){if(this._started){var t=this._handshakeSignature();t&&(this._write(t),this._stage=0,this._open(),this._body.length>this.BODY_SIZE&&this.parse(this._body.slice(this.BODY_SIZE)))}},_parseLeadingByte:function(t){if(t!==255)return v3.prototype._parseLeadingByte.call(this,t);this._closing=!0,this._length=0,this._stage=1}};for(V6 in Ns)E6.prototype[V6]=Ns[V6];var V6;Rs.exports=E6});var qs=E((Pm,Ps)=>{"use strict";var Sl=S("util"),Tl=h3(),S6=X1(),Ll=C6(),Al=Fs(),Ol=_6(),E4=function(t){S6.call(this,null,null,t),this._http=new Tl("request")};Sl.inherits(E4,S6);var x6={EVENTS:["open","message","error","close","ping","pong"],_bindEventListeners:function(){this.messages.on("error",function(){}),this.on("error",function(){})},parse:function(t){if(this._delegate)return this._delegate.parse(t);if(this._http.parse(t),!!this._http.isComplete()){this.method=this._http.method,this.url=this._http.url,this.headers=this._http.headers,this.body=this._http.body;var e=this;this._delegate=E4.http(this,this._options),this._delegate.messages=this.messages,this._delegate.io=this.io,this._open(),this.EVENTS.forEach(function(n){this._delegate.on(n,function(i){e.emit(n,i)})},this),this.protocol=this._delegate.protocol,this.version=this._delegate.version,this.parse(this._http.body),this.emit("connect",new S6.ConnectEvent)}},_open:function(){this.__queue.forEach(function(t){this._delegate[t[0]].apply(this._delegate,t[1])},this),this.__queue=[]}};["addExtension","setHeader","start","frame","text","binary","ping","close"].forEach(function(t){x6[t]=function(){return this._delegate?this._delegate[t].apply(this._delegate,arguments):(this.__queue.push([t,arguments]),!0)}});for(H6 in x6)E4.prototype[H6]=x6[H6];var H6;E4.isSecureRequest=function(t){if(t.connection&&t.connection.authorized!==void 0||t.socket&&t.socket.secure)return!0;var e=t.headers;return e?e.https==="on"||e["x-forwarded-ssl"]==="on"||e["x-forwarded-scheme"]==="https"||e["x-forwarded-proto"]==="https":!1};E4.determineUrl=function(t){var e=this.isSecureRequest(t)?"wss:":"ws:";return e+"//"+t.headers.host+t.url};E4.http=function(t,e){e=e||{},e.requireMasking===void 0&&(e.requireMasking=!0);var n=t.headers,i=n["sec-websocket-version"],s=n["sec-websocket-key"],c=n["sec-websocket-key1"],o=n["sec-websocket-key2"],r=this.determineUrl(t);return i||s?new Ol(t,r,e):c||o?new Al(t,r,e):new Ll(t,r,e)};Ps.exports=E4});var De=E((qm,js)=>{"use strict";var Us=X1(),Il=Os(),m3=qs(),kl={client:function(t,e){return e=e||{},e.masking===void 0&&(e.masking=!0),new Il(t,e)},server:function(t){return t=t||{},t.requireMasking===void 0&&(t.requireMasking=!0),new m3(t)},http:function(){return m3.http.apply(m3,arguments)},isSecureRequest:function(t){return m3.isSecureRequest(t)},isWebSocket:function(t){return Us.isWebSocket(t)},validateOptions:function(t,e){Us.validateOptions(t,e)}};js.exports=kl});var Ne=E((Um,Ws)=>{"use strict";var H4=function(t,e){this.type=t;for(var n in e)this[n]=e[n]};H4.prototype.initEvent=function(t,e,n){this.type=t,this.bubbles=e,this.cancelable=n};H4.prototype.stopPropagation=function(){};H4.prototype.preventDefault=function(){};H4.CAPTURING_PHASE=1;H4.AT_TARGET=2;H4.BUBBLING_PHASE=3;Ws.exports=H4});var T6=E((jm,Gs)=>{"use strict";var Bl=Ne(),Dl={onopen:null,onmessage:null,onerror:null,onclose:null,addEventListener:function(t,e,n){this.on(t,e)},removeEventListener:function(t,e,n){this.removeListener(t,e)},dispatchEvent:function(t){t.target=t.currentTarget=this,t.eventPhase=Bl.AT_TARGET,this["on"+t.type]&&this["on"+t.type](t),this.emit(t.type,t)}};Gs.exports=Dl});var g3=E((Wm,Ys)=>{"use strict";var Nl=S("stream").Stream,Rl=S("util"),Fl=De(),$s=T6(),p3=Ne(),I=function(t){t=t||{},Fl.validateOptions(t,["headers","extensions","maxLength","ping","proxy","tls","ca"]),this.readable=this.writable=!0;var e=t.headers;if(e)for(var n in e)this._driver.setHeader(n,e[n]);var i=t.extensions;i&&[].concat(i).forEach(this._driver.addExtension,this._driver),this._ping=t.ping,this._pingId=0,this.readyState=I.CONNECTING,this.bufferedAmount=0,this.protocol="",this.url=this._driver.url,this.version=this._driver.version;var s=this;this._driver.on("open",function(c){s._open()}),this._driver.on("message",function(c){s._receiveMessage(c.data)}),this._driver.on("close",function(c){s._beginClose(c.reason,c.code)}),this._driver.on("error",function(c){s._emitError(c.message)}),this.on("error",function(){}),this._driver.messages.on("drain",function(){s.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){s._pingId+=1,s.ping(s._pingId.toString())},this._ping*1e3)),this._configureStream(),this._proxy||(this._stream.pipe(this._driver.io),this._driver.io.pipe(this._stream))};Rl.inherits(I,Nl);I.CONNECTING=0;I.OPEN=1;I.CLOSING=2;I.CLOSED=3;I.CLOSE_TIMEOUT=3e4;var Ks={write:function(t){return this.send(t)},end:function(t){t!==void 0&&this.send(t),this.close()},pause:function(){return this._driver.messages.pause()},resume:function(){return this._driver.messages.resume()},send:function(t){return this.readyState>I.OPEN?!1:(t instanceof Buffer||(t=String(t)),this._driver.messages.write(t))},ping:function(t,e){return this.readyState>I.OPEN?!1:this._driver.ping(t,e)},close:function(t,e){if(t===void 0&&(t=1e3),e===void 0&&(e=""),t!==1e3&&(t<3e3||t>4999))throw new Error("Failed to execute 'close' on WebSocket: The code must be either 1000, or between 3000 and 4999. "+t+" is neither.");if(this.readyState<I.CLOSING){var n=this;this._closeTimer=setTimeout(function(){n._beginClose("",1006)},I.CLOSE_TIMEOUT)}this.readyState!==I.CLOSED&&(this.readyState=I.CLOSING),this._driver.close(e,t)},_configureStream:function(){var t=this;this._stream.setTimeout(0),this._stream.setNoDelay(!0),["close","end"].forEach(function(e){this._stream.on(e,function(){t._finalizeClose()})},this),this._stream.on("error",function(e){t._emitError("Network error: "+t.url+": "+e.message),t._finalizeClose()})},_open:function(){if(this.readyState===I.CONNECTING){this.readyState=I.OPEN,this.protocol=this._driver.protocol||"";var t=new p3("open");t.initEvent("open",!1,!1),this.dispatchEvent(t)}},_receiveMessage:function(t){if(this.readyState>I.OPEN)return!1;this.readable&&this.emit("data",t);var e=new p3("message",{data:t});e.initEvent("message",!1,!1),this.dispatchEvent(e)},_emitError:function(t){if(!(this.readyState>=I.CLOSING)){var e=new p3("error",{message:t});e.initEvent("error",!1,!1),this.dispatchEvent(e)}},_beginClose:function(t,e){this.readyState!==I.CLOSED&&(this.readyState=I.CLOSING,this._closeParams=[t,e],this._stream&&(this._stream.destroy(),this._stream.readable||this._finalizeClose()))},_finalizeClose:function(){if(this.readyState!==I.CLOSED){this.readyState=I.CLOSED,this._closeTimer&&clearTimeout(this._closeTimer),this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end(),this.readable&&this.emit("end"),this.readable=this.writable=!1;var t=this._closeParams?this._closeParams[0]:"",e=this._closeParams?this._closeParams[1]:1006,n=new p3("close",{code:e,reason:t});n.initEvent("close",!1,!1),this.dispatchEvent(n)}}};for(L6 in Ks)I.prototype[L6]=Ks[L6];var L6;for(A6 in $s)I.prototype[A6]=$s[A6];var A6;Ys.exports=I});var tc=E(($m,ec)=>{"use strict";var Pl=S("util"),ql=S("net"),Qs=S("tls"),Zs=S("url"),Ul=De(),Xs=g3(),Gm=Ne(),jl={"http:":80,"https:":443,"ws:":80,"wss:":443},Js=["https:","wss:"],_3=function(t,e,n){n=n||{},this.url=t,this._driver=Ul.client(this.url,{maxLength:n.maxLength,protocols:e}),["open","error"].forEach(function(d){this._driver.on(d,function(){u.headers=u._driver.headers,u.statusCode=u._driver.statusCode})},this);var i=n.proxy||{},s=Zs.parse(i.origin||this.url),c=s.port||jl[s.protocol],o=Js.indexOf(s.protocol)>=0,r=function(){u._onConnect()},a=n.net||{},l=n.tls||{},h=i.origin?i.tls||{}:l,u=this;a.host=h.host=s.hostname,a.port=h.port=c,l.ca=l.ca||n.ca,h.servername=h.servername||s.hostname,this._stream=o?Qs.connect(h,r):ql.connect(a,r),i.origin&&this._configureProxy(i,l),Xs.call(this,n)};Pl.inherits(_3,Xs);_3.prototype._onConnect=function(){var t=this._proxy||this._driver;t.start()};_3.prototype._configureProxy=function(t,e){var n=Zs.parse(this.url),i=Js.indexOf(n.protocol)>=0,s=this,c;if(this._proxy=this._driver.proxy(t.origin),t.headers)for(c in t.headers)this._proxy.setHeader(c,t.headers[c]);this._proxy.pipe(this._stream,{end:!1}),this._stream.pipe(this._proxy),this._proxy.on("connect",function(){if(i){var o={socket:s._stream,servername:n.hostname};for(c in e)o[c]=e[c];s._stream=Qs.connect(o),s._configureStream()}s._driver.io.pipe(s._stream),s._stream.pipe(s._driver.io),s._driver.start()}),this._proxy.on("error",function(o){s._driver.emit("error",o)})};ec.exports=_3});var oc=E((Km,cc)=>{"use strict";var Wl=S("stream").Stream,Gl=S("util"),$l=De(),Kl=s3(),Z4=g3(),nc=T6(),ic=Ne(),Re=function(t,e,n){this.writable=!0,n=n||{},this._stream=e.socket,this._ping=n.ping||this.DEFAULT_PING,this._retry=n.retry||this.DEFAULT_RETRY;var i=$l.isSecureRequest(t)?"https:":"http:";this.url=i+"//"+t.headers.host+t.url,this.lastEventId=t.headers["last-event-id"]||"",this.readyState=Z4.CONNECTING;var s=new Kl,c=this;if(n.headers)for(var o in n.headers)s.set(o,n.headers[o]);if(!(!this._stream||!this._stream.writable)){process.nextTick(function(){c._open()}),this._stream.setTimeout(0),this._stream.setNoDelay(!0);var r=`HTTP/1.1 200 OK\r
Content-Type: text/event-stream\r
Cache-Control: no-cache, no-store\r
Connection: close\r
`+s.toString()+`\r
retry: `+Math.floor(this._retry*1e3)+`\r
\r
`;this._write(r),this._stream.on("drain",function(){c.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){c.ping()},this._ping*1e3)),["error","end"].forEach(function(a){c._stream.on(a,function(){c.close()})})}};Gl.inherits(Re,Wl);Re.isEventSource=function(t){if(t.method!=="GET")return!1;var e=(t.headers.accept||"").split(/\s*,\s*/);return e.indexOf("text/event-stream")>=0};var sc={DEFAULT_PING:10,DEFAULT_RETRY:5,_write:function(t){if(!this.writable)return!1;try{return this._stream.write(t,"utf8")}catch{return!1}},_open:function(){if(this.readyState===Z4.CONNECTING){this.readyState=Z4.OPEN;var t=new ic("open");t.initEvent("open",!1,!1),this.dispatchEvent(t)}},write:function(t){return this.send(t)},end:function(t){t!==void 0&&this.write(t),this.close()},send:function(t,e){if(this.readyState>Z4.OPEN)return!1;t=String(t).replace(/(\r\n|\r|\n)/g,"$1data: "),e=e||{};var n="";return e.event&&(n+="event: "+e.event+`\r
`),e.id&&(n+="id: "+e.id+`\r
`),n+="data: "+t+`\r
\r
`,this._write(n)},ping:function(){return this._write(`:\r
\r
`)},close:function(){if(this.readyState>Z4.OPEN)return!1;this.readyState=Z4.CLOSED,this.writable=!1,this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end();var t=new ic("close");return t.initEvent("close",!1,!1),this.dispatchEvent(t),!0}};for(O6 in sc)Re.prototype[O6]=sc[O6];var O6;for(I6 in nc)Re.prototype[I6]=nc[I6];var I6;cc.exports=Re});var lc=E((Ym,ac)=>{"use strict";var Yl=S("util"),k6=De(),rc=g3(),J1=function(t,e,n,i,s){s=s||{},this._stream=e,this._driver=k6.http(t,{maxLength:s.maxLength,protocols:i});var c=this;if(!(!this._stream||!this._stream.writable)){if(!this._stream.readable)return this._stream.end();var o=function(){c._stream.removeListener("data",o)};this._stream.on("data",o),rc.call(this,s),process.nextTick(function(){c._driver.start(),c._driver.io.write(n)})}};Yl.inherits(J1,rc);J1.isWebSocket=function(t){return k6.isWebSocket(t)};J1.validateOptions=function(t,e){k6.validateOptions(t,e)};J1.WebSocket=J1;J1.Client=tc();J1.EventSource=oc();ac.exports=J1});function R(t,e){ko(t)&&(t="100%");var n=Bo(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function ye(t){return Math.min(1,Math.max(0,t))}function ko(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function Bo(t){return typeof t=="string"&&t.indexOf("%")!==-1}function I2(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function be(t){return t<=1?"".concat(Number(t)*100,"%"):t}function K1(t){return t.length===1?"0"+t:String(t)}function dn(t,e,n){return{r:R(t,255)*255,g:R(e,255)*255,b:R(n,255)*255}}function M8(t,e,n){t=R(t,255),e=R(e,255),n=R(n,255);var i=Math.max(t,e,n),s=Math.min(t,e,n),c=0,o=0,r=(i+s)/2;if(i===s)o=0,c=0;else{var a=i-s;switch(o=r>.5?a/(2-i-s):a/(i+s),i){case t:c=(e-n)/a+(e<n?6:0);break;case e:c=(n-t)/a+2;break;case n:c=(t-e)/a+4;break;default:break}c/=6}return{h:c,s:o,l:r}}function w8(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*(6*n):n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function fn(t,e,n){var i,s,c;if(t=R(t,360),e=R(e,100),n=R(n,100),e===0)s=n,c=n,i=n;else{var o=n<.5?n*(1+e):n+e-n*e,r=2*n-o;i=w8(r,o,t+1/3),s=w8(r,o,t),c=w8(r,o,t-1/3)}return{r:i*255,g:s*255,b:c*255}}function p4(t,e,n){t=R(t,255),e=R(e,255),n=R(n,255);var i=Math.max(t,e,n),s=Math.min(t,e,n),c=0,o=i,r=i-s,a=i===0?0:r/i;if(i===s)c=0;else{switch(i){case t:c=(e-n)/r+(e<n?6:0);break;case e:c=(n-t)/r+2;break;case n:c=(t-e)/r+4;break;default:break}c/=6}return{h:c,s:a,v:o}}function vn(t,e,n){t=R(t,360)*6,e=R(e,100),n=R(n,100);var i=Math.floor(t),s=t-i,c=n*(1-e),o=n*(1-s*e),r=n*(1-(1-s)*e),a=i%6,l=[n,o,c,c,r,n][a],h=[r,n,n,o,c,c][a],u=[c,c,r,n,n,o][a];return{r:l*255,g:h*255,b:u*255}}function g4(t,e,n,i){var s=[K1(Math.round(t).toString(16)),K1(Math.round(e).toString(16)),K1(Math.round(n).toString(16))];return i&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function mn(t,e,n,i,s){var c=[K1(Math.round(t).toString(16)),K1(Math.round(e).toString(16)),K1(Math.round(n).toString(16)),K1(Do(i))];return s&&c[0].startsWith(c[0].charAt(1))&&c[1].startsWith(c[1].charAt(1))&&c[2].startsWith(c[2].charAt(1))&&c[3].startsWith(c[3].charAt(1))?c[0].charAt(0)+c[1].charAt(0)+c[2].charAt(0)+c[3].charAt(0):c.join("")}function Do(t){return Math.round(parseFloat(t)*255).toString(16)}function y8(t){return n1(t)/255}function n1(t){return parseInt(t,16)}function pn(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var Ce={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function i1(t){var e={r:0,g:0,b:0},n=1,i=null,s=null,c=null,o=!1,r=!1;return typeof t=="string"&&(t=Fo(t)),typeof t=="object"&&(R1(t.r)&&R1(t.g)&&R1(t.b)?(e=dn(t.r,t.g,t.b),o=!0,r=String(t.r).substr(-1)==="%"?"prgb":"rgb"):R1(t.h)&&R1(t.s)&&R1(t.v)?(i=be(t.s),s=be(t.v),e=vn(t.h,i,s),o=!0,r="hsv"):R1(t.h)&&R1(t.s)&&R1(t.l)&&(i=be(t.s),c=be(t.l),e=fn(t.h,i,c),o=!0,r="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=I2(n),{ok:o,format:t.format||r,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}var No="[-\\+]?\\d+%?",Ro="[-\\+]?\\d*\\.\\d+%?",Y1="(?:".concat(Ro,")|(?:").concat(No,")"),b8="[\\s|\\(]+(".concat(Y1,")[,|\\s]+(").concat(Y1,")[,|\\s]+(").concat(Y1,")\\s*\\)?"),C8="[\\s|\\(]+(".concat(Y1,")[,|\\s]+(").concat(Y1,")[,|\\s]+(").concat(Y1,")[,|\\s]+(").concat(Y1,")\\s*\\)?"),M1={CSS_UNIT:new RegExp(Y1),rgb:new RegExp("rgb"+b8),rgba:new RegExp("rgba"+C8),hsl:new RegExp("hsl"+b8),hsla:new RegExp("hsla"+C8),hsv:new RegExp("hsv"+b8),hsva:new RegExp("hsva"+C8),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Fo(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var e=!1;if(Ce[t])t=Ce[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n=M1.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=M1.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=M1.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=M1.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=M1.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=M1.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=M1.hex8.exec(t),n?{r:n1(n[1]),g:n1(n[2]),b:n1(n[3]),a:y8(n[4]),format:e?"name":"hex8"}:(n=M1.hex6.exec(t),n?{r:n1(n[1]),g:n1(n[2]),b:n1(n[3]),format:e?"name":"hex"}:(n=M1.hex4.exec(t),n?{r:n1(n[1]+n[1]),g:n1(n[2]+n[2]),b:n1(n[3]+n[3]),a:y8(n[4]+n[4]),format:e?"name":"hex8"}:(n=M1.hex3.exec(t),n?{r:n1(n[1]+n[1]),g:n1(n[2]+n[2]),b:n1(n[3]+n[3]),format:e?"name":"hex"}:!1)))))))))}function R1(t){return!!M1.CSS_UNIT.exec(String(t))}var k2=function(){function t(e,n){e===void 0&&(e=""),n===void 0&&(n={});var i;if(e instanceof t)return e;typeof e=="number"&&(e=pn(e)),this.originalInput=e;var s=i1(e);this.originalInput=e,this.r=s.r,this.g=s.g,this.b=s.b,this.a=s.a,this.roundA=Math.round(100*this.a)/100,this.format=(i=n.format)!==null&&i!==void 0?i:s.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=s.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},t.prototype.getLuminance=function(){var e=this.toRgb(),n,i,s,c=e.r/255,o=e.g/255,r=e.b/255;return c<=.03928?n=c/12.92:n=Math.pow((c+.055)/1.055,2.4),o<=.03928?i=o/12.92:i=Math.pow((o+.055)/1.055,2.4),r<=.03928?s=r/12.92:s=Math.pow((r+.055)/1.055,2.4),.2126*n+.7152*i+.0722*s},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(e){return this.a=I2(e),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},t.prototype.toHsv=function(){var e=p4(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},t.prototype.toHsvString=function(){var e=p4(this.r,this.g,this.b),n=Math.round(e.h*360),i=Math.round(e.s*100),s=Math.round(e.v*100);return this.a===1?"hsv(".concat(n,", ").concat(i,"%, ").concat(s,"%)"):"hsva(".concat(n,", ").concat(i,"%, ").concat(s,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var e=M8(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},t.prototype.toHslString=function(){var e=M8(this.r,this.g,this.b),n=Math.round(e.h*360),i=Math.round(e.s*100),s=Math.round(e.l*100);return this.a===1?"hsl(".concat(n,", ").concat(i,"%, ").concat(s,"%)"):"hsla(".concat(n,", ").concat(i,"%, ").concat(s,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(e){return e===void 0&&(e=!1),g4(this.r,this.g,this.b,e)},t.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},t.prototype.toHex8=function(e){return e===void 0&&(e=!1),mn(this.r,this.g,this.b,this.a,e)},t.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},t.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var e=Math.round(this.r),n=Math.round(this.g),i=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(n,", ").concat(i,")"):"rgba(".concat(e,", ").concat(n,", ").concat(i,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var e=function(n){return"".concat(Math.round(R(n,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var e=function(n){return Math.round(R(n,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+g4(this.r,this.g,this.b,!1),n=0,i=Object.entries(Ce);n<i.length;n++){var s=i[n],c=s[0],o=s[1];if(e===o)return c}return!1},t.prototype.toString=function(e){var n=!!e;e=e??this.format;var i=!1,s=this.a<1&&this.a>=0,c=!n&&s&&(e.startsWith("hex")||e==="name");return c?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l+=e/100,n.l=ye(n.l),new t(n)},t.prototype.brighten=function(e){e===void 0&&(e=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),new t(n)},t.prototype.darken=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l-=e/100,n.l=ye(n.l),new t(n)},t.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},t.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},t.prototype.desaturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s-=e/100,n.s=ye(n.s),new t(n)},t.prototype.saturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s+=e/100,n.s=ye(n.s),new t(n)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var n=this.toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,new t(n)},t.prototype.mix=function(e,n){n===void 0&&(n=50);var i=this.toRgb(),s=new t(e).toRgb(),c=n/100,o={r:(s.r-i.r)*c+i.r,g:(s.g-i.g)*c+i.g,b:(s.b-i.b)*c+i.b,a:(s.a-i.a)*c+i.a};return new t(o)},t.prototype.analogous=function(e,n){e===void 0&&(e=6),n===void 0&&(n=30);var i=this.toHsl(),s=360/n,c=[this];for(i.h=(i.h-(s*e>>1)+720)%360;--e;)i.h=(i.h+s)%360,c.push(new t(i));return c},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var n=this.toHsv(),i=n.h,s=n.s,c=n.v,o=[],r=1/e;e--;)o.push(new t({h:i,s,v:c})),c=(c+r)%1;return o},t.prototype.splitcomplement=function(){var e=this.toHsl(),n=e.h;return[this,new t({h:(n+72)%360,s:e.s,l:e.l}),new t({h:(n+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var n=this.toRgb(),i=new t(e).toRgb(),s=n.a+i.a*(1-n.a);return new t({r:(n.r*n.a+i.r*i.a*(1-n.a))/s,g:(n.g*n.a+i.g*i.a*(1-n.a))/s,b:(n.b*n.a+i.b*i.a*(1-n.a))/s,a:s})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var n=this.toHsl(),i=n.h,s=[this],c=360/e,o=1;o<e;o++)s.push(new t({h:(i+o*c)%360,s:n.s,l:n.l}));return s},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}();var B2=2,gn=.16,Po=.05,qo=.05,Uo=.15,yn=5,bn=4,jo=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function _n(t){var e=t.r,n=t.g,i=t.b,s=p4(e,n,i);return{h:s.h*360,s:s.s,v:s.v}}function D2(t){var e=t.r,n=t.g,i=t.b;return"#".concat(g4(e,n,i,!1))}function Wo(t,e,n){var i=n/100,s={r:(e.r-t.r)*i+t.r,g:(e.g-t.g)*i+t.g,b:(e.b-t.b)*i+t.b};return s}function zn(t,e,n){var i;return Math.round(t.h)>=60&&Math.round(t.h)<=240?i=n?Math.round(t.h)-B2*e:Math.round(t.h)+B2*e:i=n?Math.round(t.h)+B2*e:Math.round(t.h)-B2*e,i<0?i+=360:i>=360&&(i-=360),i}function wn(t,e,n){if(t.h===0&&t.s===0)return t.s;var i;return n?i=t.s-gn*e:e===bn?i=t.s+gn:i=t.s+Po*e,i>1&&(i=1),n&&e===yn&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2))}function Mn(t,e,n){var i;return n?i=t.v+qo*e:i=t.v-Uo*e,i>1&&(i=1),Number(i.toFixed(2))}function P4(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[],i=i1(t),s=yn;s>0;s-=1){var c=_n(i),o=D2(i1({h:zn(c,s,!0),s:wn(c,s,!0),v:Mn(c,s,!0)}));n.push(o)}n.push(D2(i));for(var r=1;r<=bn;r+=1){var a=_n(i),l=D2(i1({h:zn(a,r),s:wn(a,r),v:Mn(a,r)}));n.push(l)}return e.theme==="dark"?jo.map(function(h){var u=h.index,d=h.opacity,v=D2(Wo(i1(e.backgroundColor||"#141414"),i1(n[u]),d*100));return v}):n}var V8={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},W={},E8={};Object.keys(V8).forEach(function(t){W[t]=P4(V8[t]),W[t].primary=W[t][5],E8[t]=P4(V8[t],{theme:"dark",backgroundColor:"#141414"}),E8[t].primary=E8[t][5]});var md=W.red,pd=W.volcano,gd=W.gold,_d=W.orange,zd=W.yellow,wd=W.lime,Md=W.green,yd=W.cyan,bd=W.blue,Cd=W.geekblue,Vd=W.purple,Ed=W.magenta,Hd=W.grey,xd=W.grey;var F1="[@ant-design/icons-angular]:";function Ko(t){console.error(`${F1} ${t}.`)}function En(t){m4()&&console.warn(`${F1} ${t}.`)}function Cn(t){return P4(t)[0]}function N2(t,e){switch(e){case"fill":return`${t}-fill`;case"outline":return`${t}-o`;case"twotone":return`${t}-twotone`;case void 0:return t;default:throw new Error(`${F1}Theme "${e}" is not a recognized theme!`)}}function Yo(t,e,n,i){return`${N2(t,e)}-${n}-${i}`}function Qo(t){return t==="o"?"outline":t}function Zo(t){return t.endsWith("-fill")||t.endsWith("-o")||t.endsWith("-twotone")}function Hn(t){return typeof t=="object"&&typeof t.name=="string"&&(typeof t.theme=="string"||t.theme===void 0)&&typeof t.icon=="string"}function Xo(t){let e=t.split("-"),n=Qo(e.splice(e.length-1,1)[0]);return{name:e.join("-"),theme:n,icon:""}}function Jo(t){return t.cloneNode(!0)}function er(t){return t.replace(/['"]#333['"]/g,'"primaryColor"').replace(/['"]#E6E6E6['"]/g,'"secondaryColor"').replace(/['"]#D9D9D9['"]/g,'"secondaryColor"').replace(/['"]#D8D8D8['"]/g,'"secondaryColor"')}function R2(t){let e=t.split(":");switch(e.length){case 1:return[t,""];case 2:return[e[1],e[0]];default:throw new Error(`${F1}The icon type ${t} is not valid!`)}}function tr(t){return R2(t)[1]!==""}function nr(){return new Error(`${F1}Type should have a namespace. Try "namespace:${name}".`)}function Vn(t){return new Error(`${F1}the icon ${t} does not exist or is not registered.`)}function ir(){return Ko('you need to import "HttpClientModule" to use dynamic importing.'),null}function sr(t){return new Error(`${F1}The url "${t}" is unsafe.`)}function cr(){return new Error(`${F1}<svg> tag not found.`)}function or(){return new Error(`${F1}Importing timeout error.`)}var rr="__ant_icon_load",ar=new H("ant_icons"),H8=(()=>{let e=class e{set twoToneColor({primaryColor:i,secondaryColor:s}){this._twoToneColorPalette.primaryColor=i,this._twoToneColorPalette.secondaryColor=s||Cn(i)}get twoToneColor(){return F({},this._twoToneColorPalette)}get _disableDynamicLoading(){return!1}constructor(i,s,c,o,r){this._rendererFactory=i,this._handler=s,this._document=c,this.sanitizer=o,this._antIcons=r,this.defaultTheme="outline",this._svgDefinitions=new Map,this._svgRenderedDefinitions=new Map,this._inProgressFetches=new Map,this._assetsUrlRoot="",this._twoToneColorPalette={primaryColor:"#333333",secondaryColor:"#E6E6E6"},this._enableJsonpLoading=!1,this._jsonpIconLoad$=new k1,this._renderer=this._rendererFactory.createRenderer(null,null),this._handler&&(this._http=new Q0(this._handler)),this._antIcons&&this.addIcon(...this._antIcons)}useJsonpLoading(){this._enableJsonpLoading?En("You are already using jsonp loading."):(this._enableJsonpLoading=!0,window[rr]=i=>{this._jsonpIconLoad$.next(i)})}changeAssetsSource(i){this._assetsUrlRoot=i.endsWith("/")?i:i+"/"}addIcon(...i){i.forEach(s=>{this._svgDefinitions.set(N2(s.name,s.theme),s)})}addIconLiteral(i,s){let[c,o]=R2(i);if(!o)throw nr();this.addIcon({name:i,icon:s})}clear(){this._svgDefinitions.clear(),this._svgRenderedDefinitions.clear()}getRenderedContent(i,s){let c=Hn(i)?i:this._svgDefinitions.get(i)||null;if(!c&&this._disableDynamicLoading)throw Vn(i);return(c?w1(c):this._loadIconDynamically(i)).pipe(G(r=>{if(!r)throw Vn(i);return this._loadSVGFromCacheOrCreateNew(r,s)}))}getCachedIcons(){return this._svgDefinitions}_loadIconDynamically(i){if(!this._http&&!this._enableJsonpLoading)return w1(ir());let s=this._inProgressFetches.get(i);if(!s){let[c,o]=R2(i),r=o?{name:i,icon:""}:Xo(c),a=this._enableJsonpLoading?".js":".svg",l=(o?`${this._assetsUrlRoot}assets/${o}/${c}`:`${this._assetsUrlRoot}assets/${r.theme}/${r.name}`)+a,h=this.sanitizer.sanitize(W0.URL,l);if(!h)throw sr(l);s=(this._enableJsonpLoading?this._loadIconDynamicallyWithJsonp(r,h):this._http.get(h,{responseType:"text"}).pipe(G(d=>v1(F({},r),{icon:d})))).pipe(y2(d=>this.addIcon(d)),D0(()=>this._inProgressFetches.delete(i)),O0(()=>w1(null)),M2()),this._inProgressFetches.set(i,s)}return s}_loadIconDynamicallyWithJsonp(i,s){return new j1(c=>{let o=this._document.createElement("script"),r=setTimeout(()=>{a(),c.error(or())},6e3);o.src=s;function a(){o.parentNode.removeChild(o),clearTimeout(r)}this._document.body.appendChild(o),this._jsonpIconLoad$.pipe(N4(l=>l.name===i.name&&l.theme===i.theme),I0(1)).subscribe(l=>{c.next(l),a()})})}_loadSVGFromCacheOrCreateNew(i,s){let c,o=s||this._twoToneColorPalette.primaryColor,r=Cn(o)||this._twoToneColorPalette.secondaryColor,a=i.theme==="twotone"?Yo(i.name,i.theme,o,r):i.theme===void 0?i.name:N2(i.name,i.theme),l=this._svgRenderedDefinitions.get(a);return l?c=l.icon:(c=this._setSVGAttribute(this._colorizeSVGIcon(this._createSVGElementFromString(tr(i.name)?i.icon:er(i.icon)),i.theme==="twotone",o,r)),this._svgRenderedDefinitions.set(a,v1(F({},i),{icon:c}))),Jo(c)}_createSVGElementFromString(i){let s=this._document.createElement("div");s.innerHTML=i;let c=s.querySelector("svg");if(!c)throw cr;return c}_setSVGAttribute(i){return this._renderer.setAttribute(i,"width","1em"),this._renderer.setAttribute(i,"height","1em"),i}_colorizeSVGIcon(i,s,c,o){if(s){let r=i.childNodes,a=r.length;for(let l=0;l<a;l++){let h=r[l];h.getAttribute("fill")==="secondaryColor"?this._renderer.setAttribute(h,"fill",o):this._renderer.setAttribute(h,"fill",c)}}return this._renderer.setAttribute(i,"fill","currentColor"),i}};e.\u0275fac=function(s){return new(s||e)(g(V2),g(x2,8),g(H2,8),g(S2),g(ar,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac});let t=e;return t})();function lr(t,e){return t.type===e.type&&t.theme===e.theme&&t.twoToneColor===e.twoToneColor}var xn=(()=>{let e=class e{constructor(i,s,c){this._iconService=i,this._elementRef=s,this._renderer=c}ngOnChanges(i){(i.type||i.theme||i.twoToneColor)&&this._changeIcon()}_changeIcon(){return new Promise(i=>{if(!this.type){this._clearSVGElement(),i(null);return}let s=this._getSelfRenderMeta();this._iconService.getRenderedContent(this._parseIconType(this.type,this.theme),this.twoToneColor).subscribe(c=>{let o=this._getSelfRenderMeta();lr(s,o)?(this._setSVGElement(c),i(c)):i(null)})})}_getSelfRenderMeta(){return{type:this.type,theme:this.theme,twoToneColor:this.twoToneColor}}_parseIconType(i,s){if(Hn(i))return i;{let[c,o]=R2(i);return o?i:Zo(c)?(s&&En(`'type' ${c} already gets a theme inside so 'theme' ${s} would be ignored`),c):N2(c,s||this._iconService.defaultTheme)}}_setSVGElement(i){this._clearSVGElement(),this._renderer.appendChild(this._elementRef.nativeElement,i)}_clearSVGElement(){let i=this._elementRef.nativeElement,s=i.childNodes,c=s.length;for(let o=c-1;o>=0;o--){let r=s[o];r.tagName?.toLowerCase()==="svg"&&this._renderer.removeChild(i,r)}}};e.\u0275fac=function(s){return new(s||e)(T(H8),T(d4),T(v4))},e.\u0275dir=r1({type:e,selectors:[["","antIcon",""]],inputs:{type:"type",theme:"theme",twoToneColor:"twoToneColor"},features:[f4]});let t=e;return t})();var Sn={isTestMode:!1};var Tn={},hr="[NG-ZORRO]:";function ur(...t){let e=t.reduce((n,i)=>n+i.toString(),"");return Tn[e]?!1:(Tn[e]=!0,!0)}function dr(t,...e){(Sn.isTestMode||m4()&&ur(...e))&&t(...e)}var _4=(...t)=>dr((...e)=>console.warn(hr,...e),...t);function Ln(t){return t!=null&&`${t}`!="false"}function fr(t){return Ln(t)}function vr(t,e){function n(i,s,c){let o=`$$__zorroPropDecorator__${s}`;return Object.prototype.hasOwnProperty.call(i,o)&&_4(`The prop "${o}" is already exist, it will be overrided by ${t} decorator.`),Object.defineProperty(i,o,{configurable:!0,writable:!0}),{get(){return c&&c.get?c.get.bind(this)():this[o]},set(r){c&&c.set&&c.set.bind(this)(e(r)),this[o]=e(r)}}}return n}function On(){return vr("InputBoolean",fr)}var mr=typeof window<"u",Jd=mr&&window.mozInnerScreenX!=null;function S8(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var pr="rc-util-key";function In({mark:t}={}){return t?t.startsWith("data-")?t:`data-${t}`:pr}function T8(t){return t.attachTo?t.attachTo:document.querySelector("head")||document.body}function An(t,e={}){if(!S8())return null;let n=document.createElement("style");e.cspNonce&&(n.nonce=e.cspNonce),n.innerHTML=t;let i=T8(e),{firstChild:s}=i;return e.prepend&&i.prepend?i.prepend(n):e.prepend&&s?i.insertBefore(n,s):i.appendChild(n),n}var x8=new Map;function gr(t,e={}){let n=T8(e);return Array.from(x8.get(n)?.children||[]).find(i=>i.tagName==="STYLE"&&i.getAttribute(In(e))===t)}function kn(t,e,n={}){let i=T8(n);if(!x8.has(i)){let o=An("",n),{parentNode:r}=o;x8.set(i,r),r.removeChild(o)}let s=gr(e,n);if(s)return n.cspNonce&&s.nonce!==n.cspNonce&&(s.nonce=n.cspNonce),s.innerHTML!==t&&(s.innerHTML=t),s;let c=An(t,n);return c?.setAttribute(In(n),e),c}var Bn={name:"bars",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z" /></svg>'};var Dn={name:"calendar",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z" /></svg>'},Nn={name:"caret-down",theme:"fill",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z" /></svg>'};var Rn={name:"caret-up",theme:"fill",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M858.9 689L530.5 308.2c-9.4-10.9-27.5-10.9-37 0L165.1 689c-12.2 14.2-1.2 35 18.5 35h656.8c19.7 0 30.7-20.8 18.5-35z" /></svg>'};var Fn={name:"check-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z" /></svg>'},Pn={name:"check-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z" /><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /></svg>'};var qn={name:"check",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z" /></svg>'};var Un={name:"caret-down",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z" /></svg>'};var jn={name:"close-circle",theme:"fill",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z" /></svg>'};var Wn={name:"close-circle",theme:"outline",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z" /></svg>'},Gn={name:"clock-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z" /></svg>'};var $n={name:"close",theme:"outline",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z" /></svg>'};var Kn={name:"caret-up",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M858.9 689L530.5 308.2c-9.4-10.9-27.5-10.9-37 0L165.1 689c-12.2 14.2-1.2 35 18.5 35h656.8c19.7 0 30.7-20.8 18.5-35z" /></svg>'};var Yn={name:"copy",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z" /></svg>'};var Qn={name:"delete",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z" /></svg>'};var tf={name:"dashboard",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M924.8 385.6a446.7 446.7 0 00-96-142.4 446.7 446.7 0 00-142.4-96C631.1 123.8 572.5 112 512 112s-119.1 11.8-174.4 35.2a446.7 446.7 0 00-142.4 96 446.7 446.7 0 00-96 142.4C75.8 440.9 64 499.5 64 560c0 132.7 58.3 257.7 159.9 343.1l1.7 1.4c5.8 4.8 13.1 7.5 20.6 7.5h531.7c7.5 0 14.8-2.7 20.6-7.5l1.7-1.4C901.7 817.7 960 692.7 960 560c0-60.5-11.9-119.1-35.2-174.4zM761.4 836H262.6A371.12 371.12 0 01140 560c0-99.4 38.7-192.8 109-263 70.3-70.3 163.7-109 263-109 99.4 0 192.8 38.7 263 109 70.3 70.3 109 163.7 109 263 0 105.6-44.5 205.5-122.6 276zM623.5 421.5a8.03 8.03 0 00-11.3 0L527.7 506c-18.7-5-39.4-.2-54.1 14.5a55.95 55.95 0 000 79.2 55.95 55.95 0 0079.2 0 55.87 55.87 0 0014.5-54.1l84.5-84.5c3.1-3.1 3.1-8.2 0-11.3l-28.3-28.3zM490 320h44c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8h-44c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8zm260 218v44c0 4.4 3.6 8 8 8h80c4.4 0 8-3.6 8-8v-44c0-4.4-3.6-8-8-8h-80c-4.4 0-8 3.6-8 8zm12.7-197.2l-31.1-31.1a8.03 8.03 0 00-11.3 0l-56.6 56.6a8.03 8.03 0 000 11.3l31.1 31.1c3.1 3.1 8.2 3.1 11.3 0l56.6-56.6c3.1-3.1 3.1-8.2 0-11.3zm-458.6-31.1a8.03 8.03 0 00-11.3 0l-31.1 31.1a8.03 8.03 0 000 11.3l56.6 56.6c3.1 3.1 8.2 3.1 11.3 0l31.1-31.1c3.1-3.1 3.1-8.2 0-11.3l-56.6-56.6zM262 530h-80c-4.4 0-8 3.6-8 8v44c0 4.4 3.6 8 8 8h80c4.4 0 8-3.6 8-8v-44c0-4.4-3.6-8-8-8z" /></svg>'};var Zn={name:"double-left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M272.9 512l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512zm304 0l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z" /></svg>'};var Xn={name:"double-right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1A7.98 7.98 0 00188 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5zm304 0L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1A7.98 7.98 0 00492 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z" /></svg>'};var Jn={name:"down",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z" /></svg>'};var ei={name:"edit",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z" /></svg>'},ti={name:"ellipsis",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z" /></svg>'};var ni={name:"exclamation-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z" /></svg>'};var ii={name:"exclamation-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z" /></svg>'};var si={name:"file",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M854.6 288.7c6 6 9.4 14.1 9.4 22.6V928c0 17.7-14.3 32-32 32H192c-17.7 0-32-14.3-32-32V96c0-17.7 14.3-32 32-32h424.7c8.5 0 16.7 3.4 22.7 9.4l215.2 215.3zM790.2 326L602 137.8V326h188.2z" /></svg>'};var ci={name:"filter",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M349 838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V642H349v196zm531.1-684H143.9c-24.5 0-39.8 26.7-27.5 48l221.3 376h348.8l221.3-376c12.1-21.3-3.2-48-27.7-48z" /></svg>'};var nf={name:"form",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z" /><path d="M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z" /></svg>'};var oi={name:"info-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z" /></svg>'};var ri={name:"info-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z" /></svg>'};var ai={name:"file",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z" /></svg>'};var li={name:"left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z" /></svg>'};var hi={name:"loading",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z" /></svg>'};var ui={name:"eye",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z" /></svg>'};var sf={name:"menu-unfold",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z" /></svg>'};var cf={name:"menu-fold",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 000 13.8z" /></svg>'};var di={name:"paper-clip",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z" /></svg>'};var fi={name:"question-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z" /></svg>'};var vi={name:"right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z" /></svg>'};var mi={name:"rotate-left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><defs><style /></defs><path d="M672 418H144c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H188V494h440v326z" /><path d="M819.3 328.5c-78.8-100.7-196-153.6-314.6-154.2l-.2-64c0-6.5-7.6-10.1-12.6-6.1l-128 101c-4 3.1-3.9 9.1 0 12.3L492 318.6c5.1 4 12.7.4 12.6-6.1v-63.9c12.9.1 25.9.9 38.8 2.5 42.1 5.2 82.1 18.2 119 38.7 38.1 21.2 71.2 49.7 98.4 84.3 27.1 34.7 46.7 73.7 58.1 115.8a325.95 325.95 0 016.5 140.9h74.9c14.8-103.6-11.3-213-81-302.3z" /></svg>'};var pi={name:"rotate-right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><defs><style /></defs><path d="M480.5 251.2c13-1.6 25.9-2.4 38.8-2.5v63.9c0 6.5 7.5 10.1 12.6 6.1L660 217.6c4-3.2 4-9.2 0-12.3l-128-101c-5.1-4-12.6-.4-12.6 6.1l-.2 64c-118.6.5-235.8 53.4-314.6 154.2A399.75 399.75 0 00123.5 631h74.9c-.9-5.3-1.7-10.7-2.4-16.1-5.1-42.1-2.1-84.1 8.9-124.8 11.4-42.2 31-81.1 58.1-115.8 27.2-34.7 60.3-63.2 98.4-84.3 37-20.6 76.9-33.6 119.1-38.8z" /><path d="M880 418H352c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H396V494h440v326z" /></svg>'};var gi={name:"search",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z" /></svg>'};var L8={name:"star",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z" /></svg>'};var _i={name:"swap-right",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M873.1 596.2l-164-208A32 32 0 00684 376h-64.8c-6.7 0-10.4 7.7-6.3 13l144.3 183H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h695.9c26.8 0 41.7-30.8 25.2-51.8z" /></svg>'};var zi={name:"upload",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z" /></svg>'},wi={name:"up",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z" /></svg>'};var Mi={name:"vertical-align-top",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z" /></svg>'};var yi={name:"zoom-in",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z" /></svg>'};var bi={name:"zoom-out",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z" /></svg>'};var F2=2,Ci=.16,_r=.05,zr=.05,wr=.15,Si=5,Ti=4,Mr=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function Vi({r:t,g:e,b:n}){let i=p4(t,e,n);return{h:i.h*360,s:i.s,v:i.v}}function P2({r:t,g:e,b:n}){return`#${g4(t,e,n,!1)}`}function yr(t,e,n){let i=n/100;return{r:(e.r-t.r)*i+t.r,g:(e.g-t.g)*i+t.g,b:(e.b-t.b)*i+t.b}}function Ei(t,e,n){let i;return Math.round(t.h)>=60&&Math.round(t.h)<=240?i=n?Math.round(t.h)-F2*e:Math.round(t.h)+F2*e:i=n?Math.round(t.h)+F2*e:Math.round(t.h)-F2*e,i<0?i+=360:i>=360&&(i-=360),i}function Hi(t,e,n){if(t.h===0&&t.s===0)return t.s;let i;return n?i=t.s-Ci*e:e===Ti?i=t.s+Ci:i=t.s+_r*e,i>1&&(i=1),n&&e===Si&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2))}function xi(t,e,n){let i;return n?i=t.v+zr*e:i=t.v-wr*e,i>1&&(i=1),Number(i.toFixed(2))}function A8(t,e={}){let n=[],i=i1(t);for(let s=Si;s>0;s-=1){let c=Vi(i),o=P2(i1({h:Ei(c,s,!0),s:Hi(c,s,!0),v:xi(c,s,!0)}));n.push(o)}n.push(P2(i));for(let s=1;s<=Ti;s+=1){let c=Vi(i),o=P2(i1({h:Ei(c,s),s:Hi(c,s),v:xi(c,s)}));n.push(o)}return e.theme==="dark"?Mr.map(({index:s,opacity:c})=>P2(yr(i1(e.backgroundColor||"#141414"),i1(n[s]),c*100))):n}var br=new H("nz-config");var Cr=`-ant-${Date.now()}-${Math.random()}`;function Vr(t,e){let n={},i=(o,r)=>{let a=o.clone();return a=r?.(a)||a,a.toRgbString()},s=(o,r)=>{let a=new k2(o),l=A8(a.toRgbString());n[`${r}-color`]=i(a),n[`${r}-color-disabled`]=l[1],n[`${r}-color-hover`]=l[4],n[`${r}-color-active`]=l[7],n[`${r}-color-outline`]=a.clone().setAlpha(.2).toRgbString(),n[`${r}-color-deprecated-bg`]=l[1],n[`${r}-color-deprecated-border`]=l[3]};if(e.primaryColor){s(e.primaryColor,"primary");let o=new k2(e.primaryColor),r=A8(o.toRgbString());r.forEach((l,h)=>{n[`primary-${h+1}`]=l}),n["primary-color-deprecated-l-35"]=i(o,l=>l.lighten(35)),n["primary-color-deprecated-l-20"]=i(o,l=>l.lighten(20)),n["primary-color-deprecated-t-20"]=i(o,l=>l.tint(20)),n["primary-color-deprecated-t-50"]=i(o,l=>l.tint(50)),n["primary-color-deprecated-f-12"]=i(o,l=>l.setAlpha(l.getAlpha()*.12));let a=new k2(r[0]);n["primary-color-active-deprecated-f-30"]=i(a,l=>l.setAlpha(l.getAlpha()*.3)),n["primary-color-active-deprecated-d-02"]=i(a,l=>l.darken(2))}return e.successColor&&s(e.successColor,"success"),e.warningColor&&s(e.warningColor,"warning"),e.errorColor&&s(e.errorColor,"error"),e.infoColor&&s(e.infoColor,"info"),`
  :root {
    ${Object.keys(n).map(o=>`--${t}-${o}: ${n[o]};`).join(`
`)}
  }
  `.trim()}function Li(t,e,n){let i=Vr(t,e);S8()?kn(i,`${Cr}-dynamic-theme`,{cspNonce:n}):_4("NzConfigService: SSR do not support dynamic theme with css variables.")}var Ai="ant",Oi=(()=>{let e=class e{constructor(i,s){this.configUpdated$=new k1,this.config=i||{},this.cspNonce=s,this.config.theme&&Li(this.getConfig().prefixCls?.prefixCls||Ai,this.config.theme,s)}getConfig(){return this.config}getConfigForComponent(i){return this.config[i]}getConfigChangeEventForComponent(i){return this.configUpdated$.pipe(N4(s=>s===i),k0(void 0))}set(i,s){this.config[i]=F(F({},this.config[i]),s),i==="theme"&&this.config.theme&&Li(this.getConfig().prefixCls?.prefixCls||Ai,this.config.theme,this.cspNonce),this.configUpdated$.next(i)}};e.\u0275fac=function(s){return new(s||e)(g(br,8),g(q0,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var O8;try{O8=typeof Intl<"u"&&Intl.v8BreakIterator}catch{O8=!1}var Ii=(()=>{let e=class e{constructor(i){this._platformId=i,this.isBrowser=this._platformId?K0(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||O8)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(s){return new(s||e)(g(W1))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var xr=[Bn,Dn,Rn,Kn,Nn,Un,Fn,Pn,qn,Gn,Wn,jn,$n,Yn,Qn,Zn,Xn,Jn,ei,ti,ii,ni,ui,si,ai,ci,ri,oi,li,hi,di,fi,vi,pi,mi,L8,gi,L8,zi,Mi,wi,_i,yi,bi],Bi=new H("nz_icons"),qf=new H("nz_icon_default_twotone_color"),ki="#1890ff",Di=(()=>{let e=class e extends H8{get _disableDynamicLoading(){return!this.platform.isBrowser}ngOnDestroy(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}normalizeSvgElement(i){i.getAttribute("viewBox")||this._renderer.setAttribute(i,"viewBox","0 0 1024 1024"),(!i.getAttribute("width")||!i.getAttribute("height"))&&(this._renderer.setAttribute(i,"width","1em"),this._renderer.setAttribute(i,"height","1em")),i.getAttribute("fill")||this._renderer.setAttribute(i,"fill","currentColor")}fetchFromIconfont(i){let{scriptUrl:s}=i;if(this._document&&!this.iconfontCache.has(s)){let c=this._renderer.createElement("script");this._renderer.setAttribute(c,"src",s),this._renderer.setAttribute(c,"data-namespace",s.replace(/^(https?|http):/g,"")),this._renderer.appendChild(this._document.body,c),this.iconfontCache.add(s)}}createIconfontIcon(i){return this._createSVGElementFromString(`<svg><use xlink:href="${i}"></svg>`)}constructor(i,s,c,o,r,a,l){super(i,r,a,s,[...xr,...l||[]]),this.nzConfigService=c,this.platform=o,this.configUpdated$=new k1,this.iconfontCache=new Set,this.subscription=null,this.onConfigChange(),this.configDefaultTwotoneColor(),this.configDefaultTheme()}onConfigChange(){this.subscription=this.nzConfigService.getConfigChangeEventForComponent("icon").subscribe(()=>{this.configDefaultTwotoneColor(),this.configDefaultTheme(),this.configUpdated$.next()})}configDefaultTheme(){let i=this.getConfig();this.defaultTheme=i.nzTheme||"outline"}configDefaultTwotoneColor(){let s=this.getConfig().nzTwotoneColor||ki,c=ki;s&&(s.startsWith("#")?c=s:_4("Twotone color must be a hex color!")),this.twoToneColor={primaryColor:c}}getConfig(){return this.nzConfigService.getConfigForComponent("icon")||{}}};e.\u0275fac=function(s){return new(s||e)(g(V2),g(S2),g(Oi),g(Ii),g(x2,8),g(H2,8),g(Bi,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Ni=new H("nz_icons_patch"),Ri=(()=>{let e=class e{constructor(i,s){this.extraIcons=i,this.rootIconService=s,this.patched=!1}doPatch(){this.patched||(this.extraIcons.forEach(i=>this.rootIconService.addIcon(i)),this.patched=!0)}};e.\u0275fac=function(s){return new(s||e)(g(Ni,2),g(Di))},e.\u0275prov=j({token:e,factory:e.\u0275fac});let t=e;return t})(),Uf=(()=>{let e=class e extends xn{set nzSpin(i){this.spin=i}set nzType(i){this.type=i}set nzTheme(i){this.theme=i}set nzTwotoneColor(i){this.twoToneColor=i}set nzIconfont(i){this.iconfont=i}constructor(i,s,c,o,r,a){super(o,c,r),this.ngZone=i,this.changeDetectorRef=s,this.iconService=o,this.renderer=r,this.cacheClassName=null,this.nzRotate=0,this.spin=!1,this.destroy$=new k1,a&&a.doPatch(),this.el=c.nativeElement}ngOnChanges(i){let{nzType:s,nzTwotoneColor:c,nzSpin:o,nzTheme:r,nzRotate:a}=i;s||c||o||r?this.changeIcon2():a?this.handleRotate(this.el.firstChild):this._setSVGElement(this.iconService.createIconfontIcon(`#${this.iconfont}`))}ngOnInit(){this.renderer.setAttribute(this.el,"class",`anticon ${this.el.className}`.trim())}ngAfterContentChecked(){if(!this.type){let i=this.el.children,s=i.length;if(!this.type&&i.length)for(;s--;){let c=i[s];c.tagName.toLowerCase()==="svg"&&this.iconService.normalizeSvgElement(c)}}}ngOnDestroy(){this.destroy$.next()}changeIcon2(){this.setClassName(),this.ngZone.runOutsideAngular(()=>{u4(this._changeIcon()).pipe(F0(this.destroy$)).subscribe({next:i=>{this.ngZone.run(()=>{this.changeDetectorRef.detectChanges(),i&&(this.setSVGData(i),this.handleSpin(i),this.handleRotate(i))})},error:_4})})}handleSpin(i){this.spin||this.type==="loading"?this.renderer.addClass(i,"anticon-spin"):this.renderer.removeClass(i,"anticon-spin")}handleRotate(i){this.nzRotate?this.renderer.setAttribute(i,"style",`transform: rotate(${this.nzRotate}deg)`):this.renderer.removeAttribute(i,"style")}setClassName(){this.cacheClassName&&this.renderer.removeClass(this.el,this.cacheClassName),this.cacheClassName=`anticon-${this.type}`,this.renderer.addClass(this.el,this.cacheClassName)}setSVGData(i){this.renderer.setAttribute(i,"data-icon",this.type),this.renderer.setAttribute(i,"aria-hidden","true")}};e.\u0275fac=function(s){return new(s||e)(T(E1),T(m8),T(d4),T(Di),T(v4),T(Ri,8))},e.\u0275dir=r1({type:e,selectors:[["","nz-icon",""]],hostVars:2,hostBindings:function(s,c){s&2&&_e("anticon",!0)},inputs:{nzSpin:"nzSpin",nzRotate:"nzRotate",nzType:"nzType",nzTheme:"nzTheme",nzTwotoneColor:"nzTwotoneColor",nzIconfont:"nzIconfont"},exportAs:["nzIcon"],standalone:!0,features:[D1,f4]});let t=e;return L0([On()],t.prototype,"nzSpin",null),t})(),jf=(()=>{let e=class e{static forRoot(i){return{ngModule:e,providers:[{provide:Bi,useValue:i}]}}static forChild(i){return{ngModule:e,providers:[Ri,{provide:Ni,useValue:i}]}}};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=o1({type:e}),e.\u0275inj=a1({});let t=e;return t})();var Ki=(()=>{let e=class e{constructor(i,s){this._renderer=i,this._elementRef=s,this.onChange=c=>{},this.onTouched=()=>{}}setProperty(i,s){this._renderer.setProperty(this._elementRef.nativeElement,i,s)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}};e.\u0275fac=function(s){return new(s||e)(T(v4),T(d4))},e.\u0275dir=r1({type:e});let t=e;return t})(),Sr=(()=>{let e=class e extends Ki{};e.\u0275fac=(()=>{let i;return function(c){return(i||(i=j0(e)))(c||e)}})(),e.\u0275dir=r1({type:e,features:[D1]});let t=e;return t})(),Yi=new H("");var Tr={provide:Yi,useExisting:C2(()=>Qi),multi:!0};function Lr(){let t=p8()?p8().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var Ar=new H(""),Qi=(()=>{let e=class e extends Ki{constructor(i,s,c){super(i,s),this._compositionMode=c,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!Lr())}writeValue(i){let s=i??"";this.setProperty("value",s)}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}};e.\u0275fac=function(s){return new(s||e)(T(v4),T(d4),T(Ar,8))},e.\u0275dir=r1({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(s,c){s&1&&f8("input",function(r){return c._handleInput(r.target.value)})("blur",function(){return c.onTouched()})("compositionstart",function(){return c._compositionStart()})("compositionend",function(r){return c._compositionEnd(r.target.value)})},features:[E2([Tr]),D1]});let t=e;return t})();var Zi=new H(""),Xi=new H("");function Ji(t){return t!=null}function e5(t){return $0(t)?u4(t):t}function t5(t){let e={};return t.forEach(n=>{e=n!=null?F(F({},e),n):e}),Object.keys(e).length===0?null:e}function n5(t,e){return e.map(n=>n(t))}function Or(t){return!t.validate}function i5(t){return t.map(e=>Or(e)?e:n=>e.validate(n))}function Ir(t){if(!t)return null;let e=t.filter(Ji);return e.length==0?null:function(n){return t5(n5(n,e))}}function s5(t){return t!=null?Ir(i5(t)):null}function kr(t){if(!t)return null;let e=t.filter(Ji);return e.length==0?null:function(n){let i=n5(n,e).map(e5);return A0(i).pipe(G(t5))}}function c5(t){return t!=null?kr(i5(t)):null}function Fi(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function o5(t){return t._rawValidators}function r5(t){return t._rawAsyncValidators}function I8(t){return t?Array.isArray(t)?t:[t]:[]}function j2(t,e){return Array.isArray(t)?t.includes(e):t===e}function Pi(t,e){let n=I8(e);return I8(t).forEach(s=>{j2(n,s)||n.push(s)}),n}function qi(t,e){return I8(e).filter(n=>!j2(t,n))}var W2=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=s5(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=c5(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},U4=class extends W2{get formDirective(){return null}get path(){return null}},He=class extends W2{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},G2=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},Br={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},uv=v1(F({},Br),{"[class.ng-submitted]":"isSubmitted"}),dv=(()=>{let e=class e extends G2{constructor(i){super(i)}};e.\u0275fac=function(s){return new(s||e)(T(He,2))},e.\u0275dir=r1({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(s,c){s&2&&_e("ng-untouched",c.isUntouched)("ng-touched",c.isTouched)("ng-pristine",c.isPristine)("ng-dirty",c.isDirty)("ng-valid",c.isValid)("ng-invalid",c.isInvalid)("ng-pending",c.isPending)},features:[D1]});let t=e;return t})(),fv=(()=>{let e=class e extends G2{constructor(i){super(i)}};e.\u0275fac=function(s){return new(s||e)(T(U4,10))},e.\u0275dir=r1({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(s,c){s&2&&_e("ng-untouched",c.isUntouched)("ng-touched",c.isTouched)("ng-pristine",c.isPristine)("ng-dirty",c.isDirty)("ng-valid",c.isValid)("ng-invalid",c.isInvalid)("ng-pending",c.isPending)("ng-submitted",c.isSubmitted)},features:[D1]});let t=e;return t})();var Ve="VALID",q2="INVALID",q4="PENDING",Ee="DISABLED";function D8(t){return(Q2(t)?t.validators:t)||null}function Dr(t){return Array.isArray(t)?s5(t):t||null}function N8(t,e){return(Q2(e)?e.asyncValidators:t)||null}function Nr(t){return Array.isArray(t)?c5(t):t||null}function Q2(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function a5(t,e,n){let i=t.controls;if(!(e?Object.keys(i):i).length)throw new b2(1e3,"");if(!i[n])throw new b2(1001,"")}function l5(t,e,n){t._forEachChild((i,s)=>{if(n[s]===void 0)throw new b2(1002,"")})}var j4=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Ve}get invalid(){return this.status===q2}get pending(){return this.status==q4}get disabled(){return this.status===Ee}get enabled(){return this.status!==Ee}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Pi(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Pi(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(qi(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(qi(e,this._rawAsyncValidators))}hasValidator(e){return j2(this._rawValidators,e)}hasAsyncValidator(e){return j2(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=q4,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Ee,this.errors=null,this._forEachChild(i=>{i.disable(v1(F({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(v1(F({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Ve,this._forEachChild(i=>{i.enable(v1(F({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(v1(F({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ve||this.status===q4)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ee:Ve}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=q4,this._hasOwnPendingAsyncValidator=!0;let n=e5(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((i,s)=>i&&i._find(s),this)}getError(e,n){let i=n?this.get(n):this;return i&&i.errors?i.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new pe,this.statusChanges=new pe}_calculateStatus(){return this._allControlsDisabled()?Ee:this.errors?q2:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(q4)?q4:this._anyControlsHaveStatus(q2)?q2:Ve}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Q2(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=Dr(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=Nr(this._rawAsyncValidators)}},$2=class extends j4{constructor(e,n,i){super(D8(n),N8(i,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,i={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){l5(this,!0,e),Object.keys(e).forEach(i=>{a5(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(i=>{let s=this.controls[i];s&&s.patchValue(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((i,s)=>{i.reset(e?e[s]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,i)=>(e[i]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,i)=>i._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let i=this.controls[n];i&&e(i,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,i]of Object.entries(this.controls))if(this.contains(n)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,i,s)=>((i.enabled||this.disabled)&&(n[s]=i.value),n))}_reduceChildren(e,n){let i=e;return this._forEachChild((s,c)=>{i=n(i,s,c)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var k8=class extends $2{};var R8=new H("CallSetDisabledState",{providedIn:"root",factory:()=>Z2}),Z2="always";function Rr(t,e){return[...e.path,t]}function Ui(t,e,n=Z2){F8(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),Pr(t,e),Ur(t,e),qr(t,e),Fr(t,e)}function ji(t,e,n=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),Y2(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function K2(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function Fr(t,e){if(e.valueAccessor.setDisabledState){let n=i=>{e.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function F8(t,e){let n=o5(t);e.validator!==null?t.setValidators(Fi(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let i=r5(t);e.asyncValidator!==null?t.setAsyncValidators(Fi(i,e.asyncValidator)):typeof i=="function"&&t.setAsyncValidators([i]);let s=()=>t.updateValueAndValidity();K2(e._rawValidators,s),K2(e._rawAsyncValidators,s)}function Y2(t,e){let n=!1;if(t!==null){if(e.validator!==null){let s=o5(t);if(Array.isArray(s)&&s.length>0){let c=s.filter(o=>o!==e.validator);c.length!==s.length&&(n=!0,t.setValidators(c))}}if(e.asyncValidator!==null){let s=r5(t);if(Array.isArray(s)&&s.length>0){let c=s.filter(o=>o!==e.asyncValidator);c.length!==s.length&&(n=!0,t.setAsyncValidators(c))}}}let i=()=>{};return K2(e._rawValidators,i),K2(e._rawAsyncValidators,i),n}function Pr(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&h5(t,e)})}function qr(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&h5(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function h5(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function Ur(t,e){let n=(i,s)=>{e.valueAccessor.writeValue(i),s&&e.viewToModelUpdate(i)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function jr(t,e){t==null,F8(t,e)}function Wr(t,e){return Y2(t,e)}function Gr(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function $r(t){return Object.getPrototypeOf(t.constructor)===Sr}function Kr(t,e){t._syncPendingControls(),e.forEach(n=>{let i=n.control;i.updateOn==="submit"&&i._pendingChange&&(n.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function Yr(t,e){if(!e)return null;Array.isArray(e);let n,i,s;return e.forEach(c=>{c.constructor===Qi?n=c:$r(c)?i=c:s=c}),s||i||n||null}function Qr(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Wi(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Gi(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var U2=class extends j4{constructor(e=null,n,i){super(D8(n),N8(i,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Q2(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Gi(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Wi(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Wi(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Gi(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Zr=t=>t instanceof U2;var mv=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275dir=r1({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})();var u5=new H("");var Xr={provide:U4,useExisting:C2(()=>Jr)},Jr=(()=>{let e=class e extends U4{constructor(i,s,c){super(),this.callSetDisabledState=c,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new pe,this._setValidators(i),this._setAsyncValidators(s)}ngOnChanges(i){this._checkFormPresent(),i.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Y2(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(i){let s=this.form.get(i.path);return Ui(s,i,this.callSetDisabledState),s.updateValueAndValidity({emitEvent:!1}),this.directives.push(i),s}getControl(i){return this.form.get(i.path)}removeControl(i){ji(i.control||null,i,!1),Qr(this.directives,i)}addFormGroup(i){this._setUpFormContainer(i)}removeFormGroup(i){this._cleanUpFormContainer(i)}getFormGroup(i){return this.form.get(i.path)}addFormArray(i){this._setUpFormContainer(i)}removeFormArray(i){this._cleanUpFormContainer(i)}getFormArray(i){return this.form.get(i.path)}updateModel(i,s){this.form.get(i.path).setValue(s)}onSubmit(i){return this.submitted=!0,Kr(this.form,this.directives),this.ngSubmit.emit(i),i?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this.submitted=!1}_updateDomValue(){this.directives.forEach(i=>{let s=i.control,c=this.form.get(i.path);s!==c&&(ji(s||null,i),Zr(c)&&(Ui(c,i,this.callSetDisabledState),i.control=c))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(i){let s=this.form.get(i.path);jr(s,i),s.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(i){if(this.form){let s=this.form.get(i.path);s&&Wr(s,i)&&s.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){F8(this.form,this),this._oldForm&&Y2(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(s){return new(s||e)(T(Zi,10),T(Xi,10),T(R8,8))},e.\u0275dir=r1({type:e,selectors:[["","formGroup",""]],hostBindings:function(s,c){s&1&&f8("submit",function(r){return c.onSubmit(r)})("reset",function(){return c.onReset()})},inputs:{form:[ge.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[E2([Xr]),D1,f4]});let t=e;return t})();var ea={provide:He,useExisting:C2(()=>ta)},ta=(()=>{let e=class e extends He{set isDisabled(i){}constructor(i,s,c,o,r){super(),this._ngModelWarningConfig=r,this._added=!1,this.name=null,this.update=new pe,this._ngModelWarningSent=!1,this._parent=i,this._setValidators(s),this._setAsyncValidators(c),this.valueAccessor=Yr(this,o)}ngOnChanges(i){this._added||this._setUpControl(),Gr(i,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}get path(){return Rr(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(s){return new(s||e)(T(U4,13),T(Zi,10),T(Xi,10),T(Yi,10),T(u5,8))},e.\u0275dir=r1({type:e,selectors:[["","formControlName",""]],inputs:{name:[ge.None,"formControlName","name"],isDisabled:[ge.None,"disabled","isDisabled"],model:[ge.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[E2([ea]),D1,f4]});let t=e;return t})();var d5=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=o1({type:e}),e.\u0275inj=a1({});let t=e;return t})(),B8=class extends j4{constructor(e,n,i){super(D8(n),N8(i,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,n={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(e,n,i={}){this.controls.splice(e,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(e,n,i={}){let s=this._adjustIndex(e);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),n&&(this.controls.splice(s,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,n={}){l5(this,!1,e),e.forEach((i,s)=>{a5(this,!1,s),this.at(s).setValue(i,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(e.forEach((i,s)=>{this.at(s)&&this.at(s).patchValue(i,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e=[],n={}){this._forEachChild((i,s)=>{i.reset(e[s],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((n,i)=>i._syncPendingControls()?!0:n,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((n,i)=>{e(n,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(n=>n.enabled&&e(n))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function $i(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var pv=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let i=new e;return i.useNonNullable=!0,i}group(i,s=null){let c=this._reduceControls(i),o={};return $i(s)?o=s:s!==null&&(o.validators=s.validator,o.asyncValidators=s.asyncValidator),new $2(c,o)}record(i,s=null){let c=this._reduceControls(i);return new k8(c,s)}control(i,s,c){let o={};return this.useNonNullable?($i(s)?o=s:(o.validators=s,o.asyncValidators=c),new U2(i,v1(F({},o),{nonNullable:!0}))):new U2(i,s,c)}array(i,s,c){let o=i.map(r=>this._createControl(r));return new B8(o,s,c)}_reduceControls(i){let s={};return Object.keys(i).forEach(c=>{s[c]=this._createControl(i[c])}),s}_createControl(i){if(i instanceof U2)return i;if(i instanceof j4)return i;if(Array.isArray(i)){let s=i[0],c=i.length>1?i[1]:null,o=i.length>2?i[2]:null;return this.control(s,c,o)}else return this.control(i)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var gv=(()=>{let e=class e{static withConfig(i){return{ngModule:e,providers:[{provide:R8,useValue:i.callSetDisabledState??Z2}]}}};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=o1({type:e}),e.\u0275inj=a1({imports:[d5]});let t=e;return t})(),_v=(()=>{let e=class e{static withConfig(i){return{ngModule:e,providers:[{provide:u5,useValue:i.warnOnNgModelWithFormControl??"always"},{provide:R8,useValue:i.callSetDisabledState??Z2}]}}};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=o1({type:e}),e.\u0275inj=a1({imports:[d5]});let t=e;return t})();var na="firebase",ia="10.10.0";$1(na,ia,"app");var W4=new v8("ANGULARFIRE2_VERSION");var sa=(t,e)=>{let n=e?[e]:un(),i=[];return n.forEach(s=>{s.container.getProvider(t).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i},z4=class{constructor(){return sa(ca)}},ca="app-check";function P8(){}var X2=class{zone;delegate;constructor(e,n=T0){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,i){let s=this.zone,c=function(o){s.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(c,n,i)}},q8=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",P8,{},P8,P8)),n.pipe(y2({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},J2=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new X2(Zone.current)),this.insideAngular=n.run(()=>new X2(Zone.current,w2)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||t)(g(E1))};static \u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function oa(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function P1(t){return ra(oa())(t)}function ra(t){return function(n){return n=n.lift(new q8(t.ngZone)),n.pipe(D4(t.outsideAngular),h4(t.insideAngular))}}var aa="firebase",la="10.10.0";t1.registerVersion(aa,la,"app-compat");var ha=["ngOnDestroy"],m5=(t,e,n,i={})=>new Proxy(t,{get:(s,c)=>n.runOutsideAngular(()=>{if(t[c])return i?.spy?.get&&i.spy.get(c,t[c]),t[c];if(ha.indexOf(c)>-1)return()=>{};let o=e.toPromise().then(r=>{let a=r?.[c];return typeof a=="function"?a.bind(r):a?.then?a.then(l=>n.run(()=>l)):n.run(()=>a)});return new Proxy(()=>{},{get:(r,a)=>o[a],apply:(r,a,l)=>o.then(h=>{let u=h?.(...l);return i?.spy?.apply&&i.spy.apply(c,l,u),u})})})});var e3=class{constructor(e){return e}},G4=new H("angularfire2.app.options"),$4=new H("angularfire2.app.name");function xe(t,e,n){let i=typeof n=="string"&&n||"[DEFAULT]",s=typeof n=="object"&&n||{};s.name=s.name||i;let o=t1.apps.filter(r=>r&&r.name===s.name)[0]||e.runOutsideAngular(()=>t1.initializeApp(t,s));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let r=!!module.hot;ua("error",`${o.name} Firebase App already initialized with different options${r?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new e3(o)}var ua=(t,...e)=>{m4()&&typeof console<"u"&&console[t](...e)},da={provide:e3,useFactory:xe,deps:[G4,E1,[new U0,$4]]},Dv=(()=>{class t{static initializeApp(n,i){return{ngModule:t,providers:[{provide:G4,useValue:n},{provide:$4,useValue:i}]}}constructor(n){t1.registerVersion("angularfire",W4.full,"core"),t1.registerVersion("angularfire",W4.full,"app-compat"),t1.registerVersion("angular",G0.full,n.toString())}static \u0275fac=function(i){return new(i||t)(g(W1))};static \u0275mod=o1({type:t});static \u0275inj=a1({providers:[da]})}return t})();function t3(t,e,n,i,s){let[,c,o]=globalThis.\u0275AngularfireInstanceCache.find(r=>r[0]===t)||[];if(c)return fa(s,o)||(v5("error",`${e} was already initialized on the ${n} Firebase App with different settings.${va?" You may need to reload as Firebase is not HMR aware.":""}`),v5("warn",{is:s,was:o})),c;{let r=i();return globalThis.\u0275AngularfireInstanceCache.push([t,r,s]),r}}function fa(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var va=typeof module<"u"&&!!module.hot,v5=(t,...e)=>{m4()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var ga=new Map,_a={activated:!1,tokenObservers:[]},za={initialized:!1,enabled:!1};function y1(t){return ga.get(t)||Object.assign({},_a)}function w5(){return za}var wa="https://content-firebaseappcheck.googleapis.com/v1";var Ma="exchangeDebugToken",p5={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},$v=24*60*60*1e3;var j8=class{constructor(e,n,i,s,c){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=i,this.lowerBound=s,this.upperBound=c,this.pending=null,this.nextErrorWaitInterval=s,s>c)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return V1(this,null,function*(){this.stop();try{this.pending=new P,this.pending.promise.catch(n=>{}),yield ya(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new P,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function ya(t){return new Promise(e=>{setTimeout(e,t)})}var ba={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Z1=new nn("appCheck","AppCheck",ba);function M5(t){if(!y1(t).activated)throw Z1.create("use-before-activation",{appName:t.name})}function y5(i,s){return V1(this,arguments,function*({url:t,body:e},n){let c={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let v=yield o.getHeartbeatsHeader();v&&(c["X-Firebase-Client"]=v)}let r={method:"POST",body:JSON.stringify(e),headers:c},a;try{a=yield fetch(t,r)}catch(v){throw Z1.create("fetch-network-error",{originalErrorMessage:v?.message})}if(a.status!==200)throw Z1.create("fetch-status-error",{httpStatus:a.status});let l;try{l=yield a.json()}catch(v){throw Z1.create("fetch-parse-error",{originalErrorMessage:v?.message})}let h=l.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw Z1.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let u=Number(h[1])*1e3,d=Date.now();return{token:l.token,expireTimeMillis:d+u,issuedAtTimeMillis:d}})}function b5(t,e){let{projectId:n,appId:i,apiKey:s}=t.options;return{url:`${wa}/projects/${n}/apps/${i}:${Ma}?key=${s}`,body:{debug_token:e}}}var Ca="firebase-app-check-database",Va=1,W8="firebase-app-check-store";var n3=null;function Ea(){return n3||(n3=new Promise((t,e)=>{try{let n=indexedDB.open(Ca,Va);n.onsuccess=i=>{t(i.target.result)},n.onerror=i=>{var s;e(Z1.create("storage-open",{originalErrorMessage:(s=i.target.error)===null||s===void 0?void 0:s.message}))},n.onupgradeneeded=i=>{let s=i.target.result;switch(i.oldVersion){case 0:s.createObjectStore(W8,{keyPath:"compositeKey"})}}}catch(n){e(Z1.create("storage-open",{originalErrorMessage:n?.message}))}}),n3)}function Ha(t,e){return xa(Sa(t),e)}function xa(t,e){return V1(this,null,function*(){let i=(yield Ea()).transaction(W8,"readwrite"),c=i.objectStore(W8).put({compositeKey:t,value:e});return new Promise((o,r)=>{c.onsuccess=a=>{o()},i.onerror=a=>{var l;r(Z1.create("storage-set",{originalErrorMessage:(l=a.target.error)===null||l===void 0?void 0:l.message}))}})})}function Sa(t){return`${t.options.appId}-${t.name}`}var G8=new F4("@firebase/app-check");function U8(t,e){return tn()?Ha(t,e).catch(n=>{G8.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function C5(){return w5().enabled}function V5(){return V1(this,null,function*(){let t=w5();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Ta={error:"UNKNOWN_ERROR"};function La(t){return T2.encodeString(JSON.stringify(t),!1)}function $8(t,e=!1){return V1(this,null,function*(){let n=t.app;M5(n);let i=y1(n),s=i.token,c;if(s&&!Se(s)&&(i.token=void 0,s=void 0),!s){let a=yield i.cachedTokenPromise;a&&(Se(a)?s=a:yield U8(n,void 0))}if(!e&&s&&Se(s))return{token:s.token};let o=!1;if(C5()){i.exchangeTokenPromise||(i.exchangeTokenPromise=y5(b5(n,yield V5()),t.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),o=!0);let a=yield i.exchangeTokenPromise;return yield U8(n,a),i.token=a,{token:a.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),o=!0),s=yield y1(n).exchangeTokenPromise}catch(a){a.code==="appCheck/throttled"?G8.warn(a.message):G8.error(a),c=a}let r;return s?c?Se(s)?r={token:s.token,internalError:c}:r=_5(c):(r={token:s.token},i.token=s,yield U8(n,s)):r=_5(c),o&&ka(n,r),r})}function Aa(t){return V1(this,null,function*(){let e=t.app;M5(e);let{provider:n}=y1(e);if(C5()){let i=yield V5(),{token:s}=yield y5(b5(e,i),t.heartbeatServiceProvider);return{token:s}}else{let{token:i}=yield n.getToken();return{token:i}}})}function Oa(t,e,n,i){let{app:s}=t,c=y1(s),o={next:n,error:i,type:e};if(c.tokenObservers=[...c.tokenObservers,o],c.token&&Se(c.token)){let r=c.token;Promise.resolve().then(()=>{n({token:r.token}),g5(t)}).catch(()=>{})}c.cachedTokenPromise.then(()=>g5(t))}function E5(t,e){let n=y1(t),i=n.tokenObservers.filter(s=>s.next!==e);i.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=i}function g5(t){let{app:e}=t,n=y1(e),i=n.tokenRefresher;i||(i=Ia(t),n.tokenRefresher=i),!i.isRunning()&&n.isTokenAutoRefreshEnabled&&i.start()}function Ia(t){let{app:e}=t;return new j8(()=>V1(this,null,function*(){let n=y1(e),i;if(n.token?i=yield $8(t,!0):i=yield $8(t),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{let n=y1(e);if(n.token){let i=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,s=n.token.expireTimeMillis-5*60*1e3;return i=Math.min(i,s),Math.max(0,i-Date.now())}else return 0},p5.RETRIAL_MIN_WAIT,p5.RETRIAL_MAX_WAIT)}function ka(t,e){let n=y1(t).tokenObservers;for(let i of n)try{i.type==="EXTERNAL"&&e.error!=null?i.error(e.error):i.next(e)}catch{}}function Se(t){return t.expireTimeMillis-Date.now()>0}function _5(t){return{token:La(Ta),error:t}}var K8=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=y1(this.app);for(let n of e)E5(this.app,n.next);return Promise.resolve()}};function Ba(t,e){return new K8(t,e)}function Da(t){return{getToken:e=>$8(t,e),getLimitedUseToken:()=>Aa(t),addTokenListener:e=>Oa(t,"INTERNAL",e),removeTokenListener:e=>E5(t.app,e)}}var Na="@firebase/app-check",Ra="0.8.3";var Fa="app-check",z5="app-check-internal";function Pa(){Me(new N1(Fa,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return Ba(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(z5).initialize()})),Me(new N1(z5,t=>{let e=t.getProvider("app-check").getImmediate();return Da(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),$1(Na,Ra)}Pa();var qa=["localhost","0.0.0.0","127.0.0.1"],cm=typeof window<"u"&&qa.includes(window.location.hostname);var Y8=new H("angularfire2.auth.use-emulator"),Q8=new H("angularfire2.auth.settings"),Z8=new H("angularfire2.auth.tenant-id"),X8=new H("angularfire2.auth.langugage-code"),J8=new H("angularfire2.auth.use-device-language"),e6=new H("angularfire.auth.persistence"),t6=(t,e,n,i,s,c,o,r)=>t3(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let a=e.runOutsideAngular(()=>t.auth());if(n&&a.useEmulator(...n),i&&(a.tenantId=i),a.languageCode=s,c&&a.useDeviceLanguage(),o)for(let[l,h]of Object.entries(o))a.settings[l]=h;return r&&a.setPersistence(r),a},[n,i,s,c,o,r]),x5=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,i,s,c,o,r,a,l,h,u,d,v){let m=new k1,w=w1(void 0).pipe(h4(o.outsideAngular),B1(()=>c.runOutsideAngular(()=>import("./chunk-B27YYTYV.mjs"))),G(()=>xe(n,c,i)),G(x=>t6(x,c,r,l,h,u,a,d)),u8({bufferSize:1,refCount:!1}));if(Y0(s))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=w1(null);else{w.pipe(N0()).subscribe();let x=w.pipe(B1(O=>O.getRedirectResult().then(z1=>z1,()=>null)),P1,u8({bufferSize:1,refCount:!1})),s1=w.pipe(B1(O=>new j1(z1=>({unsubscribe:c.runOutsideAngular(()=>O.onAuthStateChanged(l4=>z1.next(l4),l4=>z1.error(l4),()=>z1.complete()))})))),c1=w.pipe(B1(O=>new j1(z1=>({unsubscribe:c.runOutsideAngular(()=>O.onIdTokenChanged(l4=>z1.next(l4),l4=>z1.error(l4),()=>z1.complete()))}))));this.authState=x.pipe(d8(s1),D4(o.outsideAngular),h4(o.insideAngular)),this.user=x.pipe(d8(c1),D4(o.outsideAngular),h4(o.insideAngular)),this.idToken=this.user.pipe(B1(O=>O?u4(O.getIdToken()):w1(null))),this.idTokenResult=this.user.pipe(B1(O=>O?u4(O.getIdTokenResult()):w1(null))),this.credential=me(x,m,this.authState.pipe(N4(O=>!O))).pipe(G(O=>O?.user?O:null),D4(o.outsideAngular),h4(o.insideAngular))}return m5(this,w,c,{spy:{apply:(x,s1,c1)=>{(x.startsWith("signIn")||x.startsWith("createUser"))&&c1.then(O=>m.next(O))}}})}static \u0275fac=function(i){return new(i||t)(g(G4),g($4,8),g(W1),g(E1),g(J2),g(Y8,8),g(Q8,8),g(Z8,8),g(X8,8),g(J8,8),g(e6,8),g(z4,8))};static \u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var qc=Io(lc(),1);var w3="5",Uc="v",jc="s",Wc="r",Gc="f",$c=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Kc="ls",Yc="p",U6="ac",Qc="websocket",Zc="long_polling";var j6=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),D(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:L2(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var W6=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return m1(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var Xc=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new j6(e)}}catch{}return new W6},S4=Xc("localStorage"),G6=Xc("sessionStorage");var te=new F4("@firebase/database"),Jc=function(){let t=1;return function(){return t++}}(),e7=function(t){let e=an(t),n=new rn;n.update(e);let i=n.digest();return T2.encodeByteArray(i)},h2=function(...t){let e="";for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=h2.apply(null,i):typeof i=="object"?e+=D(i):e+=i,e+=" "}return e},T4=null,hc=!0,t7=function(t,e){f(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(te.logLevel=ln.VERBOSE,T4=te.log.bind(te),e&&G6.set("logging_enabled",!0)):typeof t=="function"?T4=t:(T4=null,G6.remove("logging_enabled"))},q=function(...t){if(hc===!0&&(hc=!1,T4===null&&G6.get("logging_enabled")===!0&&t7(!0)),T4){let e=h2.apply(null,t);T4(e)}},u2=function(t){return function(...e){q(t,...e)}},$6=function(...t){let e="FIREBASE INTERNAL ERROR: "+h2(...t);te.error(e)},A1=function(...t){let e=`FIREBASE FATAL ERROR: ${h2(...t)}`;throw te.error(e),new Error(e)},$=function(...t){let e="FIREBASE WARNING: "+h2(...t);te.warn(e)},Ql=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&$("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},W3=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},Zl=function(t){if(H1()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},i4="[MIN_NAME]",q1="[MAX_NAME]",A4=function(t,e){if(t===e)return 0;if(t===i4||e===q1)return-1;if(e===i4||t===q1)return 1;{let n=uc(t),i=uc(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},Xl=function(t,e){return t===e?0:t<e?-1:1},Fe=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+D(e))},$t=function(t){if(typeof t!="object"||t===null)return D(t);let e=[];for(let i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=D(e[i]),n+=":",n+=$t(t[e[i]]);return n+="}",n},n7=function(t,e){let n=t.length;if(n<=e)return[t];let i=[];for(let s=0;s<n;s+=e)s+e>n?i.push(t.substring(s,n)):i.push(t.substring(s,s+e));return i};function U(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var i7=function(t){f(!W3(t),"Invalid JSON number");let e=11,n=52,i=(1<<e-1)-1,s,c,o,r,a;t===0?(c=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(r=Math.min(Math.floor(Math.log(t)/Math.LN2),i),c=r+i,o=Math.round(t*Math.pow(2,n-r)-Math.pow(2,n))):(c=0,o=Math.round(t/Math.pow(2,1-i-n))));let l=[];for(a=n;a;a-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(a=e;a;a-=1)l.push(c%2?1:0),c=Math.floor(c/2);l.push(s?1:0),l.reverse();let h=l.join(""),u="";for(a=0;a<64;a+=8){let d=parseInt(h.substr(a,8),2).toString(16);d.length===1&&(d="0"+d),u=u+d}return u.toLowerCase()},Jl=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},e9=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function t9(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}var n9=new RegExp("^-?(0*)\\d{1,10}$"),i9=-2147483648,s9=2147483647,uc=function(t){if(n9.test(t)){let e=Number(t);if(e>=i9&&e<=s9)return e}return null},he=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw $("Exception was thrown by user callback.",n),e},Math.floor(0))}},c9=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},je=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var M3=class{constructor(e,n,i,s,c=!1,o="",r=!1,a=!1){this.secure=n,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=c,this.persistenceKey=o,this.includeNamespaceInQueryParams=r,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=S4.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&S4.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function o9(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function s7(t,e,n){f(typeof e=="string","typeof type must == string"),f(typeof n=="object","typeof params must == object");let i;if(e===Qc)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Zc)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);o9(t)&&(n.ns=t.namespace);let s=[];return U(n,(c,o)=>{s.push(c+"="+o)}),i+s.join("&")}var K6=class{constructor(){this.counters_={}}incrementCounter(e,n=1){m1(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return X0(this.counters_)}};var B6={},D6={};function Kt(t){let e=t.toString();return B6[e]||(B6[e]=new K6),B6[e]}function r9(t,e){let n=t.toString();return D6[n]||(D6[n]=e()),D6[n]}var Yt="";function Qt(t){Yt=t}var a9=16384,l9=45e3,Ye=null;typeof MozWebSocket<"u"?Ye=MozWebSocket:typeof WebSocket<"u"&&(Ye=WebSocket);function h9(t){Ye=t}var J4=(()=>{class t{constructor(n,i,s,c,o,r,a){this.connId=n,this.applicationId=s,this.appCheckToken=c,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=u2(this.connId),this.stats_=Kt(i),this.connURL=t.connectionURL_(i,r,a,c,s),this.nodeAdmin=i.nodeAdmin}static connectionURL_(n,i,s,c,o){let r={};return r[Uc]=w3,!H1()&&typeof location<"u"&&location.hostname&&$c.test(location.hostname)&&(r[Wc]=Gc),i&&(r[jc]=i),s&&(r[Kc]=s),c&&(r[U6]=c),o&&(r[Yc]=o),s7(n,Qc,r)}open(n,i){this.onDisconnect=i,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,S4.set("previous_websocket_failure",!0);try{let s;if(H1()){let c=this.nodeAdmin?"AdminNode":"Node";s={headers:{"User-Agent":`Firebase/${w3}/${Yt}/${process.platform}/${c}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(s.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(s.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,r=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;r&&(s.proxy={origin:r})}this.mySock=new Ye(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");let c=s.message||s.data;c&&this.log_(c),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");let c=s.message||s.data;c&&this.log_(c),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(i);s&&s.length>1&&parseFloat(s[1])<4.4&&(n=!0)}return!n&&Ye!==null&&!t.forceDisallow_}static previouslyFailed(){return S4.isInMemoryStorage||S4.get("previous_websocket_failure")===!0}markConnectionHealthy(){S4.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let s=L2(i);this.onMessage(s)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(f(this.frames===null,"We already have a frame buffer"),n.length<=6){let i=Number(n);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let i=n.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let s=this.extractFrameCount_(i);s!==null&&this.appendFrame_(s)}}send(n){this.resetKeepAlive();let i=D(n);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let s=n7(i,a9);s.length>1&&this.sendString_(String(s.length));for(let c=0;c<s.length;c++)this.sendString_(s[c])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(l9))}sendString_(n){try{this.mySock.send(n)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t})(),dc="@firebase/database",fc="1.0.4";var Y6=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){$(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Q6=class{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(q("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',$(e)}},We=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Z6=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&he(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var vc="start",u9="close",d9="pLPCommand",f9="pRTLPCB",c7="id",o7="pw",r7="ser",v9="cb",m9="seg",p9="ts",g9="d",_9="dframe",a7=1870,l7=30,z9=a7-l7,w9=25e3,M9=3e4,Qe=class t{constructor(e,n,i,s,c,o,r){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=s,this.authToken=c,this.transportSessionId=o,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=u2(e),this.stats_=Kt(n),this.urlFn=a=>(this.appCheckToken&&(a[U6]=this.appCheckToken),s7(n,Zc,a))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Z6(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(M9)),Zl(()=>{if(this.isClosed_)return;this.scriptTagHolder=new X6((...c)=>{let[o,r,a,l,h]=c;if(this.incrementIncomingBytes_(c),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===vc)this.id=r,this.password=a;else if(o===u9)r?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(r,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...c)=>{let[o,r]=c;this.incrementIncomingBytes_(c),this.myPacketOrderer.handleResponse(o,r)},()=>{this.onClosed_()},this.urlFn);let i={};i[vc]="t",i[r7]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[v9]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Uc]=w3,this.transportSessionId&&(i[jc]=this.transportSessionId),this.lastSessionId&&(i[Kc]=this.lastSessionId),this.applicationId&&(i[Yc]=this.applicationId),this.appCheckToken&&(i[U6]=this.appCheckToken),typeof location<"u"&&location.hostname&&$c.test(location.hostname)&&(i[Wc]=Gc);let s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return H1()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Jl()&&!e9()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=D(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let i=Z0(n),s=n7(i,z9);for(let c=0;c<s.length;c++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[c]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(H1())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[_9]="t",i[c7]=e,i[o7]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=D(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},X6=class t{constructor(e,n,i,s){if(this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,H1())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=Jc(),window[d9+this.uniqueCallbackIdentifier]=e,window[f9+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let c="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(c='<script>document.domain="'+document.domain+'";</script>');let o="<html><body>"+c+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(r){q("frame writing exception"),r.stack&&q(r.stack),q(r)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||q("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[c7]=this.myID,e[o7]=this.myPW,e[r7]=this.currentSerial;let n=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+l7+i.length<=a7;){let o=this.pendingSegs.shift();i=i+"&"+m9+s+"="+o.seg+"&"+p9+s+"="+o.ts+"&"+g9+s+"="+o.d,s++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(i,Math.floor(w9)),c=()=>{clearTimeout(s),i()};this.addTag(e,c)}addTag(e,n){H1()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{q("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var h7=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Qe,J4]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let i=J4&&J4.isAvailable(),s=i&&!J4.previouslyFailed();if(n.webSocketOnly&&(i||$("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[J4];else{let c=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&c.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),y9=6e4,b9=5e3,C9=10*1024,V9=100*1024,N6="t",mc="d",E9="s",pc="r",H9="e",gc="o",_c="a",zc="n",wc="p",x9="h",J6=class{constructor(e,n,i,s,c,o,r,a,l,h){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=c,this.onMessage_=o,this.onReady_=r,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=u2("c:"+this.id+":"),this.transportManager_=new h7(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));let s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=je(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>V9?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>C9?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(N6 in e){let n=e[N6];n===_c?this.upgradeIfSecondaryHealthy_():n===pc?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===gc&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Fe("t",e),i=Fe("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:wc,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:_c,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:zc,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Fe("t",e),i=Fe("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Fe(N6,e);if(mc in e){let i=e[mc];if(n===x9){let s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===zc){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===E9?this.onConnectionShutdown_(i):n===pc?this.onReset_(i):n===H9?$6("Server Error: "+i):n===gc?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):$6("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),w3!==i&&$("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),je(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(y9))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):je(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(b9))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:wc,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(S4.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var y3=class{put(e,n,i,s){}merge(e,n,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}};var b3=class{constructor(e){this.allowedEvents_=e,this.listeners_={},f(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});let s=this.getInitialEvent(e);s&&n.apply(i,s)}off(e,n,i){this.validateEventType_(e);let s=this.listeners_[e]||[];for(let c=0;c<s.length;c++)if(s[c].callback===n&&(!i||i===s[c].context)){s.splice(c,1);return}}validateEventType_(e){f(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var C3=class t extends b3{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!g8()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return f(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var Mc=32,yc=768,V=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function C(){return new V("")}function M(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function s4(t){return t.pieces_.length-t.pieceNum_}function L(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new V(t.pieces_,e)}function Zt(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function S9(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Ze(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function u7(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new V(e,0)}function k(t,e){let n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof V)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{let i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&n.push(i[s])}return new V(n,0)}function y(t){return t.pieceNum_>=t.pieces_.length}function Z(t,e){let n=M(t),i=M(e);if(n===null)return e;if(n===i)return Z(L(t),L(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function T9(t,e){let n=Ze(t,0),i=Ze(e,0);for(let s=0;s<n.length&&s<i.length;s++){let c=A4(n[s],i[s]);if(c!==0)return c}return n.length===i.length?0:n.length<i.length?-1:1}function Xt(t,e){if(s4(t)!==s4(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function p1(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(s4(t)>s4(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}var et=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Ze(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=we(this.parts_[i]);d7(this)}};function L9(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=we(e),d7(t)}function A9(t){let e=t.parts_.pop();t.byteLength_-=we(e),t.parts_.length>0&&(t.byteLength_-=1)}function d7(t){if(t.byteLength_>yc)throw new Error(t.errorPrefix_+"has a key path longer than "+yc+" bytes ("+t.byteLength_+").");if(t.parts_.length>Mc)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Mc+") or object contains a cycle "+x4(t))}function x4(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var tt=class t extends b3{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new t}getInitialEvent(e){return f(e==="visible","Unknown event type: "+e),[this.visible_]}};var Pe=1e3,O9=60*5*1e3,bc=30*1e3,I9=1.3,k9=3e4,B9="server_kill",Cc=3,Jt=(()=>{class t extends y3{constructor(n,i,s,c,o,r,a,l){if(super(),this.repoInfo_=n,this.applicationId_=i,this.onDataUpdate_=s,this.onConnectStatus_=c,this.onServerInfoUpdate_=o,this.authTokenProvider_=r,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=u2("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Pe,this.maxReconnectDelay_=O9,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!H1())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");tt.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&C3.getInstance().on("online",this.onOnline_,this)}sendRequest(n,i,s){let c=++this.requestNumber_,o={r:c,a:n,b:i};this.log_(D(o)),f(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),s&&(this.requestCBHash_[c]=s)}get(n){this.initConnection_();let i=new P,c={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:r=>{let a=r.d;r.s==="ok"?i.resolve(a):i.reject(a)}};this.outstandingGets_.push(c),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),i.promise}listen(n,i,s,c){this.initConnection_();let o=n._queryIdentifier,r=n._path.toString();this.log_("Listen called for "+r+" "+o),this.listens.has(r)||this.listens.set(r,new Map),f(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),f(!this.listens.get(r).has(o),"listen() called twice for same path/queryId.");let a={onComplete:c,hashFn:i,query:n,tag:s};this.listens.get(r).set(o,a),this.connected_&&this.sendListen_(a)}sendGet_(n){let i=this.outstandingGets_[n];this.sendRequest("g",i.request,s=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(s)})}sendListen_(n){let i=n.query,s=i._path.toString(),c=i._queryIdentifier;this.log_("Listen on "+s+" for "+c);let o={p:s},r="q";n.tag&&(o.q=i._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(r,o,a=>{let l=a.d,h=a.s;t.warnOnListenWarnings_(l,i),(this.listens.get(s)&&this.listens.get(s).get(c))===n&&(this.log_("listen response",a),h!=="ok"&&this.removeListen_(s,c),n.onComplete&&n.onComplete(h,l))})}static warnOnListenWarnings_(n,i){if(n&&typeof n=="object"&&m1(n,"w")){let s=G1(n,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){let c='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();$(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${c} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||cn(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=bc)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,i=sn(n)?"auth":"gauth",s={cred:n};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(i,s,c=>{let o=c.s,r=c.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let i=n.s,s=n.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,s)})}unlisten(n,i){let s=n._path.toString(),c=n._queryIdentifier;this.log_("Unlisten called for "+s+" "+c),f(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,c)&&this.connected_&&this.sendUnlisten_(s,c,n._queryObject,i)}sendUnlisten_(n,i,s,c){this.log_("Unlisten on "+n+" for "+i);let o={p:n},r="n";c&&(o.q=s,o.t=c),this.sendRequest(r,o)}onDisconnectPut(n,i,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,i,s):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:i,onComplete:s})}onDisconnectMerge(n,i,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,i,s):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:i,onComplete:s})}onDisconnectCancel(n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(n,i,s,c){let o={p:i,d:s};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,r=>{c&&setTimeout(()=>{c(r.s,r.d)},Math.floor(0))})}put(n,i,s,c){this.putInternal("p",n,i,s,c)}merge(n,i,s,c){this.putInternal("m",n,i,s,c)}putInternal(n,i,s,c,o){this.initConnection_();let r={p:i,d:s};o!==void 0&&(r.h=o),this.outstandingPuts_.push({action:n,request:r,onComplete:c}),this.outstandingPutCount_++;let a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+i)}sendPut_(n){let i=this.outstandingPuts_[n].action,s=this.outstandingPuts_[n].request,c=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(i,s,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),c&&c(o.s,o.d)})}reportStats(n){if(this.connected_){let i={c:n};this.log_("reportStats",i),this.sendRequest("s",i,s=>{if(s.s!=="ok"){let o=s.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+D(n));let i=n.r,s=this.requestCBHash_[i];s&&(delete this.requestCBHash_[i],s(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,i){this.log_("handleServerMessage",n,i),n==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):n==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):n==="c"?this.onListenRevoked_(i.p,i.q):n==="ac"?this.onAuthRevoked_(i.s,i.d):n==="apc"?this.onAppCheckRevoked_(i.s,i.d):n==="sd"?this.onSecurityDebugPacket_(i):$6("Unrecognized action received from server: "+D(n)+`
Are you using the latest client?`)}onReady_(n,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){f(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Pe,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Pe,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>k9&&(this.reconnectDelay_=Pe),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,i=Math.max(0,this.reconnectDelay_-n);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*I9)}this.onConnectStatus_(!1)}establishConnection_(){return V1(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),c=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,r=!1,a=null,l=function(){a?a.close():(r=!0,s())},h=function(d){f(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:l,sendRequest:h};let u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[d,v]=yield Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);r?q("getToken() completed but was canceled"):(q("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=v&&v.token,a=new J6(c,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,i,s,m=>{$(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(B9)},o))}catch(d){this.log_("Failed to get token: "+d),r||(this.repoInfo_.nodeAdmin&&$(d),l())}}})}interrupt(n){q("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){q("Resuming connection for reason: "+n),delete this.interruptReasons_[n],A2(this.interruptReasons_)&&(this.reconnectDelay_=Pe,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let i=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let i=this.outstandingPuts_[n];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,i){let s;i?s=i.map(o=>$t(o)).join("$"):s="default";let c=this.removeListen_(n,s);c&&c.onComplete&&c.onComplete("permission_denied")}removeListen_(n,i){let s=new V(n).toString(),c;if(this.listens.has(s)){let o=this.listens.get(s);c=o.get(i),o.delete(i),o.size===0&&this.listens.delete(s)}else c=void 0;return c}onAuthRevoked_(n,i){q("Auth token revoked: "+n+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Cc&&(this.reconnectDelay_=bc,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,i){q("App check token revoked: "+n+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Cc&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let i of n.values())this.sendListen_(i);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},i="js";H1()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),n["sdk."+i+"."+Yt.replace(/\./g,"-")]=1,g8()?n["framework.cordova"]=1:en()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=C3.getInstance().currentlyOnline();return A2(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),b=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var ne=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let i=new b(i4,e),s=new b(i4,n);return this.compare(i,s)!==0}minPost(){return b.MIN}};var z3,V3=class extends ne{static get __EMPTY_NODE(){return z3}static set __EMPTY_NODE(e){z3=e}compare(e,n){return A4(e.name,n.name)}isDefinedOn(e){throw R4("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return b.MIN}maxPost(){return new b(q1,z3)}makePost(e,n){return f(typeof e=="string","KeyIndex indexValue must always be a string."),new b(e,z3)}toString(){return".key"}},L1=new V3;var ee=class{constructor(e,n,i,s,c=null){this.isReverse_=s,this.resultGenerator_=c,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?i(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},b1=(()=>{class t{constructor(n,i,s,c,o){this.key=n,this.value=i,this.color=s??t.RED,this.left=c??g1.EMPTY_NODE,this.right=o??g1.EMPTY_NODE}copy(n,i,s,c,o){return new t(n??this.key,i??this.value,s??this.color,c??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,i,s){let c=this,o=s(n,c.key);return o<0?c=c.copy(null,null,null,c.left.insert(n,i,s),null):o===0?c=c.copy(null,i,null,null,null):c=c.copy(null,null,null,null,c.right.insert(n,i,s)),c.fixUp_()}removeMin_(){if(this.left.isEmpty())return g1.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,i){let s,c;if(s=this,i(n,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(n,i),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),i(n,s.key)===0){if(s.right.isEmpty())return g1.EMPTY_NODE;c=s.right.min_(),s=s.copy(c.key,c.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(n,i))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,i)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),nt=class{copy(e,n,i,s,c){return this}insert(e,n,i){return new b1(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},g1=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,b1.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,b1.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,s=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ee(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ee(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ee(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ee(this.root_,null,this.comparator_,!0,e)}};g1.EMPTY_NODE=new nt;function D9(t,e){return A4(t.name,e.name)}function e0(t,e){return A4(t,e)}var it;function N9(t){it=t}var f7=function(t){return typeof t=="number"?"number:"+i7(t):"string:"+t},v7=function(t){if(t.isLeafNode()){let e=t.val();f(typeof e=="string"||typeof e=="number"||typeof e=="object"&&m1(e,".sv"),"Priority must be a string or number.")}else f(t===it||t.isEmpty(),"priority of unexpected type.");f(t===it||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var Vc,ie=(()=>{class t{constructor(n,i=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=i,this.lazyHash_=null,f(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),v7(this.priorityNode_)}static set __childrenNodeConstructor(n){Vc=n}static get __childrenNodeConstructor(){return Vc}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return y(n)?this:M(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,i){return null}updateImmediateChild(n,i){return n===".priority"?this.updatePriority(i):i.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,i).updatePriority(this.priorityNode_)}updateChild(n,i){let s=M(n);return s===null?i:i.isEmpty()&&s!==".priority"?this:(f(s!==".priority"||s4(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(L(n),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,i){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+f7(this.priorityNode_.val())+":");let i=typeof this.value_;n+=i+":",i==="number"?n+=i7(this.value_):n+=this.value_,this.lazyHash_=e7(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(f(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let i=typeof n.value_,s=typeof this.value_,c=t.VALUE_TYPE_ORDER.indexOf(i),o=t.VALUE_TYPE_ORDER.indexOf(s);return f(c>=0,"Unknown leaf type: "+i),f(o>=0,"Unknown leaf type: "+s),c===o?s==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-c}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let i=n;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),m7,p7;function R9(t){m7=t}function F9(t){p7=t}var st=class extends ne{compare(e,n){let i=e.node.getPriority(),s=n.node.getPriority(),c=i.compareTo(s);return c===0?A4(e.name,n.name):c}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return b.MIN}maxPost(){return new b(q1,new ie("[PRIORITY-POST]",p7))}makePost(e,n){let i=m7(e);return new b(n,new ie("[PRIORITY-POST]",i))}toString(){return".priority"}},A=new st;var P9=Math.log(2),ct=class{constructor(e){let n=c=>parseInt(Math.log(c)/P9,10),i=c=>parseInt(Array(c+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},E3=function(t,e,n,i){t.sort(e);let s=function(a,l){let h=l-a,u,d;if(h===0)return null;if(h===1)return u=t[a],d=n?n(u):u,new b1(d,u.node,b1.BLACK,null,null);{let v=parseInt(h/2,10)+a,m=s(a,v),w=s(v+1,l);return u=t[v],d=n?n(u):u,new b1(d,u.node,b1.BLACK,m,w)}},c=function(a){let l=null,h=null,u=t.length,d=function(m,w){let x=u-m,s1=u;u-=m;let c1=s(x+1,s1),O=t[x],z1=n?n(O):O;v(new b1(z1,O.node,w,null,c1))},v=function(m){l?(l.left=m,l=m):(h=m,l=m)};for(let m=0;m<a.count;++m){let w=a.nextBitIsOne(),x=Math.pow(2,a.count-(m+1));w?d(x,b1.BLACK):(d(x,b1.BLACK),d(x,b1.RED))}return h},o=new ct(t.length),r=c(o);return new g1(i||e,r)};var R6,X4={},se=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return f(X4&&A,"ChildrenNode.ts has not been loaded"),R6=R6||new t({".priority":X4},{".priority":A}),R6}get(e){let n=G1(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof g1?n:null}hasIndex(e){return m1(this.indexSet_,e.toString())}addIndex(e,n){f(e!==L1,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],s=!1,c=n.getIterator(b.Wrap),o=c.getNext();for(;o;)s=s||e.isDefinedOn(o.node),i.push(o),o=c.getNext();let r;s?r=E3(i,e.getCompare()):r=X4;let a=e.toString(),l=Object.assign({},this.indexSet_);l[a]=e;let h=Object.assign({},this.indexes_);return h[a]=r,new t(h,l)}addToIndexes(e,n){let i=ze(this.indexes_,(s,c)=>{let o=G1(this.indexSet_,c);if(f(o,"Missing index implementation for "+c),s===X4)if(o.isDefinedOn(e.node)){let r=[],a=n.getIterator(b.Wrap),l=a.getNext();for(;l;)l.name!==e.name&&r.push(l),l=a.getNext();return r.push(e),E3(r,o.getCompare())}else return X4;else{let r=n.get(e.name),a=s;return r&&(a=a.remove(new b(e.name,r))),a.insert(e,e.node)}});return new t(i,this.indexSet_)}removeFromIndexes(e,n){let i=ze(this.indexes_,s=>{if(s===X4)return s;{let c=n.get(e.name);return c?s.remove(new b(e.name,c)):s}});return new t(i,this.indexSet_)}};var qe,z=(()=>{class t{constructor(n,i,s){this.children_=n,this.priorityNode_=i,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&v7(this.priorityNode_),this.children_.isEmpty()&&f(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return qe||(qe=new t(new g1(e0),null,se.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||qe}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let i=this.children_.get(n);return i===null?qe:i}}getChild(n){let i=M(n);return i===null?this:this.getImmediateChild(i).getChild(L(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,i){if(f(i,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(i);{let s=new b(n,i),c,o;i.isEmpty()?(c=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(s,this.children_)):(c=this.children_.insert(n,i),o=this.indexMap_.addToIndexes(s,this.children_));let r=c.isEmpty()?qe:this.priorityNode_;return new t(c,r,o)}}updateChild(n,i){let s=M(n);if(s===null)return i;{f(M(n)!==".priority"||s4(n)===1,".priority must be the last token in a path");let c=this.getImmediateChild(s).updateChild(L(n),i);return this.updateImmediateChild(s,c)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let i={},s=0,c=0,o=!0;if(this.forEachChild(A,(r,a)=>{i[r]=a.val(n),s++,o&&t.INTEGER_REGEXP_.test(r)?c=Math.max(c,Number(r)):o=!1}),!n&&o&&c<2*s){let r=[];for(let a in i)r[a]=i[a];return r}else return n&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+f7(this.getPriority().val())+":"),this.forEachChild(A,(i,s)=>{let c=s.hash();c!==""&&(n+=":"+i+":"+c)}),this.lazyHash_=n===""?"":e7(n)}return this.lazyHash_}getPredecessorChildName(n,i,s){let c=this.resolveIndex_(s);if(c){let o=c.getPredecessorKey(new b(n,i));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let i=this.resolveIndex_(n);if(i){let s=i.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(n){let i=this.getFirstChildName(n);return i?new b(i,this.children_.get(i)):null}getLastChildName(n){let i=this.resolveIndex_(n);if(i){let s=i.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(n){let i=this.getLastChildName(n);return i?new b(i,this.children_.get(i)):null}forEachChild(n,i){let s=this.resolveIndex_(n);return s?s.inorderTraversal(c=>i(c.name,c.node)):this.children_.inorderTraversal(i)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,i){let s=this.resolveIndex_(i);if(s)return s.getIteratorFrom(n,c=>c);{let c=this.children_.getIteratorFrom(n.name,b.Wrap),o=c.peek();for(;o!=null&&i.compare(o,n)<0;)c.getNext(),o=c.peek();return c}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,i){let s=this.resolveIndex_(i);if(s)return s.getReverseIteratorFrom(n,c=>c);{let c=this.children_.getReverseIteratorFrom(n.name,b.Wrap),o=c.peek();for(;o!=null&&i.compare(o,n)>0;)c.getNext(),o=c.peek();return c}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===d2?-1:0}withIndex(n){if(n===L1||this.indexMap_.hasIndex(n))return this;{let i=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,i)}}isIndexed(n){return n===L1||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let i=n;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let s=this.getIterator(A),c=i.getIterator(A),o=s.getNext(),r=c.getNext();for(;o&&r;){if(o.name!==r.name||!o.node.equals(r.node))return!1;o=s.getNext(),r=c.getNext()}return o===null&&r===null}else return!1;else return!1}}resolveIndex_(n){return n===L1?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),ot=class extends z{constructor(){super(new g1(e0),z.EMPTY_NODE,se.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return z.EMPTY_NODE}isEmpty(){return!1}},d2=new ot;Object.defineProperties(b,{MIN:{value:new b(i4,z.EMPTY_NODE)},MAX:{value:new b(q1,d2)}});V3.__EMPTY_NODE=z.EMPTY_NODE;ie.__childrenNodeConstructor=z;N9(d2);F9(d2);var q9=!0;function B(t,e=null){if(t===null)return z.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),f(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new ie(n,B(e))}if(!(t instanceof Array)&&q9){let n=[],i=!1;if(U(t,(o,r)=>{if(o.substring(0,1)!=="."){let a=B(r);a.isEmpty()||(i=i||!a.getPriority().isEmpty(),n.push(new b(o,a)))}}),n.length===0)return z.EMPTY_NODE;let c=E3(n,D9,o=>o.name,e0);if(i){let o=E3(n,A.getCompare());return new z(c,B(e),new se({".priority":o},{".priority":A}))}else return new z(c,B(e),se.Default)}else{let n=z.EMPTY_NODE;return U(t,(i,s)=>{if(m1(t,i)&&i.substring(0,1)!=="."){let c=B(s);(c.isLeafNode()||!c.isEmpty())&&(n=n.updateImmediateChild(i,c))}}),n.updatePriority(B(e))}}R9(B);var Xe=class extends ne{constructor(e){super(),this.indexPath_=e,f(!y(e)&&M(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let i=this.extractChild(e.node),s=this.extractChild(n.node),c=i.compareTo(s);return c===0?A4(e.name,n.name):c}makePost(e,n){let i=B(e),s=z.EMPTY_NODE.updateChild(this.indexPath_,i);return new b(n,s)}maxPost(){let e=z.EMPTY_NODE.updateChild(this.indexPath_,d2);return new b(q1,e)}toString(){return Ze(this.indexPath_,0).join("/")}};var rt=class extends ne{compare(e,n){let i=e.node.compareTo(n.node);return i===0?A4(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return b.MIN}maxPost(){return b.MAX}makePost(e,n){let i=B(e);return new b(n,i)}toString(){return".value"}},t0=new rt;function g7(t){return{type:"value",snapshotNode:t}}function ce(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Je(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function e2(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function U9(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var t2=class{constructor(e){this.index_=e}updateChild(e,n,i,s,c,o){f(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let r=e.getImmediateChild(n);return r.getChild(s).equals(i.getChild(s))&&r.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(n)?o.trackChildChange(Je(n,r)):f(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):r.isEmpty()?o.trackChildChange(ce(n,i)):o.trackChildChange(e2(n,i,r))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(e,n,i){return i!=null&&(e.isLeafNode()||e.forEachChild(A,(s,c)=>{n.hasChild(s)||i.trackChildChange(Je(s,c))}),n.isLeafNode()||n.forEachChild(A,(s,c)=>{if(e.hasChild(s)){let o=e.getImmediateChild(s);o.equals(c)||i.trackChildChange(e2(s,c,o))}else i.trackChildChange(ce(s,c))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?z.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var H3=class t{constructor(e){this.indexedFilter_=new t2(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&i}updateChild(e,n,i,s,c,o){return this.matches(new b(n,i))||(i=z.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,i,s,c,o)}updateFullNode(e,n,i){n.isLeafNode()&&(n=z.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(z.EMPTY_NODE);let c=this;return n.forEachChild(A,(o,r)=>{c.matches(new b(o,r))||(s=s.updateImmediateChild(o,z.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var at=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let i=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=n=>{let i=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new H3(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,i,s,c,o){return this.rangedFilter_.matches(new b(n,i))||(i=z.EMPTY_NODE),e.getImmediateChild(n).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,i,s,c,o):this.fullLimitUpdateChild_(e,n,i,c,o)}updateFullNode(e,n,i){let s;if(n.isLeafNode()||n.isEmpty())s=z.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=z.EMPTY_NODE.withIndex(this.index_);let c;this.reverse_?c=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):c=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;c.hasNext()&&o<this.limit_;){let r=c.getNext();if(this.withinDirectionalStart(r))if(this.withinDirectionalEnd(r))s=s.updateImmediateChild(r.name,r.node),o++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(z.EMPTY_NODE);let c;this.reverse_?c=s.getReverseIterator(this.index_):c=s.getIterator(this.index_);let o=0;for(;c.hasNext();){let r=c.getNext();o<this.limit_&&this.withinDirectionalStart(r)&&this.withinDirectionalEnd(r)?o++:s=s.updateImmediateChild(r.name,z.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,i,s,c){let o;if(this.reverse_){let u=this.index_.getCompare();o=(d,v)=>u(v,d)}else o=this.index_.getCompare();let r=e;f(r.numChildren()===this.limit_,"");let a=new b(n,i),l=this.reverse_?r.getFirstChild(this.index_):r.getLastChild(this.index_),h=this.rangedFilter_.matches(a);if(r.hasChild(n)){let u=r.getImmediateChild(n),d=s.getChildAfterChild(this.index_,l,this.reverse_);for(;d!=null&&(d.name===n||r.hasChild(d.name));)d=s.getChildAfterChild(this.index_,d,this.reverse_);let v=d==null?1:o(d,a);if(h&&!i.isEmpty()&&v>=0)return c?.trackChildChange(e2(n,i,u)),r.updateImmediateChild(n,i);{c?.trackChildChange(Je(n,u));let w=r.updateImmediateChild(n,z.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(c?.trackChildChange(ce(d.name,d.node)),w.updateImmediateChild(d.name,d.node)):w}}else return i.isEmpty()?e:h&&o(l,a)>=0?(c!=null&&(c.trackChildChange(Je(l.name,l.node)),c.trackChildChange(ce(n,i))),r.updateImmediateChild(n,i).updateImmediateChild(l.name,z.EMPTY_NODE)):e}};var n2=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=A}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return f(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return f(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:i4}hasEnd(){return this.endSet_}getIndexEndValue(){return f(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return f(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:q1}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return f(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===A}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function j9(t){return t.loadsAllData()?new t2(t.getIndex()):t.hasLimit()?new at(t):new H3(t)}function W9(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function G9(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function lt(t,e,n){let i=t.copy();return i.startSet_=!0,e===void 0&&(e=null),i.indexStartValue_=e,n!=null?(i.startNameSet_=!0,i.indexStartName_=n):(i.startNameSet_=!1,i.indexStartName_=""),i}function $9(t,e,n){let i;return t.index_===L1||n?i=lt(t,e,n):i=lt(t,e,q1),i.startAfterSet_=!0,i}function ht(t,e,n){let i=t.copy();return i.endSet_=!0,e===void 0&&(e=null),i.indexEndValue_=e,n!==void 0?(i.endNameSet_=!0,i.indexEndName_=n):(i.endNameSet_=!1,i.indexEndName_=""),i}function K9(t,e,n){let i;return t.index_===L1||n?i=ht(t,e,n):i=ht(t,e,i4),i.endBeforeSet_=!0,i}function G3(t,e){let n=t.copy();return n.index_=e,n}function Ec(t){let e={};if(t.isDefault())return e;let n;if(t.index_===A?n="$priority":t.index_===t0?n="$value":t.index_===L1?n="$key":(f(t.index_ instanceof Xe,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=D(n),t.startSet_){let i=t.startAfterSet_?"startAfter":"startAt";e[i]=D(t.indexStartValue_),t.startNameSet_&&(e[i]+=","+D(t.indexStartName_))}if(t.endSet_){let i=t.endBeforeSet_?"endBefore":"endAt";e[i]=D(t.indexEndValue_),t.endNameSet_&&(e[i]+=","+D(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Hc(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==A&&(e.i=t.index_.toString()),e}var ut=class t extends y3{constructor(e,n,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=u2("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(f(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,i,s){let c=e._path.toString();this.log_("Listen called for "+c+" "+e._queryIdentifier);let o=t.getListenId_(e,i),r={};this.listens_[o]=r;let a=Ec(e._queryParams);this.restRequest_(c+".json",a,(l,h)=>{let u=h;if(l===404&&(u=null,l=null),l===null&&this.onDataUpdate_(c,u,!1,i),G1(this.listens_,o)===r){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",s(d,null)}})}unlisten(e,n){let i=t.getListenId_(e,n);delete this.listens_[i]}get(e){let n=Ec(e._queryParams),i=e._path.toString(),s=new P;return this.restRequest_(i+".json",n,(c,o)=>{let r=o;c===404&&(r=null,c=null),c===null?(this.onDataUpdate_(i,r,!1,null),s.resolve(r)):s.reject(new Error(r))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,c])=>{s&&s.accessToken&&(n.auth=s.accessToken),c&&c.token&&(n.ac=c.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+on(n);this.log_("Sending REST request for "+o);let r=new XMLHttpRequest;r.onreadystatechange=()=>{if(i&&r.readyState===4){this.log_("REST Response for "+o+" received. status:",r.status,"response:",r.responseText);let a=null;if(r.status>=200&&r.status<300){try{a=L2(r.responseText)}catch{$("Failed to parse JSON response for "+o+": "+r.responseText)}i(null,a)}else r.status!==401&&r.status!==404&&$("Got unsuccessful REST response for "+o+" Status: "+r.status),i(r.status);i=null}},r.open("GET",o,!0),r.send()})}};var dt=class{constructor(){this.rootNode_=z.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function x3(){return{value:null,children:new Map}}function ue(t,e,n){if(y(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let i=M(e);t.children.has(i)||t.children.set(i,x3());let s=t.children.get(i);e=L(e),ue(s,e,n)}}function ft(t,e){if(y(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(A,(i,s)=>{ue(t,new V(i),s)}),ft(t,e)}}else if(t.children.size>0){let n=M(e);return e=L(e),t.children.has(n)&&ft(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function vt(t,e,n){t.value!==null?n(e,t.value):Y9(t,(i,s)=>{let c=new V(e.toString()+"/"+i);vt(s,c,n)})}function Y9(t,e){t.children.forEach((n,i)=>{e(i,n)})}var mt=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&U(this.last_,(i,s)=>{n[i]=n[i]-s}),this.last_=e,n}};var xc=10*1e3,Q9=30*1e3,Z9=5*60*1e3,pt=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new mt(e);let i=xc+(Q9-xc)*Math.random();je(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),n={},i=!1;U(e,(s,c)=>{c>0&&m1(this.statsToReport_,s)&&(n[s]=c,i=!0)}),i&&this.server_.reportStats(n),je(this.reportStats_.bind(this),Math.floor(Math.random()*2*Z9))}};var T1=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(T1||{});function n0(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function i0(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function s0(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var gt=class t{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=T1.ACK_USER_WRITE,this.source=n0()}operationForChild(e){if(y(this.path)){if(this.affectedTree.value!=null)return f(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new V(e));return new t(C(),n,this.revert)}}else return f(M(this.path)===e,"operationForChild called for unrelated child."),new t(L(this.path),this.affectedTree,this.revert)}};var S3=class t{constructor(e,n){this.source=e,this.path=n,this.type=T1.LISTEN_COMPLETE}operationForChild(e){return y(this.path)?new t(this.source,C()):new t(this.source,L(this.path))}};var oe=class t{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=T1.OVERWRITE}operationForChild(e){return y(this.path)?new t(this.source,C(),this.snap.getImmediateChild(e)):new t(this.source,L(this.path),this.snap)}};var i2=class t{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=T1.MERGE}operationForChild(e){if(y(this.path)){let n=this.children.subtree(new V(e));return n.isEmpty()?null:n.value?new oe(this.source,C(),n.value):new t(this.source,C(),n)}else return f(M(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,L(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var O1=class{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(y(e))return this.isFullyInitialized()&&!this.filtered_;let n=M(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var _t=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function X9(t,e,n,i){let s=[],c=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&c.push(U9(o.childName,o.snapshotNode))}),Ue(t,s,"child_removed",e,i,n),Ue(t,s,"child_added",e,i,n),Ue(t,s,"child_moved",c,i,n),Ue(t,s,"child_changed",e,i,n),Ue(t,s,"value",e,i,n),s}function Ue(t,e,n,i,s,c){let o=i.filter(r=>r.type===n);o.sort((r,a)=>eh(t,r,a)),o.forEach(r=>{let a=J9(t,r,c);s.forEach(l=>{l.respondsTo(r.type)&&e.push(l.createEvent(a,t.query_))})})}function J9(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function eh(t,e,n){if(e.childName==null||n.childName==null)throw R4("Should only compare child_ events.");let i=new b(e.childName,e.snapshotNode),s=new b(n.childName,n.snapshotNode);return t.index_.compare(i,s)}function $3(t,e){return{eventCache:t,serverCache:e}}function Ge(t,e,n,i){return $3(new O1(e,n,i),t.serverCache)}function _7(t,e,n,i){return $3(t.eventCache,new O1(e,n,i))}function T3(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function L4(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var F6,th=()=>(F6||(F6=new g1(Xl)),F6),X=class t{constructor(e,n=th()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return U(e,(i,s)=>{n=n.set(new V(i),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:C(),value:this.value};if(y(e))return null;{let i=M(e),s=this.children.get(i);if(s!==null){let c=s.findRootMostMatchingPathAndValue(L(e),n);return c!=null?{path:k(new V(i),c.path),value:c.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(y(e))return this;{let n=M(e),i=this.children.get(n);return i!==null?i.subtree(L(e)):new t(null)}}set(e,n){if(y(e))return new t(n,this.children);{let i=M(e),c=(this.children.get(i)||new t(null)).set(L(e),n),o=this.children.insert(i,c);return new t(this.value,o)}}remove(e){if(y(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=M(e),i=this.children.get(n);if(i){let s=i.remove(L(e)),c;return s.isEmpty()?c=this.children.remove(n):c=this.children.insert(n,s),this.value===null&&c.isEmpty()?new t(null):new t(this.value,c)}else return this}}get(e){if(y(e))return this.value;{let n=M(e),i=this.children.get(n);return i?i.get(L(e)):null}}setTree(e,n){if(y(e))return n;{let i=M(e),c=(this.children.get(i)||new t(null)).setTree(L(e),n),o;return c.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,c),new t(this.value,o)}}fold(e){return this.fold_(C(),e)}fold_(e,n){let i={};return this.children.inorderTraversal((s,c)=>{i[s]=c.fold_(k(e,s),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,C(),n)}findOnPath_(e,n,i){let s=this.value?i(n,this.value):!1;if(s)return s;if(y(e))return null;{let c=M(e),o=this.children.get(c);return o?o.findOnPath_(L(e),k(n,c),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,C(),n)}foreachOnPath_(e,n,i){if(y(e))return this;{this.value&&i(n,this.value);let s=M(e),c=this.children.get(s);return c?c.foreachOnPath_(L(e),k(n,s),i):new t(null)}}foreach(e){this.foreach_(C(),e)}foreach_(e,n){this.children.inorderTraversal((i,s)=>{s.foreach_(k(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}};var C1=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new X(null))}};function $e(t,e,n){if(y(e))return new C1(new X(n));{let i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){let s=i.path,c=i.value,o=Z(s,e);return c=c.updateChild(o,n),new C1(t.writeTree_.set(s,c))}else{let s=new X(n),c=t.writeTree_.setTree(e,s);return new C1(c)}}}function zt(t,e,n){let i=t;return U(n,(s,c)=>{i=$e(i,k(e,s),c)}),i}function Sc(t,e){if(y(e))return C1.empty();{let n=t.writeTree_.setTree(e,new X(null));return new C1(n)}}function wt(t,e){return O4(t,e)!=null}function O4(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Z(n.path,e)):null}function Tc(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(A,(i,s)=>{e.push(new b(i,s))}):t.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new b(i,s.value))}),e}function t4(t,e){if(y(e))return t;{let n=O4(t,e);return n!=null?new C1(new X(n)):new C1(t.writeTree_.subtree(e))}}function Mt(t){return t.writeTree_.isEmpty()}function re(t,e){return z7(C(),t.writeTree_,e)}function z7(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((s,c)=>{s===".priority"?(f(c.value!==null,"Priority writes must always be leaf nodes"),i=c.value):n=z7(k(t,s),c,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(k(t,".priority"),i)),n}}function K3(t,e){return b7(e,t)}function nh(t,e,n,i,s){f(i>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:s}),s&&(t.visibleWrites=$e(t.visibleWrites,e,n)),t.lastWriteId=i}function ih(t,e,n,i){f(i>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:i,visible:!0}),t.visibleWrites=zt(t.visibleWrites,e,n),t.lastWriteId=i}function sh(t,e){for(let n=0;n<t.allWrites.length;n++){let i=t.allWrites[n];if(i.writeId===e)return i}return null}function ch(t,e){let n=t.allWrites.findIndex(r=>r.writeId===e);f(n>=0,"removeWrite called with nonexistent writeId.");let i=t.allWrites[n];t.allWrites.splice(n,1);let s=i.visible,c=!1,o=t.allWrites.length-1;for(;s&&o>=0;){let r=t.allWrites[o];r.visible&&(o>=n&&oh(r,i.path)?s=!1:p1(i.path,r.path)&&(c=!0)),o--}if(s){if(c)return rh(t),!0;if(i.snap)t.visibleWrites=Sc(t.visibleWrites,i.path);else{let r=i.children;U(r,a=>{t.visibleWrites=Sc(t.visibleWrites,k(i.path,a))})}return!0}else return!1}function oh(t,e){if(t.snap)return p1(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&p1(k(t.path,n),e))return!0;return!1}function rh(t){t.visibleWrites=w7(t.allWrites,ah,C()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function ah(t){return t.visible}function w7(t,e,n){let i=C1.empty();for(let s=0;s<t.length;++s){let c=t[s];if(e(c)){let o=c.path,r;if(c.snap)p1(n,o)?(r=Z(n,o),i=$e(i,r,c.snap)):p1(o,n)&&(r=Z(o,n),i=$e(i,C(),c.snap.getChild(r)));else if(c.children){if(p1(n,o))r=Z(n,o),i=zt(i,r,c.children);else if(p1(o,n))if(r=Z(o,n),y(r))i=zt(i,C(),c.children);else{let a=G1(c.children,M(r));if(a){let l=a.getChild(L(r));i=$e(i,C(),l)}}}else throw R4("WriteRecord should have .snap or .children")}}return i}function M7(t,e,n,i,s){if(!i&&!s){let c=O4(t.visibleWrites,e);if(c!=null)return c;{let o=t4(t.visibleWrites,e);if(Mt(o))return n;if(n==null&&!wt(o,C()))return null;{let r=n||z.EMPTY_NODE;return re(o,r)}}}else{let c=t4(t.visibleWrites,e);if(!s&&Mt(c))return n;if(!s&&n==null&&!wt(c,C()))return null;{let o=function(l){return(l.visible||s)&&(!i||!~i.indexOf(l.writeId))&&(p1(l.path,e)||p1(e,l.path))},r=w7(t.allWrites,o,e),a=n||z.EMPTY_NODE;return re(r,a)}}}function lh(t,e,n){let i=z.EMPTY_NODE,s=O4(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(A,(c,o)=>{i=i.updateImmediateChild(c,o)}),i;if(n){let c=t4(t.visibleWrites,e);return n.forEachChild(A,(o,r)=>{let a=re(t4(c,new V(o)),r);i=i.updateImmediateChild(o,a)}),Tc(c).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let c=t4(t.visibleWrites,e);return Tc(c).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function hh(t,e,n,i,s){f(i||s,"Either existingEventSnap or existingServerSnap must exist");let c=k(e,n);if(wt(t.visibleWrites,c))return null;{let o=t4(t.visibleWrites,c);return Mt(o)?s.getChild(n):re(o,s.getChild(n))}}function uh(t,e,n,i){let s=k(e,n),c=O4(t.visibleWrites,s);if(c!=null)return c;if(i.isCompleteForChild(n)){let o=t4(t.visibleWrites,s);return re(o,i.getNode().getImmediateChild(n))}else return null}function dh(t,e){return O4(t.visibleWrites,e)}function fh(t,e,n,i,s,c,o){let r,a=t4(t.visibleWrites,e),l=O4(a,C());if(l!=null)r=l;else if(n!=null)r=re(a,n);else return[];if(r=r.withIndex(o),!r.isEmpty()&&!r.isLeafNode()){let h=[],u=o.getCompare(),d=c?r.getReverseIteratorFrom(i,o):r.getIteratorFrom(i,o),v=d.getNext();for(;v&&h.length<s;)u(v,i)!==0&&h.push(v),v=d.getNext();return h}else return[]}function vh(){return{visibleWrites:C1.empty(),allWrites:[],lastWriteId:-1}}function L3(t,e,n,i){return M7(t.writeTree,t.treePath,e,n,i)}function c0(t,e){return lh(t.writeTree,t.treePath,e)}function Lc(t,e,n,i){return hh(t.writeTree,t.treePath,e,n,i)}function A3(t,e){return dh(t.writeTree,k(t.treePath,e))}function mh(t,e,n,i,s,c){return fh(t.writeTree,t.treePath,e,n,i,s,c)}function o0(t,e,n){return uh(t.writeTree,t.treePath,e,n)}function y7(t,e){return b7(k(t.treePath,e),t.writeTree)}function b7(t,e){return{treePath:t,writeTree:e}}var yt=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,i=e.childName;f(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),f(i!==".priority","Only non-priority child changes can be tracked.");let s=this.changeMap.get(i);if(s){let c=s.type;if(n==="child_added"&&c==="child_removed")this.changeMap.set(i,e2(i,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&c==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&c==="child_changed")this.changeMap.set(i,Je(i,s.oldSnap));else if(n==="child_changed"&&c==="child_added")this.changeMap.set(i,ce(i,e.snapshotNode));else if(n==="child_changed"&&c==="child_changed")this.changeMap.set(i,e2(i,e.snapshotNode,s.oldSnap));else throw R4("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var bt=class{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}},C7=new bt,s2=class{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new O1(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return o0(this.writes_,e,i)}}getChildAfterChild(e,n,i){let s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:L4(this.viewCache_),c=mh(this.writes_,s,n,1,i,e);return c.length===0?null:c[0]}};function ph(t){return{filter:t}}function gh(t,e){f(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),f(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function _h(t,e,n,i,s){let c=new yt,o,r;if(n.type===T1.OVERWRITE){let l=n;l.source.fromUser?o=Ct(t,e,l.path,l.snap,i,s,c):(f(l.source.fromServer,"Unknown source."),r=l.source.tagged||e.serverCache.isFiltered()&&!y(l.path),o=O3(t,e,l.path,l.snap,i,s,r,c))}else if(n.type===T1.MERGE){let l=n;l.source.fromUser?o=wh(t,e,l.path,l.children,i,s,c):(f(l.source.fromServer,"Unknown source."),r=l.source.tagged||e.serverCache.isFiltered(),o=Vt(t,e,l.path,l.children,i,s,r,c))}else if(n.type===T1.ACK_USER_WRITE){let l=n;l.revert?o=bh(t,e,l.path,i,s,c):o=Mh(t,e,l.path,l.affectedTree,i,s,c)}else if(n.type===T1.LISTEN_COMPLETE)o=yh(t,e,n.path,i,c);else throw R4("Unknown operation type: "+n.type);let a=c.getChanges();return zh(e,o,a),{viewCache:o,changes:a}}function zh(t,e,n){let i=e.eventCache;if(i.isFullyInitialized()){let s=i.getNode().isLeafNode()||i.getNode().isEmpty(),c=T3(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!i.getNode().equals(c)||!i.getNode().getPriority().equals(c.getPriority()))&&n.push(g7(T3(e)))}}function V7(t,e,n,i,s,c){let o=e.eventCache;if(A3(i,n)!=null)return e;{let r,a;if(y(n))if(f(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=L4(e),h=l instanceof z?l:z.EMPTY_NODE,u=c0(i,h);r=t.filter.updateFullNode(e.eventCache.getNode(),u,c)}else{let l=L3(i,L4(e));r=t.filter.updateFullNode(e.eventCache.getNode(),l,c)}else{let l=M(n);if(l===".priority"){f(s4(n)===1,"Can't have a priority with additional path components");let h=o.getNode();a=e.serverCache.getNode();let u=Lc(i,n,h,a);u!=null?r=t.filter.updatePriority(h,u):r=o.getNode()}else{let h=L(n),u;if(o.isCompleteForChild(l)){a=e.serverCache.getNode();let d=Lc(i,n,o.getNode(),a);d!=null?u=o.getNode().getImmediateChild(l).updateChild(h,d):u=o.getNode().getImmediateChild(l)}else u=o0(i,l,e.serverCache);u!=null?r=t.filter.updateChild(o.getNode(),l,u,h,s,c):r=o.getNode()}}return Ge(e,r,o.isFullyInitialized()||y(n),t.filter.filtersNodes())}}function O3(t,e,n,i,s,c,o,r){let a=e.serverCache,l,h=o?t.filter:t.filter.getIndexedFilter();if(y(n))l=h.updateFullNode(a.getNode(),i,null);else if(h.filtersNodes()&&!a.isFiltered()){let v=a.getNode().updateChild(n,i);l=h.updateFullNode(a.getNode(),v,null)}else{let v=M(n);if(!a.isCompleteForPath(n)&&s4(n)>1)return e;let m=L(n),x=a.getNode().getImmediateChild(v).updateChild(m,i);v===".priority"?l=h.updatePriority(a.getNode(),x):l=h.updateChild(a.getNode(),v,x,m,C7,null)}let u=_7(e,l,a.isFullyInitialized()||y(n),h.filtersNodes()),d=new s2(s,u,c);return V7(t,u,n,s,d,r)}function Ct(t,e,n,i,s,c,o){let r=e.eventCache,a,l,h=new s2(s,e,c);if(y(n))l=t.filter.updateFullNode(e.eventCache.getNode(),i,o),a=Ge(e,l,!0,t.filter.filtersNodes());else{let u=M(n);if(u===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),i),a=Ge(e,l,r.isFullyInitialized(),r.isFiltered());else{let d=L(n),v=r.getNode().getImmediateChild(u),m;if(y(d))m=i;else{let w=h.getCompleteChild(u);w!=null?Zt(d)===".priority"&&w.getChild(u7(d)).isEmpty()?m=w:m=w.updateChild(d,i):m=z.EMPTY_NODE}if(v.equals(m))a=e;else{let w=t.filter.updateChild(r.getNode(),u,m,d,h,o);a=Ge(e,w,r.isFullyInitialized(),t.filter.filtersNodes())}}}return a}function Ac(t,e){return t.eventCache.isCompleteForChild(e)}function wh(t,e,n,i,s,c,o){let r=e;return i.foreach((a,l)=>{let h=k(n,a);Ac(e,M(h))&&(r=Ct(t,r,h,l,s,c,o))}),i.foreach((a,l)=>{let h=k(n,a);Ac(e,M(h))||(r=Ct(t,r,h,l,s,c,o))}),r}function Oc(t,e,n){return n.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function Vt(t,e,n,i,s,c,o,r){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let a=e,l;y(n)?l=i:l=new X(null).setTree(n,i);let h=e.serverCache.getNode();return l.children.inorderTraversal((u,d)=>{if(h.hasChild(u)){let v=e.serverCache.getNode().getImmediateChild(u),m=Oc(t,v,d);a=O3(t,a,new V(u),m,s,c,o,r)}}),l.children.inorderTraversal((u,d)=>{let v=!e.serverCache.isCompleteForChild(u)&&d.value===null;if(!h.hasChild(u)&&!v){let m=e.serverCache.getNode().getImmediateChild(u),w=Oc(t,m,d);a=O3(t,a,new V(u),w,s,c,o,r)}}),a}function Mh(t,e,n,i,s,c,o){if(A3(s,n)!=null)return e;let r=e.serverCache.isFiltered(),a=e.serverCache;if(i.value!=null){if(y(n)&&a.isFullyInitialized()||a.isCompleteForPath(n))return O3(t,e,n,a.getNode().getChild(n),s,c,r,o);if(y(n)){let l=new X(null);return a.getNode().forEachChild(L1,(h,u)=>{l=l.set(new V(h),u)}),Vt(t,e,n,l,s,c,r,o)}else return e}else{let l=new X(null);return i.foreach((h,u)=>{let d=k(n,h);a.isCompleteForPath(d)&&(l=l.set(h,a.getNode().getChild(d)))}),Vt(t,e,n,l,s,c,r,o)}}function yh(t,e,n,i,s){let c=e.serverCache,o=_7(e,c.getNode(),c.isFullyInitialized()||y(n),c.isFiltered());return V7(t,o,n,i,C7,s)}function bh(t,e,n,i,s,c){let o;if(A3(i,n)!=null)return e;{let r=new s2(i,e,s),a=e.eventCache.getNode(),l;if(y(n)||M(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=L3(i,L4(e));else{let u=e.serverCache.getNode();f(u instanceof z,"serverChildren would be complete if leaf node"),h=c0(i,u)}h=h,l=t.filter.updateFullNode(a,h,c)}else{let h=M(n),u=o0(i,h,e.serverCache);u==null&&e.serverCache.isCompleteForChild(h)&&(u=a.getImmediateChild(h)),u!=null?l=t.filter.updateChild(a,h,u,L(n),r,c):e.eventCache.getNode().hasChild(h)?l=t.filter.updateChild(a,h,z.EMPTY_NODE,L(n),r,c):l=a,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=L3(i,L4(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,c)))}return o=e.serverCache.isFullyInitialized()||A3(i,C())!=null,Ge(e,l,o,t.filter.filtersNodes())}}var Et=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let i=this.query_._queryParams,s=new t2(i.getIndex()),c=j9(i);this.processor_=ph(c);let o=n.serverCache,r=n.eventCache,a=s.updateFullNode(z.EMPTY_NODE,o.getNode(),null),l=c.updateFullNode(z.EMPTY_NODE,r.getNode(),null),h=new O1(a,o.isFullyInitialized(),s.filtersNodes()),u=new O1(l,r.isFullyInitialized(),c.filtersNodes());this.viewCache_=$3(u,h),this.eventGenerator_=new _t(this.query_)}get query(){return this.query_}};function Ch(t){return t.viewCache_.serverCache.getNode()}function Vh(t){return T3(t.viewCache_)}function Eh(t,e){let n=L4(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!y(e)&&!n.getImmediateChild(M(e)).isEmpty())?n.getChild(e):null}function Ic(t){return t.eventRegistrations_.length===0}function Hh(t,e){t.eventRegistrations_.push(e)}function kc(t,e,n){let i=[];if(n){f(e==null,"A cancel should cancel all event registrations.");let s=t.query._path;t.eventRegistrations_.forEach(c=>{let o=c.createCancelEvent(n,s);o&&i.push(o)})}if(e){let s=[];for(let c=0;c<t.eventRegistrations_.length;++c){let o=t.eventRegistrations_[c];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(c+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return i}function Bc(t,e,n,i){e.type===T1.MERGE&&e.source.queryId!==null&&(f(L4(t.viewCache_),"We should always have a full cache before handling merges"),f(T3(t.viewCache_),"Missing event cache, even though we have a server cache"));let s=t.viewCache_,c=_h(t.processor_,s,e,n,i);return gh(t.processor_,c.viewCache),f(c.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=c.viewCache,E7(t,c.changes,c.viewCache.eventCache.getNode(),null)}function xh(t,e){let n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(A,(c,o)=>{i.push(ce(c,o))}),n.isFullyInitialized()&&i.push(g7(n.getNode())),E7(t,i,n.getNode(),e)}function E7(t,e,n,i){let s=i?[i]:t.eventRegistrations_;return X9(t.eventGenerator_,e,n,s)}var I3,k3=class{constructor(){this.views=new Map}};function Sh(t){f(!I3,"__referenceConstructor has already been defined"),I3=t}function Th(){return f(I3,"Reference.ts has not been loaded"),I3}function Lh(t){return t.views.size===0}function r0(t,e,n,i){let s=e.source.queryId;if(s!==null){let c=t.views.get(s);return f(c!=null,"SyncTree gave us an op for an invalid query."),Bc(c,e,n,i)}else{let c=[];for(let o of t.views.values())c=c.concat(Bc(o,e,n,i));return c}}function H7(t,e,n,i,s){let c=e._queryIdentifier,o=t.views.get(c);if(!o){let r=L3(n,s?i:null),a=!1;r?a=!0:i instanceof z?(r=c0(n,i),a=!1):(r=z.EMPTY_NODE,a=!1);let l=$3(new O1(r,a,!1),new O1(i,s,!1));return new Et(e,l)}return o}function Ah(t,e,n,i,s,c){let o=H7(t,e,i,s,c);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),Hh(o,n),xh(o,n)}function Oh(t,e,n,i){let s=e._queryIdentifier,c=[],o=[],r=c4(t);if(s==="default")for(let[a,l]of t.views.entries())o=o.concat(kc(l,n,i)),Ic(l)&&(t.views.delete(a),l.query._queryParams.loadsAllData()||c.push(l.query));else{let a=t.views.get(s);a&&(o=o.concat(kc(a,n,i)),Ic(a)&&(t.views.delete(s),a.query._queryParams.loadsAllData()||c.push(a.query)))}return r&&!c4(t)&&c.push(new(Th())(e._repo,e._path)),{removed:c,events:o}}function x7(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function n4(t,e){let n=null;for(let i of t.views.values())n=n||Eh(i,e);return n}function S7(t,e){if(e._queryParams.loadsAllData())return Y3(t);{let i=e._queryIdentifier;return t.views.get(i)}}function T7(t,e){return S7(t,e)!=null}function c4(t){return Y3(t)!=null}function Y3(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var B3;function Ih(t){f(!B3,"__referenceConstructor has already been defined"),B3=t}function kh(){return f(B3,"Reference.ts has not been loaded"),B3}var Bh=1,D3=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new X(null),this.pendingWriteTree_=vh(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function a0(t,e,n,i,s){return nh(t.pendingWriteTree_,e,n,i,s),s?de(t,new oe(n0(),e,n)):[]}function Dh(t,e,n,i){ih(t.pendingWriteTree_,e,n,i);let s=X.fromObject(n);return de(t,new i2(n0(),e,s))}function e4(t,e,n=!1){let i=sh(t.pendingWriteTree_,e);if(ch(t.pendingWriteTree_,e)){let c=new X(null);return i.snap!=null?c=c.set(C(),!0):U(i.children,o=>{c=c.set(new V(o),!0)}),de(t,new gt(i.path,c,n))}else return[]}function f2(t,e,n){return de(t,new oe(i0(),e,n))}function Nh(t,e,n){let i=X.fromObject(n);return de(t,new i2(i0(),e,i))}function Rh(t,e){return de(t,new S3(i0(),e))}function Fh(t,e,n){let i=l0(t,n);if(i){let s=h0(i),c=s.path,o=s.queryId,r=Z(c,e),a=new S3(s0(o),r);return u0(t,c,a)}else return[]}function N3(t,e,n,i,s=!1){let c=e._path,o=t.syncPointTree_.get(c),r=[];if(o&&(e._queryIdentifier==="default"||T7(o,e))){let a=Oh(o,e,n,i);Lh(o)&&(t.syncPointTree_=t.syncPointTree_.remove(c));let l=a.removed;if(r=a.events,!s){let h=l.findIndex(d=>d._queryParams.loadsAllData())!==-1,u=t.syncPointTree_.findOnPath(c,(d,v)=>c4(v));if(h&&!u){let d=t.syncPointTree_.subtree(c);if(!d.isEmpty()){let v=Uh(d);for(let m=0;m<v.length;++m){let w=v[m],x=w.query,s1=I7(t,w);t.listenProvider_.startListening(Ke(x),c2(t,x),s1.hashFn,s1.onComplete)}}}!u&&l.length>0&&!i&&(h?t.listenProvider_.stopListening(Ke(e),null):l.forEach(d=>{let v=t.queryToTagMap.get(Z3(d));t.listenProvider_.stopListening(Ke(d),v)}))}jh(t,l)}return r}function L7(t,e,n,i){let s=l0(t,i);if(s!=null){let c=h0(s),o=c.path,r=c.queryId,a=Z(o,e),l=new oe(s0(r),a,n);return u0(t,o,l)}else return[]}function Ph(t,e,n,i){let s=l0(t,i);if(s){let c=h0(s),o=c.path,r=c.queryId,a=Z(o,e),l=X.fromObject(n),h=new i2(s0(r),a,l);return u0(t,o,h)}else return[]}function Ht(t,e,n,i=!1){let s=e._path,c=null,o=!1;t.syncPointTree_.foreachOnPath(s,(d,v)=>{let m=Z(d,s);c=c||n4(v,m),o=o||c4(v)});let r=t.syncPointTree_.get(s);r?(o=o||c4(r),c=c||n4(r,C())):(r=new k3,t.syncPointTree_=t.syncPointTree_.set(s,r));let a;c!=null?a=!0:(a=!1,c=z.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((v,m)=>{let w=n4(m,C());w&&(c=c.updateImmediateChild(v,w))}));let l=T7(r,e);if(!l&&!e._queryParams.loadsAllData()){let d=Z3(e);f(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");let v=Wh();t.queryToTagMap.set(d,v),t.tagToQueryMap.set(v,d)}let h=K3(t.pendingWriteTree_,s),u=Ah(r,e,n,h,c,a);if(!l&&!o&&!i){let d=S7(r,e);u=u.concat(Gh(t,e,d))}return u}function Q3(t,e,n){let s=t.pendingWriteTree_,c=t.syncPointTree_.findOnPath(e,(o,r)=>{let a=Z(o,e),l=n4(r,a);if(l)return l});return M7(s,e,c,n,!0)}function qh(t,e){let n=e._path,i=null;t.syncPointTree_.foreachOnPath(n,(l,h)=>{let u=Z(l,n);i=i||n4(h,u)});let s=t.syncPointTree_.get(n);s?i=i||n4(s,C()):(s=new k3,t.syncPointTree_=t.syncPointTree_.set(n,s));let c=i!=null,o=c?new O1(i,!0,!1):null,r=K3(t.pendingWriteTree_,e._path),a=H7(s,e,r,c?o.getNode():z.EMPTY_NODE,c);return Vh(a)}function de(t,e){return A7(e,t.syncPointTree_,null,K3(t.pendingWriteTree_,C()))}function A7(t,e,n,i){if(y(t.path))return O7(t,e,n,i);{let s=e.get(C());n==null&&s!=null&&(n=n4(s,C()));let c=[],o=M(t.path),r=t.operationForChild(o),a=e.children.get(o);if(a&&r){let l=n?n.getImmediateChild(o):null,h=y7(i,o);c=c.concat(A7(r,a,l,h))}return s&&(c=c.concat(r0(s,t,i,n))),c}}function O7(t,e,n,i){let s=e.get(C());n==null&&s!=null&&(n=n4(s,C()));let c=[];return e.children.inorderTraversal((o,r)=>{let a=n?n.getImmediateChild(o):null,l=y7(i,o),h=t.operationForChild(o);h&&(c=c.concat(O7(h,r,a,l)))}),s&&(c=c.concat(r0(s,t,i,n))),c}function I7(t,e){let n=e.query,i=c2(t,n);return{hashFn:()=>(Ch(e)||z.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?Fh(t,n._path,i):Rh(t,n._path);{let c=t9(s,n);return N3(t,n,null,c)}}}}function c2(t,e){let n=Z3(e);return t.queryToTagMap.get(n)}function Z3(t){return t._path.toString()+"$"+t._queryIdentifier}function l0(t,e){return t.tagToQueryMap.get(e)}function h0(t){let e=t.indexOf("$");return f(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new V(t.substr(0,e))}}function u0(t,e,n){let i=t.syncPointTree_.get(e);f(i,"Missing sync point for query tag that we're tracking");let s=K3(t.pendingWriteTree_,e);return r0(i,n,s,null)}function Uh(t){return t.fold((e,n,i)=>{if(n&&c4(n))return[Y3(n)];{let s=[];return n&&(s=x7(n)),U(i,(c,o)=>{s=s.concat(o)}),s}})}function Ke(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(kh())(t._repo,t._path):t}function jh(t,e){for(let n=0;n<e.length;++n){let i=e[n];if(!i._queryParams.loadsAllData()){let s=Z3(i),c=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(c)}}}function Wh(){return Bh++}function Gh(t,e,n){let i=e._path,s=c2(t,e),c=I7(t,n),o=t.listenProvider_.startListening(Ke(e),s,c.hashFn,c.onComplete),r=t.syncPointTree_.subtree(i);if(s)f(!c4(r.value),"If we're adding a query, it shouldn't be shadowed");else{let a=r.fold((l,h,u)=>{if(!y(l)&&h&&c4(h))return[Y3(h).query];{let d=[];return h&&(d=d.concat(x7(h).map(v=>v.query))),U(u,(v,m)=>{d=d.concat(m)}),d}});for(let l=0;l<a.length;++l){let h=a[l];t.listenProvider_.stopListening(Ke(h),c2(t,h))}}return o}var xt=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},St=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=k(this.path_,e);return new t(this.syncTree_,n)}node(){return Q3(this.syncTree_,this.path_)}},$h=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Dc=function(t,e,n){if(!t||typeof t!="object")return t;if(f(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Kh(t[".sv"],e,n);if(typeof t[".sv"]=="object")return Yh(t[".sv"],e);f(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Kh=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:f(!1,"Unexpected server value: "+t)}},Yh=function(t,e,n){t.hasOwnProperty("increment")||f(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let i=t.increment;typeof i!="number"&&f(!1,"Unexpected increment value: "+i);let s=e.node();if(f(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;let o=s.getValue();return typeof o!="number"?i:o+i},k7=function(t,e,n,i){return f0(e,new St(n,t),i)},d0=function(t,e,n){return f0(t,new xt(e),n)};function f0(t,e,n){let i=t.getPriority().val(),s=Dc(i,e.getImmediateChild(".priority"),n),c;if(t.isLeafNode()){let o=t,r=Dc(o.getValue(),e,n);return r!==o.getValue()||s!==o.getPriority().val()?new ie(r,B(s)):t}else{let o=t;return c=o,s!==o.getPriority().val()&&(c=c.updatePriority(new ie(s))),o.forEachChild(A,(r,a)=>{let l=f0(a,e.getImmediateChild(r),n);l!==a&&(c=c.updateImmediateChild(r,l))}),c}}var o2=class{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}};function X3(t,e){let n=e instanceof V?e:new V(e),i=t,s=M(n);for(;s!==null;){let c=G1(i.node.children,s)||{children:{},childCount:0};i=new o2(s,i,c),n=L(n),s=M(n)}return i}function I4(t){return t.node.value}function v0(t,e){t.node.value=e,Tt(t)}function B7(t){return t.node.childCount>0}function Qh(t){return I4(t)===void 0&&!B7(t)}function J3(t,e){U(t.node.children,(n,i)=>{e(new o2(n,t,i))})}function D7(t,e,n,i){n&&!i&&e(t),J3(t,s=>{D7(s,e,!0,i)}),n&&i&&e(t)}function Zh(t,e,n){let i=n?t:t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function v2(t){return new V(t.parent===null?t.name:v2(t.parent)+"/"+t.name)}function Tt(t){t.parent!==null&&Xh(t.parent,t.name,t)}function Xh(t,e,n){let i=Qh(n),s=m1(t.node.children,e);i&&s?(delete t.node.children[e],t.node.childCount--,Tt(t)):!i&&!s&&(t.node.children[e]=n.node,t.node.childCount++,Tt(t))}var Jh=/[\[\].#$\/\u0000-\u001F\u007F]/,eu=/[\[\].#$\u0000-\u001F\u007F]/,P6=10*1024*1024,e8=function(t){return typeof t=="string"&&t.length!==0&&!Jh.test(t)},N7=function(t){return typeof t=="string"&&t.length!==0&&!eu.test(t)},tu=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),N7(t)},r2=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!W3(t)||t&&typeof t=="object"&&m1(t,".sv")},I1=function(t,e,n,i){i&&e===void 0||m2(e1(t,"value"),e,n)},m2=function(t,e,n){let i=n instanceof V?new et(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+x4(i));if(typeof e=="function")throw new Error(t+"contains a function "+x4(i)+" with contents = "+e.toString());if(W3(e))throw new Error(t+"contains "+e.toString()+" "+x4(i));if(typeof e=="string"&&e.length>P6/3&&we(e)>P6)throw new Error(t+"contains a string greater than "+P6+" utf8 bytes "+x4(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,c=!1;if(U(e,(o,r)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(c=!0,!e8(o)))throw new Error(t+" contains an invalid key ("+o+") "+x4(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);L9(i,o),m2(t,r,i),A9(i)}),s&&c)throw new Error(t+' contains ".value" child '+x4(i)+" in addition to actual children.")}},nu=function(t,e){let n,i;for(n=0;n<e.length;n++){i=e[n];let c=Ze(i);for(let o=0;o<c.length;o++)if(!(c[o]===".priority"&&o===c.length-1)){if(!e8(c[o]))throw new Error(t+"contains an invalid key ("+c[o]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(T9);let s=null;for(n=0;n<e.length;n++){if(i=e[n],s!==null&&p1(s,i))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+i.toString());s=i}},R7=function(t,e,n,i){if(i&&e===void 0)return;let s=e1(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");let c=[];U(e,(o,r)=>{let a=new V(o);if(m2(s,r,k(n,a)),Zt(a)===".priority"&&!r2(r))throw new Error(s+"contains an invalid value for '"+a.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");c.push(a)}),nu(s,c)},m0=function(t,e,n){if(!(n&&e===void 0)){if(W3(e))throw new Error(e1(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!r2(e))throw new Error(e1(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},p2=function(t,e,n,i){if(!(i&&n===void 0)&&!e8(n))throw new Error(e1(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},fe=function(t,e,n,i){if(!(i&&n===void 0)&&!N7(n))throw new Error(e1(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},iu=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),fe(t,e,n,i)},h1=function(t,e){if(M(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},F7=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!e8(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!tu(n))throw new Error(e1(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var Lt=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function t8(t,e){let n=null;for(let i=0;i<e.length;i++){let s=e[i],c=s.getPath();n!==null&&!Xt(c,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:c}),n.events.push(s)}n&&t.eventLists_.push(n)}function P7(t,e,n){t8(t,n),q7(t,i=>Xt(i,e))}function u1(t,e,n){t8(t,n),q7(t,i=>p1(i,e)||p1(e,i))}function q7(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){let s=t.eventLists_[i];if(s){let c=s.path;e(c)?(su(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function su(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let i=n.getEventRunner();T4&&q("event: "+n.toString()),he(i)}}}var U7="repo_interrupt",cu=25,At=class{constructor(e,n,i,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Lt,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=x3(),this.transactionQueueTree_=new o2,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function ou(t,e,n){if(t.stats_=Kt(t.repoInfo_),t.forceRestClient_||c9())t.server_=new ut(t.repoInfo_,(i,s,c,o)=>{Nc(t,i,s,c,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Rc(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{D(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new Jt(t.repoInfo_,e,(i,s,c,o)=>{Nc(t,i,s,c,o)},i=>{Rc(t,i)},i=>{ru(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=r9(t.repoInfo_,()=>new pt(t.stats_,t.server_)),t.infoData_=new dt,t.infoSyncTree_=new D3({startListening:(i,s,c,o)=>{let r=[],a=t.infoData_.getNode(i._path);return a.isEmpty()||(r=f2(t.infoSyncTree_,i._path,a),setTimeout(()=>{o("ok")},0)),r},stopListening:()=>{}}),p0(t,"connected",!1),t.serverSyncTree_=new D3({startListening:(i,s,c,o)=>(t.server_.listen(i,c,s,(r,a)=>{let l=o(r,a);u1(t.eventQueue_,i._path,l)}),[]),stopListening:(i,s)=>{t.server_.unlisten(i,s)}})}function j7(t){let n=t.infoData_.getNode(new V(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function g2(t){return $h({timestamp:j7(t)})}function Nc(t,e,n,i,s){t.dataUpdateCount++;let c=new V(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(i){let a=ze(n,l=>B(l));o=Ph(t.serverSyncTree_,c,a,s)}else{let a=B(n);o=L7(t.serverSyncTree_,c,a,s)}else if(i){let a=ze(n,l=>B(l));o=Nh(t.serverSyncTree_,c,a)}else{let a=B(n);o=f2(t.serverSyncTree_,c,a)}let r=c;o.length>0&&(r=ae(t,c)),u1(t.eventQueue_,r,o)}function Rc(t,e){p0(t,"connected",e),e===!1&&hu(t)}function ru(t,e){U(e,(n,i)=>{p0(t,n,i)})}function p0(t,e,n){let i=new V("/.info/"+e),s=B(n);t.infoData_.updateSnapshot(i,s);let c=f2(t.infoSyncTree_,i,s);u1(t.eventQueue_,i,c)}function n8(t){return t.nextWriteId_++}function au(t,e,n){let i=qh(t.serverSyncTree_,e);return i!=null?Promise.resolve(i):t.server_.get(e).then(s=>{let c=B(s).withIndex(e._queryParams.getIndex());Ht(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=f2(t.serverSyncTree_,e._path,c);else{let r=c2(t.serverSyncTree_,e);o=L7(t.serverSyncTree_,e._path,c,r)}return u1(t.eventQueue_,e._path,o),N3(t.serverSyncTree_,e,n,null,!0),c},s=>(ve(t,"get for query "+D(e)+" failed: "+s),Promise.reject(new Error(s))))}function g0(t,e,n,i,s){ve(t,"set",{path:e.toString(),value:n,priority:i});let c=g2(t),o=B(n,i),r=Q3(t.serverSyncTree_,e),a=d0(o,r,c),l=n8(t),h=a0(t.serverSyncTree_,e,a,l,!0);t8(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(d,v)=>{let m=d==="ok";m||$("set at "+e+" failed: "+d);let w=e4(t.serverSyncTree_,l,!m);u1(t.eventQueue_,e,w),o4(t,s,d,v)});let u=z0(t,e);ae(t,u),u1(t.eventQueue_,u,[])}function lu(t,e,n,i){ve(t,"update",{path:e.toString(),value:n});let s=!0,c=g2(t),o={};if(U(n,(r,a)=>{s=!1,o[r]=k7(k(e,r),B(a),t.serverSyncTree_,c)}),s)q("update() called with empty data.  Don't do anything."),o4(t,i,"ok",void 0);else{let r=n8(t),a=Dh(t.serverSyncTree_,e,o,r);t8(t.eventQueue_,a),t.server_.merge(e.toString(),n,(l,h)=>{let u=l==="ok";u||$("update at "+e+" failed: "+l);let d=e4(t.serverSyncTree_,r,!u),v=d.length>0?ae(t,e):e;u1(t.eventQueue_,v,d),o4(t,i,l,h)}),U(n,l=>{let h=z0(t,k(e,l));ae(t,h)}),u1(t.eventQueue_,e,[])}}function hu(t){ve(t,"onDisconnectEvents");let e=g2(t),n=x3();vt(t.onDisconnect_,C(),(s,c)=>{let o=k7(s,c,t.serverSyncTree_,e);ue(n,s,o)});let i=[];vt(n,C(),(s,c)=>{i=i.concat(f2(t.serverSyncTree_,s,c));let o=z0(t,s);ae(t,o)}),t.onDisconnect_=x3(),u1(t.eventQueue_,C(),i)}function uu(t,e,n){t.server_.onDisconnectCancel(e.toString(),(i,s)=>{i==="ok"&&ft(t.onDisconnect_,e),o4(t,n,i,s)})}function Fc(t,e,n,i){let s=B(n);t.server_.onDisconnectPut(e.toString(),s.val(!0),(c,o)=>{c==="ok"&&ue(t.onDisconnect_,e,s),o4(t,i,c,o)})}function du(t,e,n,i,s){let c=B(n,i);t.server_.onDisconnectPut(e.toString(),c.val(!0),(o,r)=>{o==="ok"&&ue(t.onDisconnect_,e,c),o4(t,s,o,r)})}function fu(t,e,n,i){if(A2(n)){q("onDisconnect().update() called with empty data.  Don't do anything."),o4(t,i,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(s,c)=>{s==="ok"&&U(n,(o,r)=>{let a=B(r);ue(t.onDisconnect_,k(e,o),a)}),o4(t,i,s,c)})}function vu(t,e,n){let i;M(e._path)===".info"?i=Ht(t.infoSyncTree_,e,n):i=Ht(t.serverSyncTree_,e,n),P7(t.eventQueue_,e._path,i)}function Ot(t,e,n){let i;M(e._path)===".info"?i=N3(t.infoSyncTree_,e,n):i=N3(t.serverSyncTree_,e,n),P7(t.eventQueue_,e._path,i)}function W7(t){t.persistentConnection_&&t.persistentConnection_.interrupt(U7)}function mu(t){t.persistentConnection_&&t.persistentConnection_.resume(U7)}function ve(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),q(n,...e)}function o4(t,e,n,i){e&&he(()=>{if(n==="ok")e(null);else{let s=(n||"error").toUpperCase(),c=s;i&&(c+=": "+i);let o=new Error(c);o.code=s,e(o)}})}function pu(t,e,n,i,s,c){ve(t,"transaction on "+e);let o={path:e,update:n,onComplete:i,status:null,order:Jc(),applyLocally:c,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},r=_0(t,e,void 0);o.currentInputSnapshot=r;let a=o.update(r.val());if(a===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{m2("transaction failed: Data returned ",a,o.path),o.status=0;let l=X3(t.transactionQueueTree_,e),h=I4(l)||[];h.push(o),v0(l,h);let u;typeof a=="object"&&a!==null&&m1(a,".priority")?(u=G1(a,".priority"),f(r2(u),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):u=(Q3(t.serverSyncTree_,e)||z.EMPTY_NODE).getPriority().val();let d=g2(t),v=B(a,u),m=d0(v,r,d);o.currentOutputSnapshotRaw=v,o.currentOutputSnapshotResolved=m,o.currentWriteId=n8(t);let w=a0(t.serverSyncTree_,e,m,o.currentWriteId,o.applyLocally);u1(t.eventQueue_,e,w),i8(t,t.transactionQueueTree_)}}function _0(t,e,n){return Q3(t.serverSyncTree_,e,n)||z.EMPTY_NODE}function i8(t,e=t.transactionQueueTree_){if(e||s8(t,e),I4(e)){let n=$7(t,e);f(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&gu(t,v2(e),n)}else B7(e)&&J3(e,n=>{i8(t,n)})}function gu(t,e,n){let i=n.map(l=>l.currentWriteId),s=_0(t,e,i),c=s,o=s.hash();for(let l=0;l<n.length;l++){let h=n[l];f(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;let u=Z(e,h.path);c=c.updateChild(u,h.currentOutputSnapshotRaw)}let r=c.val(!0),a=e;t.server_.put(a.toString(),r,l=>{ve(t,"transaction put response",{path:a.toString(),status:l});let h=[];if(l==="ok"){let u=[];for(let d=0;d<n.length;d++)n[d].status=2,h=h.concat(e4(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&u.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();s8(t,X3(t.transactionQueueTree_,e)),i8(t,t.transactionQueueTree_),u1(t.eventQueue_,e,h);for(let d=0;d<u.length;d++)he(u[d])}else{if(l==="datastale")for(let u=0;u<n.length;u++)n[u].status===3?n[u].status=4:n[u].status=0;else{$("transaction at "+a.toString()+" failed: "+l);for(let u=0;u<n.length;u++)n[u].status=4,n[u].abortReason=l}ae(t,e)}},o)}function ae(t,e){let n=G7(t,e),i=v2(n),s=$7(t,n);return _u(t,s,i),i}function _u(t,e,n){if(e.length===0)return;let i=[],s=[],o=e.filter(r=>r.status===0).map(r=>r.currentWriteId);for(let r=0;r<e.length;r++){let a=e[r],l=Z(n,a.path),h=!1,u;if(f(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)h=!0,u=a.abortReason,s=s.concat(e4(t.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=cu)h=!0,u="maxretry",s=s.concat(e4(t.serverSyncTree_,a.currentWriteId,!0));else{let d=_0(t,a.path,o);a.currentInputSnapshot=d;let v=e[r].update(d.val());if(v!==void 0){m2("transaction failed: Data returned ",v,a.path);let m=B(v);typeof v=="object"&&v!=null&&m1(v,".priority")||(m=m.updatePriority(d.getPriority()));let x=a.currentWriteId,s1=g2(t),c1=d0(m,d,s1);a.currentOutputSnapshotRaw=m,a.currentOutputSnapshotResolved=c1,a.currentWriteId=n8(t),o.splice(o.indexOf(x),1),s=s.concat(a0(t.serverSyncTree_,a.path,c1,a.currentWriteId,a.applyLocally)),s=s.concat(e4(t.serverSyncTree_,x,!0))}else h=!0,u="nodata",s=s.concat(e4(t.serverSyncTree_,a.currentWriteId,!0))}u1(t.eventQueue_,n,s),s=[],h&&(e[r].status=2,function(d){setTimeout(d,Math.floor(0))}(e[r].unwatcher),e[r].onComplete&&(u==="nodata"?i.push(()=>e[r].onComplete(null,!1,e[r].currentInputSnapshot)):i.push(()=>e[r].onComplete(new Error(u),!1,null))))}s8(t,t.transactionQueueTree_);for(let r=0;r<i.length;r++)he(i[r]);i8(t,t.transactionQueueTree_)}function G7(t,e){let n,i=t.transactionQueueTree_;for(n=M(e);n!==null&&I4(i)===void 0;)i=X3(i,n),e=L(e),n=M(e);return i}function $7(t,e){let n=[];return K7(t,e,n),n.sort((i,s)=>i.order-s.order),n}function K7(t,e,n){let i=I4(e);if(i)for(let s=0;s<i.length;s++)n.push(i[s]);J3(e,s=>{K7(t,s,n)})}function s8(t,e){let n=I4(e);if(n){let i=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[i]=n[s],i++);n.length=i,v0(e,n.length>0?n:void 0)}J3(e,i=>{s8(t,i)})}function z0(t,e){let n=v2(G7(t,e)),i=X3(t.transactionQueueTree_,e);return Zh(i,s=>{q6(t,s)}),q6(t,i),D7(i,s=>{q6(t,s)}),n}function q6(t,e){let n=I4(e);if(n){let i=[],s=[],c=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(f(c===o-1,"All SENT items should be at beginning of queue."),c=o,n[o].status=3,n[o].abortReason="set"):(f(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(e4(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));c===-1?v0(e,void 0):n.length=c+1,u1(t.eventQueue_,v2(e),s);for(let o=0;o<i.length;o++)he(i[o])}}function zu(t){let e="",n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let s=n[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function wu(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):$(`Invalid query segment '${n}' in query '${t}'`)}return e}var It=function(t,e){let n=Mu(t),i=n.namespace;n.domain==="firebase.com"&&A1(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&A1("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||Ql();let s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new M3(n.host,n.secure,i,s,e,"",i!==n.subdomain),path:new V(n.pathString)}},Mu=function(t){let e="",n="",i="",s="",c="",o=!0,r="https",a=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(r=t.substring(0,l-1),t=t.substring(l+2));let h=t.indexOf("/");h===-1&&(h=t.length);let u=t.indexOf("?");u===-1&&(u=t.length),e=t.substring(0,Math.min(h,u)),h<u&&(s=zu(t.substring(h,u)));let d=wu(t.substring(Math.min(t.length,u)));l=e.indexOf(":"),l>=0?(o=r==="https"||r==="wss",a=parseInt(e.substring(l+1),10)):l=e.length;let v=e.slice(0,l);if(v.toLowerCase()==="localhost")n="localhost";else if(v.split(".").length<=2)n=v;else{let m=e.indexOf(".");i=e.substring(0,m).toLowerCase(),n=e.substring(m+1),c=i}"ns"in d&&(c=d.ns)}return{host:e,port:a,domain:n,subdomain:i,secure:o,scheme:r,pathString:s,namespace:c}};var Pc="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",yu=function(){let t=0,e=[];return function(n){let i=n===t;t=n;let s,c=new Array(8);for(s=7;s>=0;s--)c[s]=Pc.charAt(n%64),n=Math.floor(n/64);f(n===0,"Cannot push at time == 0");let o=c.join("");if(i){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)o+=Pc.charAt(e[s]);return f(o.length===20,"nextPushId: Length should be 20."),o}}();var R3=class{constructor(e,n,i,s){this.eventType=e,this.eventRegistration=n,this.snapshot=i,this.prevName=s}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+D(this.snapshot.exportVal())}},F3=class{constructor(e,n,i){this.eventRegistration=e,this.error=n,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var a2=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return f(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var P3=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new P;return uu(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){h1("OnDisconnect.remove",this._path);let e=new P;return Fc(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){h1("OnDisconnect.set",this._path),I1("OnDisconnect.set",e,this._path,!1);let n=new P;return Fc(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){h1("OnDisconnect.setWithPriority",this._path),I1("OnDisconnect.setWithPriority",e,this._path,!1),m0("OnDisconnect.setWithPriority",n,!1);let i=new P;return du(this._repo,this._path,e,n,i.wrapCallback(()=>{})),i.promise}update(e){h1("OnDisconnect.update",this._path),R7("OnDisconnect.update",e,this._path,!1);let n=new P;return fu(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var J=class t{constructor(e,n,i,s){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=s}get key(){return y(this._path)?null:Zt(this._path)}get ref(){return new d1(this._repo,this._path)}get _queryIdentifier(){let e=Hc(this._queryParams),n=$t(e);return n==="{}"?"default":n}get _queryObject(){return Hc(this._queryParams)}isEqual(e){if(e=K(e),!(e instanceof t))return!1;let n=this._repo===e._repo,i=Xt(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+S9(this._path)}};function c8(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function a4(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===L1){let i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==i4)throw new Error(i);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==q1)throw new Error(i);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===A){if(e!=null&&!r2(e)||n!=null&&!r2(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(f(t.getIndex()instanceof Xe||t.getIndex()===t0,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function o8(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var d1=class t extends J{constructor(e,n){super(e,n,new n2,!1)}get parent(){let e=u7(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},le=class t{constructor(e,n,i){this._node=e,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new V(e),i=r4(this.ref,e);return new t(this._node.getChild(n),i,A)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new t(s,r4(this.ref,i),A)))}hasChild(e){let n=new V(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function w0(t,e){return t=K(t),t._checkNotDeleted("ref"),e!==void 0?r4(t._root,e):t._root}function M0(t,e){t=K(t),t._checkNotDeleted("refFromURL");let n=It(e,t._repo.repoInfo_.nodeAdmin);F7("refFromURL",n);let i=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&i.host!==t._repo.repoInfo_.host&&A1("refFromURL: Host name does not match the current database: (found "+i.host+" but expected "+t._repo.repoInfo_.host+")"),w0(t,n.path.toString())}function r4(t,e){return t=K(t),M(t._path)===null?iu("child","path",e,!1):fe("child","path",e,!1),new d1(t._repo,k(t._path,e))}function Y7(t,e){t=K(t),h1("push",t._path),I1("push",e,t._path,!0);let n=j7(t._repo),i=yu(n),s=r4(t,i),c=r4(t,i),o;return e!=null?o=r8(c,e).then(()=>c):o=Promise.resolve(c),s.then=o.then.bind(o),s.catch=o.then.bind(o,void 0),s}function Q7(t){return h1("remove",t._path),r8(t,null)}function r8(t,e){t=K(t),h1("set",t._path),I1("set",e,t._path,!1);let n=new P;return g0(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function Z7(t,e){t=K(t),h1("setPriority",t._path),m0("setPriority",e,!1);let n=new P;return g0(t._repo,k(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function X7(t,e,n){if(h1("setWithPriority",t._path),I1("setWithPriority",e,t._path,!1),m0("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let i=new P;return g0(t._repo,t._path,e,n,i.wrapCallback(()=>{})),i.promise}function J7(t,e){R7("update",e,t._path,!1);let n=new P;return lu(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function eo(t){t=K(t);let e=new a2(()=>{}),n=new l2(e);return au(t._repo,t,n).then(i=>new le(i,new d1(t._repo,t._path),t._queryParams.getIndex()))}var l2=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let i=n._queryParams.getIndex();return new R3("value",this,new le(e.snapshotNode,new d1(n._repo,n._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new F3(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},q3=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new F3(this,e,n):null}createEvent(e,n){f(e.childName!=null,"Child events should have a childName.");let i=r4(new d1(n._repo,n._path),e.childName),s=n._queryParams.getIndex();return new R3(e.type,this,new le(e.snapshotNode,i,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function _2(t,e,n,i,s){let c;if(typeof i=="object"&&(c=void 0,s=i),typeof i=="function"&&(c=i),s&&s.onlyOnce){let a=n,l=(h,u)=>{Ot(t._repo,t,r),a(h,u)};l.userCallback=n.userCallback,l.context=n.context,n=l}let o=new a2(n,c||void 0),r=e==="value"?new l2(o):new q3(e,o);return vu(t._repo,t,r),()=>Ot(t._repo,t,r)}function a8(t,e,n,i){return _2(t,"value",e,n,i)}function y0(t,e,n,i){return _2(t,"child_added",e,n,i)}function b0(t,e,n,i){return _2(t,"child_changed",e,n,i)}function C0(t,e,n,i){return _2(t,"child_moved",e,n,i)}function V0(t,e,n,i){return _2(t,"child_removed",e,n,i)}function E0(t,e,n){let i=null,s=n?new a2(n):null;e==="value"?i=new l2(s):e&&(i=new q3(e,s)),Ot(t._repo,t,i)}var f1=class{},U3=class extends f1{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){I1("endAt",this._value,e._path,!0);let n=ht(e._queryParams,this._value,this._key);if(o8(n),a4(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new J(e._repo,e._path,n,e._orderByCalled)}};function to(t,e){return p2("endAt","key",e,!0),new U3(t,e)}var kt=class extends f1{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){I1("endBefore",this._value,e._path,!1);let n=K9(e._queryParams,this._value,this._key);if(o8(n),a4(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new J(e._repo,e._path,n,e._orderByCalled)}};function no(t,e){return p2("endBefore","key",e,!0),new kt(t,e)}var j3=class extends f1{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){I1("startAt",this._value,e._path,!0);let n=lt(e._queryParams,this._value,this._key);if(o8(n),a4(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new J(e._repo,e._path,n,e._orderByCalled)}};function io(t=null,e){return p2("startAt","key",e,!0),new j3(t,e)}var Bt=class extends f1{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){I1("startAfter",this._value,e._path,!1);let n=$9(e._queryParams,this._value,this._key);if(o8(n),a4(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new J(e._repo,e._path,n,e._orderByCalled)}};function so(t,e){return p2("startAfter","key",e,!0),new Bt(t,e)}var Dt=class extends f1{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new J(e._repo,e._path,W9(e._queryParams,this._limit),e._orderByCalled)}};function co(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Dt(t)}var Nt=class extends f1{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new J(e._repo,e._path,G9(e._queryParams,this._limit),e._orderByCalled)}};function oo(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Nt(t)}var Rt=class extends f1{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){c8(e,"orderByChild");let n=new V(this._path);if(y(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let i=new Xe(n),s=G3(e._queryParams,i);return a4(s),new J(e._repo,e._path,s,!0)}};function ro(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return fe("orderByChild","path",t,!1),new Rt(t)}var Ft=class extends f1{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){c8(e,"orderByKey");let n=G3(e._queryParams,L1);return a4(n),new J(e._repo,e._path,n,!0)}};function ao(){return new Ft}var Pt=class extends f1{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){c8(e,"orderByPriority");let n=G3(e._queryParams,A);return a4(n),new J(e._repo,e._path,n,!0)}};function lo(){return new Pt}var qt=class extends f1{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){c8(e,"orderByValue");let n=G3(e._queryParams,t0);return a4(n),new J(e._repo,e._path,n,!0)}};function ho(){return new qt}var Ut=class extends f1{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(I1("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new U3(this._value,this._key)._apply(new j3(this._value,this._key)._apply(e))}};function uo(t,e){return p2("equalTo","key",e,!0),new Ut(t,e)}function _1(t,...e){let n=K(t);for(let i of e)n=i._apply(n);return n}Sh(d1);Ih(d1);var bu="FIREBASE_DATABASE_EMULATOR_HOST",jt={},Cu=!1;function Vu(t,e,n,i){t.repoInfo_=new M3(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),i&&(t.authTokenProvider_=i)}function H0(t,e,n,i,s){let c=i||t.options.databaseURL;c===void 0&&(t.options.projectId||A1("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),q("Using default host for project ",t.options.projectId),c=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=It(c,s),r=o.repoInfo,a,l;typeof process<"u"&&process.env&&(l=process.env[bu]),l?(a=!0,c=`http://${l}?ns=${r.namespace}`,o=It(c,s),r=o.repoInfo):a=!o.repoInfo.secure;let h=s&&a?new We(We.OWNER):new Q6(t.name,t.options,e);F7("Invalid Firebase Database URL",o),y(o.path)||A1("Database URL must point to the root of a Firebase Database (not including a child path).");let u=Hu(r,t,h,new Y6(t.name,n));return new Wt(u,t)}function Eu(t,e){let n=jt[e];(!n||n[t.key]!==t)&&A1(`Database ${e}(${t.repoInfo_}) has already been deleted.`),W7(t),delete n[t.key]}function Hu(t,e,n,i){let s=jt[e.name];s||(s={},jt[e.name]=s);let c=s[t.toURLString()];return c&&A1("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),c=new At(t,Cu,n,i),s[t.toURLString()]=c,c}var Wt=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(ou(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new d1(this._repo,C())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Eu(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&A1("Cannot call "+e+" on a deleted database.")}};function fo(){h7.IS_TRANSPORT_INITIALIZED&&$("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function vo(){fo(),Qe.forceDisallow()}function mo(){fo(),J4.forceDisallow(),Qe.forceAllow()}function po(t,e,n,i={}){t=K(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&A1("Cannot call useEmulator() after instance has already been initialized.");let s=t._repoInternal,c;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&A1('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),c=new We(We.OWNER);else if(i.mockUserToken){let o=typeof i.mockUserToken=="string"?i.mockUserToken:J0(i.mockUserToken,t.app.options.projectId);c=new We(o)}Vu(s,e,n,c)}function go(t){t=K(t),t._checkNotDeleted("goOffline"),W7(t._repo)}function _o(t){t=K(t),t._checkNotDeleted("goOnline"),mu(t._repo)}function zo(t,e){t7(t,e)}function xu(t){Qt(hn),Me(new N1("database",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),c=e.getProvider("app-check-internal");return H0(i,s,c,n)},"PUBLIC").setMultipleInstances(!0)),$1(dc,fc,t),$1(dc,fc,"esm2017")}var Su={".sv":"timestamp"};function wo(){return Su}function Mo(t){return{".sv":{increment:t}}}var Gt=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function yo(t,e,n){var i;if(t=K(t),h1("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let s=(i=n?.applyLocally)!==null&&i!==void 0?i:!0,c=new P,o=(a,l,h)=>{let u=null;a?c.reject(a):(u=new le(h,new d1(t._repo,t._path),A),c.resolve(new Gt(l,u)))},r=a8(t,()=>{});return pu(t._repo,t._path,e,o,r,s),c.promise}Jt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Jt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};h9(qc.default.Client);xu("node");var Tu="@firebase/database-compat",Lu="1.0.4";var Au=new F4("@firebase/database-compat"),bo=function(t){let e="FIREBASE WARNING: "+t;Au.warn(e)};var Ou=function(t,e,n,i){if(!(i&&n===void 0)&&typeof n!="boolean")throw new Error(e1(t,e)+"must be a boolean.")},Iu=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(e1(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var x0=class{constructor(e){this._delegate=e}cancel(e){_("OnDisconnect.cancel",0,1,arguments.length),N("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),i=>e(i)),n}remove(e){_("OnDisconnect.remove",0,1,arguments.length),N("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),i=>e(i)),n}set(e,n){_("OnDisconnect.set",1,2,arguments.length),N("OnDisconnect.set","onComplete",n,!0);let i=this._delegate.set(e);return n&&i.then(()=>n(null),s=>n(s)),i}setWithPriority(e,n,i){_("OnDisconnect.setWithPriority",2,3,arguments.length),N("OnDisconnect.setWithPriority","onComplete",i,!0);let s=this._delegate.setWithPriority(e,n);return i&&s.then(()=>i(null),c=>i(c)),s}update(e,n){if(_("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let s={};for(let c=0;c<e.length;++c)s[""+c]=e[c];e=s,bo("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}N("OnDisconnect.update","onComplete",n,!0);let i=this._delegate.update(e);return n&&i.then(()=>n(null),s=>n(s)),i}};var S0=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return _("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var k4=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return _("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return _("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return _("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return _("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return _("DataSnapshot.child",0,1,arguments.length),e=String(e),fe("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return _("DataSnapshot.hasChild",1,1,arguments.length),fe("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return _("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return _("DataSnapshot.forEach",1,1,arguments.length),N("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return _("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return _("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return _("DataSnapshot.ref",0,0,arguments.length),new U1(this._database,this._delegate.ref)}get ref(){return this.getRef()}},l8=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,i,s){var c;_("Query.on",2,4,arguments.length),N("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",i,s),r=(l,h)=>{n.call(o.context,new k4(this.database,l),h)};r.userCallback=n,r.context=o.context;let a=(c=o.cancel)===null||c===void 0?void 0:c.bind(o.context);switch(e){case"value":return a8(this._delegate,r,a),n;case"child_added":return y0(this._delegate,r,a),n;case"child_removed":return V0(this._delegate,r,a),n;case"child_changed":return b0(this._delegate,r,a),n;case"child_moved":return C0(this._delegate,r,a),n;default:throw new Error(e1("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,i){if(_("Query.off",0,3,arguments.length),Iu("Query.off",e,!0),N("Query.off","callback",n,!0),_8("Query.off","context",i,!0),n){let s=()=>{};s.userCallback=n,s.context=i,E0(this._delegate,e,s)}else E0(this._delegate,e)}get(){return eo(this._delegate).then(e=>new k4(this.database,e))}once(e,n,i,s){_("Query.once",1,4,arguments.length),N("Query.once","callback",n,!0);let c=t.getCancelAndContextArgs_("Query.once",i,s),o=new P,r=(l,h)=>{let u=new k4(this.database,l);n&&n.call(c.context,u,h),o.resolve(u)};r.userCallback=n,r.context=c.context;let a=l=>{c.cancel&&c.cancel.call(c.context,l),o.reject(l)};switch(e){case"value":a8(this._delegate,r,a,{onlyOnce:!0});break;case"child_added":y0(this._delegate,r,a,{onlyOnce:!0});break;case"child_removed":V0(this._delegate,r,a,{onlyOnce:!0});break;case"child_changed":b0(this._delegate,r,a,{onlyOnce:!0});break;case"child_moved":C0(this._delegate,r,a,{onlyOnce:!0});break;default:throw new Error(e1("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return _("Query.limitToFirst",1,1,arguments.length),new t(this.database,_1(this._delegate,co(e)))}limitToLast(e){return _("Query.limitToLast",1,1,arguments.length),new t(this.database,_1(this._delegate,oo(e)))}orderByChild(e){return _("Query.orderByChild",1,1,arguments.length),new t(this.database,_1(this._delegate,ro(e)))}orderByKey(){return _("Query.orderByKey",0,0,arguments.length),new t(this.database,_1(this._delegate,ao()))}orderByPriority(){return _("Query.orderByPriority",0,0,arguments.length),new t(this.database,_1(this._delegate,lo()))}orderByValue(){return _("Query.orderByValue",0,0,arguments.length),new t(this.database,_1(this._delegate,ho()))}startAt(e=null,n){return _("Query.startAt",0,2,arguments.length),new t(this.database,_1(this._delegate,io(e,n)))}startAfter(e=null,n){return _("Query.startAfter",0,2,arguments.length),new t(this.database,_1(this._delegate,so(e,n)))}endAt(e=null,n){return _("Query.endAt",0,2,arguments.length),new t(this.database,_1(this._delegate,to(e,n)))}endBefore(e=null,n){return _("Query.endBefore",0,2,arguments.length),new t(this.database,_1(this._delegate,no(e,n)))}equalTo(e,n){return _("Query.equalTo",1,2,arguments.length),new t(this.database,_1(this._delegate,uo(e,n)))}toString(){return _("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return _("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(_("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,i){let s={cancel:void 0,context:void 0};if(n&&i)s.cancel=n,N(e,"cancel",s.cancel,!0),s.context=i,_8(e,"context",s.context,!0);else if(n)if(typeof n=="object"&&n!==null)s.context=n;else if(typeof n=="function")s.cancel=n;else throw new Error(e1(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return s}get ref(){return new U1(this.database,new d1(this._delegate._repo,this._delegate._path))}},U1=class t extends l8{constructor(e,n){super(e,new J(n._repo,n._path,new n2,!1)),this.database=e,this._delegate=n}getKey(){return _("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return _("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,r4(this._delegate,e))}getParent(){_("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return _("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){_("Reference.set",1,2,arguments.length),N("Reference.set","onComplete",n,!0);let i=r8(this._delegate,e);return n&&i.then(()=>n(null),s=>n(s)),i}update(e,n){if(_("Reference.update",1,2,arguments.length),Array.isArray(e)){let s={};for(let c=0;c<e.length;++c)s[""+c]=e[c];e=s,bo("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}h1("Reference.update",this._delegate._path),N("Reference.update","onComplete",n,!0);let i=J7(this._delegate,e);return n&&i.then(()=>n(null),s=>n(s)),i}setWithPriority(e,n,i){_("Reference.setWithPriority",2,3,arguments.length),N("Reference.setWithPriority","onComplete",i,!0);let s=X7(this._delegate,e,n);return i&&s.then(()=>i(null),c=>i(c)),s}remove(e){_("Reference.remove",0,1,arguments.length),N("Reference.remove","onComplete",e,!0);let n=Q7(this._delegate);return e&&n.then(()=>e(null),i=>e(i)),n}transaction(e,n,i){_("Reference.transaction",1,3,arguments.length),N("Reference.transaction","transactionUpdate",e,!1),N("Reference.transaction","onComplete",n,!0),Ou("Reference.transaction","applyLocally",i,!0);let s=yo(this._delegate,e,{applyLocally:i}).then(c=>new S0(c.committed,new k4(this.database,c.snapshot)));return n&&s.then(c=>n(null,c.committed,c.snapshot),c=>n(c,!1,null)),s}setPriority(e,n){_("Reference.setPriority",1,2,arguments.length),N("Reference.setPriority","onComplete",n,!0);let i=Z7(this._delegate,e);return n&&i.then(()=>n(null),s=>n(s)),i}push(e,n){_("Reference.push",0,2,arguments.length),N("Reference.push","onComplete",n,!0);let i=Y7(this._delegate,e),s=i.then(o=>new t(this.database,o));n&&s.then(()=>n(null),o=>n(o));let c=new t(this.database,i);return c.then=s.then.bind(s),c.catch=s.catch.bind(s,void 0),c}onDisconnect(){return h1("Reference.onDisconnect",this._delegate._path),new x0(new P3(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var B4=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:vo,forceLongPolling:mo}}useEmulator(e,n,i={}){po(this._delegate,e,n,i)}ref(e){if(_("database.ref",0,1,arguments.length),e instanceof U1){let n=M0(this._delegate,e.toString());return new U1(this,n)}else{let n=w0(this._delegate,e);return new U1(this,n)}}refFromURL(e){_("database.refFromURL",1,1,arguments.length);let i=M0(this._delegate,e);return new U1(this,i)}goOffline(){return _("database.goOffline",0,0,arguments.length),go(this._delegate)}goOnline(){return _("database.goOnline",0,0,arguments.length),_o(this._delegate)}};B4.ServerValue={TIMESTAMP:wo(),increment:t=>Mo(t)};function ku({app:t,url:e,version:n,customAuthImpl:i,customAppCheckImpl:s,namespace:c,nodeAdmin:o=!1}){Qt(n);let r=new z8("database-standalone"),a=new O2("auth-internal",r);a.setComponent(new N1("auth-internal",()=>i,"PRIVATE"));let l;return s&&(l=new O2("app-check-internal",r),l.setComponent(new N1("app-check-internal",()=>s,"PRIVATE"))),{instance:new B4(H0(t,a,l,e,o),t),namespace:c}}var Bu=Object.freeze({__proto__:null,initStandalone:ku});var Du=B4.ServerValue;function Nu(t){t.INTERNAL.registerComponent(new N1("database-compat",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app-compat").getImmediate(),s=e.getProvider("database").getImmediate({identifier:n});return new B4(s,i)},"PUBLIC").setServiceProps({Reference:U1,Query:l8,Database:B4,DataSnapshot:k4,enableLogging:zo,INTERNAL:Bu,ServerValue:Du}).setMultipleInstances(!0)),t.registerVersion(Tu,Lu,"node")}Nu(t1);function z2(t,e,n="on",i=w2){return new j1(s=>{let c=null;return c=t[n](e,(o,r)=>{i.schedule(()=>{s.next({snapshot:o,prevKey:r})}),n==="once"&&i.schedule(()=>s.complete())},o=>{i.schedule(()=>s.error(o))}),n==="on"?{unsubscribe(){c!=null&&t.off(e,c)}}:{unsubscribe(){}}}).pipe(G(s=>{let{snapshot:c,prevKey:o}=s,r=null;return c.exists()&&(r=c.key),{type:e,payload:c,prevKey:o,key:r}}),M2())}function Ru(t){return typeof t=="string"}function Fu(t){return typeof t.exportVal=="function"}function xo(t){return t==null}function So(t){return typeof t.set=="function"}function Co(t,e){return So(e)?e:t.ref(e)}function To(t,e){if(Ru(t))return e.stringCase();if(So(t))return e.firebaseCase();if(Fu(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function Lo(t){return(xo(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function Ao(t,e,n){e=Lo(e);let i=e.map(s=>z2(t,s,"on",n));return me(...i)}function Pu(t,e,n){let i=Ao(t,e).pipe(h8((s,c)=>[...s,c],[]));return Uu(t,i,n)}function qu(t,e){return z2(t,"value","on",e).pipe(G(n=>{let i;return n.payload.forEach(s=>(i=s.key,!1)),{data:n,lastKeyToLoad:i}}))}function Uu(t,e,n){return qu(t,n).pipe(P0(e),G(([s,c])=>{let o=s.lastKeyToLoad,r=c.map(a=>a.key);return{actions:c,lastKeyToLoad:o,loadedKeys:r}}),R0(s=>s.loadedKeys.indexOf(s.lastKeyToLoad)===-1),G(s=>s.actions))}function Vo(t,e){return function(i,s){return To(i,{stringCase:()=>t.child(i)[e](s),firebaseCase:()=>i[e](s),snapshotCase:()=>i.ref[e](s)})}}function ju(t){return function(n){return n?To(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function Wu(t,e,n){return z2(t,"value","once",n).pipe(B1(i=>{let s=[w1(i)];return e.forEach(c=>s.push(z2(t,c,"on",n))),me(...s).pipe(h8($u,[]))}),B0())}function Oo(t,e){let n=t.length;for(let i=0;i<n;i++)if(t[i].payload.key===e)return i;return-1}function Gu(t,e){if(xo(e))return 0;{let n=Oo(t,e);return n===-1?t.length:n+1}}function $u(t,e){let{payload:n,prevKey:i,key:s}=e,c=Oo(t,s),o=Gu(t,i);switch(e.type){case"value":if(e.payload?.exists()){let r=null;e.payload.forEach(a=>{let l={payload:a,type:"value",prevKey:r,key:a.key};return r=a.key,t=[...t,l],!1})}return t;case"child_added":if(c>-1)(t[c-1]?.key||null)!==i&&(t=t.filter(a=>a.payload.key!==n.key),t.splice(o,0,e));else{if(i==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(r=>r.payload.key!==n.key);case"child_changed":return t.map(r=>r.payload.key===s?e:r);case"child_moved":if(c>-1){let r=t.splice(c,1)[0];return t=t.slice(),t.splice(o,0,r),t}return t;default:return t}}function Eo(t,e,n){return e=Lo(e),Wu(t,e,n)}function Ku(t,e){let n=e.schedulers.outsideAngular,i=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:Vo(i,"update"),set:Vo(i,"set"),push:s=>i.push(s),remove:ju(i),snapshotChanges(s){return Eo(t,s,n).pipe(P1)},stateChanges(s){return Ao(t,s,n).pipe(P1)},auditTrail(s){return Pu(t,s,n).pipe(P1)},valueChanges(s,c){return Eo(t,s,n).pipe(G(r=>r.map(a=>c&&c.idField?v1(F({},a.payload.val()),{[c.idField]:a.key}):a.payload.val())),P1)}}}function Ho(t,e){return function(){return z2(t,"value","on",e)}}function Yu(t,e){return{query:t,snapshotChanges(){return Ho(t,e.schedulers.outsideAngular)().pipe(P1)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return Ho(t,e.schedulers.outsideAngular)().pipe(P1,G(i=>i.payload.exists()?i.payload.val():null))}}}var Qu=new H("angularfire2.realtimeDatabaseURL"),Zu=new H("angularfire2.database.use-emulator"),Xu=(()=>{class t{schedulers;database;constructor(n,i,s,c,o,r,a,l,h,u,d,v,m,w,x){this.schedulers=r;let s1=a,c1=xe(n,o,i);l&&t6(c1,o,h,d,v,m,u,w),this.database=t3(`${c1.name}.database.${s}`,"AngularFireDatabase",c1.name,()=>{let O=o.runOutsideAngular(()=>c1.database(s||void 0));return s1&&O.useEmulator(...s1),O},[s1])}list(n,i){let s=this.schedulers.ngZone.runOutsideAngular(()=>Co(this.database,n)),c=s;return i&&(c=i(s)),Ku(c,this)}object(n){let i=this.schedulers.ngZone.runOutsideAngular(()=>Co(this.database,n));return Yu(i,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(i){return new(i||t)(g(G4),g($4,8),g(Qu,8),g(W1),g(E1),g(J2),g(Zu,8),g(x5,8),g(Y8,8),g(Q8,8),g(Z8,8),g(X8,8),g(J8,8),g(e6,8),g(z4,8))};static \u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),yp=(()=>{class t{constructor(){t1.registerVersion("angularfire",W4.full,"rtdb-compat")}static \u0275fac=function(i){return new(i||t)};static \u0275mod=o1({type:t});static \u0275inj=a1({providers:[Xu]})}return t})();export{tf as a,nf as b,sf as c,cf as d,Uf as e,jf as f,Qi as g,dv as h,fv as i,$2 as j,U2 as k,mv as l,Jr as m,ta as n,pv as o,gv as p,_v as q,Dv as r,S1 as s,Xu as t,yp as u};
