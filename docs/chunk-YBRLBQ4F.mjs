import './polyfills.server.mjs';
import{A as D0,Aa as d8,B as M2,Ba as q0,C as de,D as fe,F as o1,Fa as U0,G as w1,H as ve,J as j,K as r1,L as H,La as u4,O as j1,Pa as f8,Q as R0,R as y2,Ra as E2,S as g,W as F0,Z as me,Za as j0,_ as N0,_a as W0,b as q1,ba as P0,c as U1,cb as H2,d as _2,db as G0,e as x0,ea as N,f as h4,g as A4,ga as b2,h as O4,ha as pe,i as z1,j as G,ja as k1,k as S0,ka as W1,kb as x2,l as ue,m as I4,n as T0,na as C2,o as L0,p as A0,q as O0,r as I0,s as k0,t as a8,ta as u8,u as z2,v as l8,w as B0,x as I1,xa as V2,y as h8,z as w2}from"./chunk-3K3VNCHJ.mjs";import{A as sn,B as _e,C as K,D as B1,E as A2,F as p8,G as cn,H as B4,I as ze,J as on,K as rn,L as $1,M as t1,a as f,b as k4,c as S2,d as $0,e as K0,f as P,g as Y0,h as v8,i as Q0,j as E1,k as Z0,l as X0,m as T2,n as B,o as J0,p as en,q as v1,r as G1,s as L2,t as ge,u as tn,v as nn,w as _,x as e1,y as D,z as m8}from"./chunk-ZQQCJHUH.mjs";import{a as F,b as f1,c as S,f as E,h as Co,j as V1}from"./chunk-H6KHSOBK.mjs";var x1=E((e6,w5)=>{"use strict";var t3=S("buffer"),H1=t3.Buffer;function z5(t,e){for(var n in t)e[n]=t[n]}H1.from&&H1.alloc&&H1.allocUnsafe&&H1.allocUnsafeSlow?w5.exports=t3:(z5(t3,e6),e6.Buffer=m4);function m4(t,e,n){return H1(t,e,n)}m4.prototype=Object.create(H1.prototype);z5(H1,m4);m4.from=function(t,e,n){if(typeof t=="number")throw new TypeError("Argument must not be a number");return H1(t,e,n)};m4.alloc=function(t,e,n){if(typeof t!="number")throw new TypeError("Argument must be a number");var i=H1(t);return e!==void 0?typeof n=="string"?i.fill(e,n):i.fill(e):i.fill(0),i};m4.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return H1(t)};m4.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return t3.SlowBuffer(t)}});var b5=E(t6=>{"use strict";var M5=S("stream").Stream,y5=S("util"),p4=function(t){this.readable=this.writable=!0,this._paused=!1,this._driver=t};y5.inherits(p4,M5);p4.prototype.pause=function(){this._paused=!0,this._driver.messages._paused=!0};p4.prototype.resume=function(){this._paused=!1,this.emit("drain");var t=this._driver.messages;t._paused=!1,t.emit("drain")};p4.prototype.write=function(t){return this.writable?(this._driver.parse(t),!this._paused):!1};p4.prototype.end=function(t){if(this.writable){t!==void 0&&this.write(t),this.writable=!1;var e=this._driver.messages;e.readable&&(e.readable=e.writable=!1,e.emit("end"))}};p4.prototype.destroy=function(){this.end()};var g4=function(t){this.readable=this.writable=!0,this._paused=!1,this._driver=t};y5.inherits(g4,M5);g4.prototype.pause=function(){this._driver.io._paused=!0};g4.prototype.resume=function(){this._driver.io._paused=!1,this._driver.io.emit("drain")};g4.prototype.write=function(t){return this.writable?(typeof t=="string"?this._driver.text(t):this._driver.binary(t),!this._paused):!1};g4.prototype.end=function(t){t!==void 0&&this.write(t)};g4.prototype.destroy=function(){};t6.IO=p4;t6.Messages=g4});var n3=E((cm,C5)=>{"use strict";var j4=function(){this.clear()};j4.prototype.ALLOWED_DUPLICATES=["set-cookie","set-cookie2","warning","www-authenticate"];j4.prototype.clear=function(){this._sent={},this._lines=[]};j4.prototype.set=function(t,e){if(e!==void 0){t=this._strip(t),e=this._strip(e);var n=t.toLowerCase();(!this._sent.hasOwnProperty(n)||this.ALLOWED_DUPLICATES.indexOf(n)>=0)&&(this._sent[n]=!0,this._lines.push(t+": "+e+`\r
`))}};j4.prototype.toString=function(){return this._lines.join("")};j4.prototype._strip=function(t){return t.toString().replace(/^ */,"").replace(/ *$/,"")};C5.exports=j4});var E5=E((om,V5)=>{"use strict";var i3=x1().Buffer,s3=function(){this._queue=[],this._queueSize=0,this._offset=0};s3.prototype.put=function(t){!t||t.length===0||(i3.isBuffer(t)||(t=i3.from(t)),this._queue.push(t),this._queueSize+=t.length)};s3.prototype.read=function(t){if(t>this._queueSize)return null;if(t===0)return i3.alloc(0);this._queueSize-=t;var e=this._queue,n=t,i=e[0],s,c;if(i.length>=t)return i.length===t?e.shift():(c=i.slice(0,t),e[0]=i.slice(t),c);for(var o=0,r=e.length;o<r&&!(n<e[o].length);o++)n-=e[o].length;return s=e.splice(0,o),n>0&&e.length>0&&(s.push(e[0].slice(0,n)),e[0]=e[0].slice(n)),i3.concat(s,t)};s3.prototype.eachByte=function(t,e){for(var n,i,s;this._queue.length>0;){for(n=this._queue[0],i=n.length;this._offset<i;)s=this._offset,this._offset+=1,t.call(e,n[s]);this._offset=0,this._queue.shift()}};V5.exports=s3});var X1=E((rm,A5)=>{"use strict";var H5=x1().Buffer,T5=S("events").EventEmitter,ka=S("util"),x5=b5(),L5=n3(),Ba=E5(),Y=function(t,e,n){T5.call(this),Y.validateOptions(n||{},["maxLength","masking","requireMasking","protocols"]),this._request=t,this._reader=new Ba,this._options=n||{},this._maxLength=this._options.maxLength||this.MAX_LENGTH,this._headers=new L5,this.__queue=[],this.readyState=0,this.url=e,this.io=new x5.IO(this),this.messages=new x5.Messages(this),this._bindEventListeners()};ka.inherits(Y,T5);Y.isWebSocket=function(t){var e=t.headers.connection||"",n=t.headers.upgrade||"";return t.method==="GET"&&e.toLowerCase().split(/ *, */).indexOf("upgrade")>=0&&n.toLowerCase()==="websocket"};Y.validateOptions=function(t,e){for(var n in t)if(e.indexOf(n)<0)throw new Error("Unrecognized option: "+n)};var S5={MAX_LENGTH:67108863,STATES:["connecting","open","closing","closed"],_bindEventListeners:function(){var t=this;this.messages.on("error",function(){}),this.on("message",function(e){var n=t.messages;n.readable&&n.emit("data",e.data)}),this.on("error",function(e){var n=t.messages;n.readable&&n.emit("error",e)}),this.on("close",function(){var e=t.messages;e.readable&&(e.readable=e.writable=!1,e.emit("end"))})},getState:function(){return this.STATES[this.readyState]||null},addExtension:function(t){return!1},setHeader:function(t,e){return this.readyState>0?!1:(this._headers.set(t,e),!0)},start:function(){if(this.readyState!==0)return!1;if(!Y.isWebSocket(this._request))return this._failHandshake(new Error("Not a WebSocket request"));var t;try{t=this._handshakeResponse()}catch(e){return this._failHandshake(e)}return this._write(t),this._stage!==-1&&this._open(),!0},_failHandshake:function(t){var e=new L5;return e.set("Content-Type","text/plain"),e.set("Content-Length",H5.byteLength(t.message,"utf8")),e=["HTTP/1.1 400 Bad Request",e.toString(),t.message],this._write(H5.from(e.join(`\r
`),"utf8")),this._fail("protocol_error",t.message),!1},text:function(t){return this.frame(t)},binary:function(t){return!1},ping:function(){return!1},pong:function(){return!1},close:function(t,e){return this.readyState!==1?!1:(this.readyState=3,this.emit("close",new Y.CloseEvent(null,null)),!0)},_open:function(){this.readyState=1,this.__queue.forEach(function(t){this.frame.apply(this,t)},this),this.__queue=[],this.emit("open",new Y.OpenEvent)},_queue:function(t){return this.__queue.push(t),!0},_write:function(t){var e=this.io;e.readable&&e.emit("data",t)},_fail:function(t,e){this.readyState=2,this.emit("error",new Error(e)),this.close()}};for(n6 in S5)Y.prototype[n6]=S5[n6];var n6;Y.ConnectEvent=function(){};Y.OpenEvent=function(){};Y.CloseEvent=function(t,e){this.code=t,this.reason=e};Y.MessageEvent=function(t){this.data=t};Y.PingEvent=function(t){this.data=t};Y.PongEvent=function(t){this.data=t};A5.exports=Y});var D5=E(o6=>{"use strict";var s6=S("assert");o6.HTTPParser=p;function p(t){s6.ok(t===p.REQUEST||t===p.RESPONSE||t===void 0),t===void 0||this.initialize(t),this.maxHeaderSize=p.maxHeaderSize}p.prototype.initialize=function(t,e){s6.ok(t===p.REQUEST||t===p.RESPONSE),this.type=t,this.state=t+"_LINE",this.info={headers:[],upgrade:!1},this.trailers=[],this.line="",this.isChunked=!1,this.connection="",this.headerSize=0,this.body_bytes=null,this.isUserCall=!1,this.hadError=!1};p.encoding="ascii";p.maxHeaderSize=80*1024;p.REQUEST="REQUEST";p.RESPONSE="RESPONSE";var O5=p.kOnHeaders=1,i6=p.kOnHeadersComplete=2,c3=p.kOnBody=3,c6=p.kOnMessageComplete=4;p.prototype[O5]=p.prototype[i6]=p.prototype[c3]=p.prototype[c6]=function(){};var I5=!0;Object.defineProperty(p,"kOnExecute",{get:function(){return I5=!1,99}});var k5=o6.methods=p.methods=["DELETE","GET","HEAD","POST","PUT","CONNECT","OPTIONS","TRACE","COPY","LOCK","MKCOL","MOVE","PROPFIND","PROPPATCH","SEARCH","UNLOCK","BIND","REBIND","UNBIND","ACL","REPORT","MKACTIVITY","CHECKOUT","MERGE","M-SEARCH","NOTIFY","SUBSCRIBE","UNSUBSCRIBE","PATCH","PURGE","MKCALENDAR","LINK","UNLINK","SOURCE"],B5=k5.indexOf("CONNECT");p.prototype.reinitialize=p;p.prototype.close=p.prototype.pause=p.prototype.resume=p.prototype.free=function(){};p.prototype._compatMode0_11=!1;p.prototype.getAsyncId=function(){return 0};var Da={REQUEST_LINE:!0,RESPONSE_LINE:!0,HEADER:!0};p.prototype.execute=function(t,e,n){if(!(this instanceof p))throw new TypeError("not a HTTPParser");e=e||0,n=typeof n=="number"?n:t.length,this.chunk=t,this.offset=e;var i=this.end=e+n;try{for(;this.offset<i&&!this[this.state](););}catch(s){if(this.isUserCall)throw s;return this.hadError=!0,s}return this.chunk=null,n=this.offset-e,Da[this.state]&&(this.headerSize+=n,this.headerSize>(this.maxHeaderSize||p.maxHeaderSize))?new Error("max header size exceeded"):n};var Ra={REQUEST_LINE:!0,RESPONSE_LINE:!0,BODY_RAW:!0};p.prototype.finish=function(){if(!this.hadError){if(!Ra[this.state])return new Error("invalid state for EOF");this.state==="BODY_RAW"&&this.userCall()(this[c6]())}};p.prototype.consume=p.prototype.unconsume=p.prototype.getCurrentBuffer=function(){};p.prototype.userCall=function(){this.isUserCall=!0;var t=this;return function(e){return t.isUserCall=!1,e}};p.prototype.nextRequest=function(){this.userCall()(this[c6]()),this.reinitialize(this.type)};p.prototype.consumeLine=function(){for(var t=this.end,e=this.chunk,n=this.offset;n<t;n++)if(e[n]===10){var i=this.line+e.toString(p.encoding,this.offset,n);return i.charAt(i.length-1)==="\r"&&(i=i.substr(0,i.length-1)),this.line="",this.offset=n+1,i}this.line+=e.toString(p.encoding,this.offset,this.end),this.offset=this.end};var Fa=/^([^: \t]+):[ \t]*((?:.*[^ \t])|)/,Na=/^[ \t]+(.*[^ \t])/;p.prototype.parseHeader=function(t,e){if(t.indexOf("\r")!==-1)throw o3("HPE_LF_EXPECTED");var n=Fa.exec(t),i=n&&n[1];if(i)e.push(i),e.push(n[2]);else{var s=Na.exec(t);s&&e.length&&(e[e.length-1]&&(e[e.length-1]+=" "),e[e.length-1]+=s[1])}};var Pa=/^([A-Z-]+) ([^ ]+) HTTP\/(\d)\.(\d)$/;p.prototype.REQUEST_LINE=function(){var t=this.consumeLine();if(t){var e=Pa.exec(t);if(e===null)throw o3("HPE_INVALID_CONSTANT");if(this.info.method=this._compatMode0_11?e[1]:k5.indexOf(e[1]),this.info.method===-1)throw new Error("invalid request method");this.info.url=e[2],this.info.versionMajor=+e[3],this.info.versionMinor=+e[4],this.body_bytes=0,this.state="HEADER"}};var qa=/^HTTP\/(\d)\.(\d) (\d{3}) ?(.*)$/;p.prototype.RESPONSE_LINE=function(){var t=this.consumeLine();if(t){var e=qa.exec(t);if(e===null)throw o3("HPE_INVALID_CONSTANT");this.info.versionMajor=+e[1],this.info.versionMinor=+e[2];var n=this.info.statusCode=+e[3];this.info.statusMessage=e[4],((n/100|0)===1||n===204||n===304)&&(this.body_bytes=0),this.state="HEADER"}};p.prototype.shouldKeepAlive=function(){if(this.info.versionMajor>0&&this.info.versionMinor>0){if(this.connection.indexOf("close")!==-1)return!1}else if(this.connection.indexOf("keep-alive")===-1)return!1;return!!(this.body_bytes!==null||this.isChunked)};p.prototype.HEADER=function(){var t=this.consumeLine();if(t!==void 0){var e=this.info;if(t)this.parseHeader(t,e.headers);else{for(var n=e.headers,i=!1,s,c=!1,o=0;o<n.length;o+=2)switch(n[o].toLowerCase()){case"transfer-encoding":this.isChunked=n[o+1].toLowerCase()==="chunked";break;case"content-length":if(s=+n[o+1],i){if(s!==this.body_bytes)throw o3("HPE_UNEXPECTED_CONTENT_LENGTH")}else i=!0,this.body_bytes=s;break;case"connection":this.connection+=n[o+1].toLowerCase();break;case"upgrade":c=!0;break}this.isChunked&&i&&(i=!1,this.body_bytes=null),c&&this.connection.indexOf("upgrade")!=-1?e.upgrade=this.type===p.REQUEST||e.statusCode===101:e.upgrade=e.method===B5,this.isChunked&&e.upgrade&&(this.isChunked=!1),e.shouldKeepAlive=this.shouldKeepAlive();var r;if(I5?r=this.userCall()(this[i6](e)):r=this.userCall()(this[i6](e.versionMajor,e.versionMinor,e.headers,e.method,e.url,e.statusCode,e.statusMessage,e.upgrade,e.shouldKeepAlive)),r===2)return this.nextRequest(),!0;if(this.isChunked&&!r)this.state="BODY_CHUNKHEAD";else{if(r||this.body_bytes===0)return this.nextRequest(),e.upgrade;this.body_bytes===null?this.state="BODY_RAW":this.state="BODY_SIZED"}}}};p.prototype.BODY_CHUNKHEAD=function(){var t=this.consumeLine();t!==void 0&&(this.body_bytes=parseInt(t,16),this.body_bytes?this.state="BODY_CHUNK":this.state="BODY_CHUNKTRAILERS")};p.prototype.BODY_CHUNK=function(){var t=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[c3](this.chunk,this.offset,t)),this.offset+=t,this.body_bytes-=t,this.body_bytes||(this.state="BODY_CHUNKEMPTYLINE")};p.prototype.BODY_CHUNKEMPTYLINE=function(){var t=this.consumeLine();t!==void 0&&(s6.equal(t,""),this.state="BODY_CHUNKHEAD")};p.prototype.BODY_CHUNKTRAILERS=function(){var t=this.consumeLine();t!==void 0&&(t?this.parseHeader(t,this.trailers):(this.trailers.length&&this.userCall()(this[O5](this.trailers,"")),this.nextRequest()))};p.prototype.BODY_RAW=function(){var t=this.end-this.offset;this.userCall()(this[c3](this.chunk,this.offset,t)),this.offset=this.end};p.prototype.BODY_SIZED=function(){var t=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[c3](this.chunk,this.offset,t)),this.offset+=t,this.body_bytes-=t,this.body_bytes||this.nextRequest()};["Headers","HeadersComplete","Body","MessageComplete"].forEach(function(t){var e=p["kOn"+t];Object.defineProperty(p.prototype,"on"+t,{get:function(){return this[e]},set:function(n){return this._compatMode0_11=!0,B5="CONNECT",this[e]=n}})});function o3(t){var e=new Error("Parse Error");return e.code=t,e}});var a3=E((lm,F5)=>{"use strict";var r3=D5().HTTPParser,Ua=x1().Buffer,ja={request:r3.REQUEST||"request",response:r3.RESPONSE||"response"},Q=function(t){this._type=t,this._parser=new r3(ja[t]),this._complete=!1,this.headers={};var e=null,n=this;this._parser.onHeaderField=function(i,s,c){e=i.toString("utf8",s,s+c).toLowerCase()},this._parser.onHeaderValue=function(i,s,c){var o=i.toString("utf8",s,s+c);n.headers.hasOwnProperty(e)?n.headers[e]+=", "+o:n.headers[e]=o},this._parser.onHeadersComplete=this._parser[r3.kOnHeadersComplete]=function(i,s,c,o,r,a){var l=arguments[0];if(typeof l=="object"&&(o=l.method,r=l.url,a=l.statusCode,c=l.headers),n.method=typeof o=="number"?Q.METHODS[o]:o,n.statusCode=a,n.url=r,!!c){for(var h=0,u=c.length,d,v;h<u;h+=2)d=c[h].toLowerCase(),v=c[h+1],n.headers.hasOwnProperty(d)?n.headers[d]+=", "+v:n.headers[d]=v;n._complete=!0}}};Q.METHODS={0:"DELETE",1:"GET",2:"HEAD",3:"POST",4:"PUT",5:"CONNECT",6:"OPTIONS",7:"TRACE",8:"COPY",9:"LOCK",10:"MKCOL",11:"MOVE",12:"PROPFIND",13:"PROPPATCH",14:"SEARCH",15:"UNLOCK",16:"BIND",17:"REBIND",18:"UNBIND",19:"ACL",20:"REPORT",21:"MKACTIVITY",22:"CHECKOUT",23:"MERGE",24:"M-SEARCH",25:"NOTIFY",26:"SUBSCRIBE",27:"UNSUBSCRIBE",28:"PATCH",29:"PURGE",30:"MKCALENDAR",31:"LINK",32:"UNLINK"};var R5=process.version?process.version.match(/[0-9]+/g).map(function(t){return parseInt(t,10)}):[];R5[0]===0&&R5[1]===12&&(Q.METHODS[16]="REPORT",Q.METHODS[17]="MKACTIVITY",Q.METHODS[18]="CHECKOUT",Q.METHODS[19]="MERGE",Q.METHODS[20]="M-SEARCH",Q.METHODS[21]="NOTIFY",Q.METHODS[22]="SUBSCRIBE",Q.METHODS[23]="UNSUBSCRIBE",Q.METHODS[24]="PATCH",Q.METHODS[25]="PURGE");Q.prototype.isComplete=function(){return this._complete};Q.prototype.parse=function(t){var e=this._parser.execute(t,0,t.length);if(typeof e!="number"){this.error=e,this._complete=!0;return}this._complete&&(this.body=e<t.length?t.slice(e):Ua.alloc(0))};F5.exports=Q});var q5=E((hm,P5)=>{"use strict";var r6=/([!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+)/,Wa=/([^!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z])/g,Ga=/"((?:\\[\x00-\x7f]|[^\x00-\x08\x0a-\x1f\x7f"\\])*)"/,a6=new RegExp(r6.source+"(?:=(?:"+r6.source+"|"+Ga.source+"))?"),l6=new RegExp(r6.source+"(?: *; *"+a6.source+")*","g"),$a=new RegExp("^"+l6.source+"(?: *, *"+l6.source+")*$"),Ka=/^-?(0|[1-9][0-9]*)(\.[0-9]+)?$/,N5=Object.prototype.hasOwnProperty,Ya={parseHeader:function(t){var e=new xe;if(t===""||t===void 0)return e;if(!$a.test(t))throw new SyntaxError("Invalid Sec-WebSocket-Extensions header: "+t);var n=t.match(l6);return n.forEach(function(i){var s=i.match(new RegExp(a6.source,"g")),c=s.shift(),o={};s.forEach(function(r){var a=r.match(a6),l=a[1],h;a[2]!==void 0?h=a[2]:a[3]!==void 0?h=a[3].replace(/\\/g,""):h=!0,Ka.test(h)&&(h=parseFloat(h)),N5.call(o,l)?(o[l]=[].concat(o[l]),o[l].push(h)):o[l]=h},this),e.push(c,o)},this),e},serializeParams:function(t,e){var n=[],i=function(c,o){o instanceof Array?o.forEach(function(r){i(c,r)}):o===!0?n.push(c):typeof o=="number"?n.push(c+"="+o):Wa.test(o)?n.push(c+'="'+o.replace(/"/g,'\\"')+'"'):n.push(c+"="+o)};for(var s in e)i(s,e[s]);return[t].concat(n).join("; ")}},xe=function(){this._byName={},this._inOrder=[]};xe.prototype.push=function(t,e){N5.call(this._byName,t)||(this._byName[t]=[]),this._byName[t].push(e),this._inOrder.push({name:t,params:e})};xe.prototype.eachOffer=function(t,e){for(var n=this._inOrder,i=0,s=n.length;i<s;i++)t.call(e,n[i].name,n[i].params)};xe.prototype.byName=function(t){return this._byName[t]||[]};xe.prototype.toArray=function(){return this._inOrder.slice()};P5.exports=Ya});var h6=E((um,U5)=>{"use strict";var Se=function(t){this._bufferSize=t,this.clear()};Se.prototype.clear=function(){this._buffer=new Array(this._bufferSize),this._ringOffset=0,this._ringSize=this._bufferSize,this._head=0,this._tail=0,this.length=0};Se.prototype.push=function(t){var e=!1,n=!1;this._ringSize<this._bufferSize?e=this._tail===0:this._ringOffset===this._ringSize&&(e=!0,n=this._tail===0),e&&(this._tail=this._bufferSize,this._buffer=this._buffer.concat(new Array(this._bufferSize)),this._bufferSize=this._buffer.length,n&&(this._ringSize=this._bufferSize)),this._buffer[this._tail]=t,this.length+=1,this._tail<this._ringSize&&(this._ringOffset+=1),this._tail=(this._tail+1)%this._bufferSize};Se.prototype.peek=function(){if(this.length!==0)return this._buffer[this._head]};Se.prototype.shift=function(){if(this.length!==0){var t=this._buffer[this._head];return this._buffer[this._head]=void 0,this.length-=1,this._ringOffset-=1,this._ringOffset===0&&this.length>0?(this._head=this._ringSize,this._ringOffset=this.length,this._ringSize=this._bufferSize):this._head=(this._head+1)%this._ringSize,t}};U5.exports=Se});var W5=E((dm,j5)=>{"use strict";var Qa=h6(),W4=function(t,e){this._session=t,this._method=e,this._queue=new Qa(W4.QUEUE_SIZE),this._stopped=!1,this.pending=0};W4.QUEUE_SIZE=8;W4.prototype.call=function(t,e,n,i){if(!this._stopped){var s={error:t,message:e,callback:n,context:i,done:!1},c=!1,o=this;if(this._queue.push(s),s.error)return s.done=!0,this._stop(),this._flushQueue();var r=function(a,l){c^(c=!0)&&(a?(o._stop(),s.error=a,s.message=null):s.message=l,s.done=!0,o._flushQueue())};try{this._session[this._method](e,r)}catch(a){r(a)}}};W4.prototype._stop=function(){this.pending=this._queue.length,this._stopped=!0};W4.prototype._flushQueue=function(){for(var t=this._queue,e;t.length>0&&t.peek().done;)e=t.shift(),e.error?(this.pending=0,t.clear()):this.pending-=1,e.callback.call(e.context,e.error,e.message)};j5.exports=W4});var u6=E((fm,G5)=>{"use strict";var Za=h6(),_4=function(){this._complete=!1,this._callbacks=new Za(_4.QUEUE_SIZE)};_4.QUEUE_SIZE=4;_4.all=function(t){var e=new _4,n=t.length,i=n;for(n===0&&e.done();i--;)t[i].then(function(){n-=1,n===0&&e.done()});return e};_4.prototype.then=function(t){this._complete?t():this._callbacks.push(t)};_4.prototype.done=function(){this._complete=!0;for(var t=this._callbacks,e;e=t.shift();)e()};G5.exports=_4});var Y5=E((vm,K5)=>{"use strict";var $5=W5(),Xa=u6(),z4=function(t){this._ext=t[0],this._session=t[1],this._functors={incoming:new $5(this._session,"processIncomingMessage"),outgoing:new $5(this._session,"processOutgoingMessage")}};z4.prototype.pending=function(t){var e=this._functors[t];e._stopped||(e.pending+=1)};z4.prototype.incoming=function(t,e,n,i){this._exec("incoming",t,e,n,i)};z4.prototype.outgoing=function(t,e,n,i){this._exec("outgoing",t,e,n,i)};z4.prototype.close=function(){return this._closed=this._closed||new Xa,this._doClose(),this._closed};z4.prototype._exec=function(t,e,n,i,s){this._functors[t].call(e,n,function(c,o){c&&(c.message=this._ext.name+": "+c.message),i.call(s,c,o),this._doClose()},this)};z4.prototype._doClose=function(){var t=this._functors.incoming,e=this._functors.outgoing;!this._closed||t.pending+e.pending!==0||(this._session&&this._session.close(),this._session=null,this._closed.done())};K5.exports=z4});var Z5=E((mm,Q5)=>{"use strict";var Ja=Y5(),el=u6(),Te=function(t){this._cells=t.map(function(e){return new Ja(e)}),this._stopped={incoming:!1,outgoing:!1}};Te.prototype.processIncomingMessage=function(t,e,n){this._stopped.incoming||this._loop("incoming",this._cells.length-1,-1,-1,t,e,n)};Te.prototype.processOutgoingMessage=function(t,e,n){this._stopped.outgoing||this._loop("outgoing",0,this._cells.length,1,t,e,n)};Te.prototype.close=function(t,e){this._stopped={incoming:!0,outgoing:!0};var n=this._cells.map(function(i){return i.close()});t&&el.all(n).then(function(){t.call(e)})};Te.prototype._loop=function(t,e,n,i,s,c,o){for(var r=this._cells,a=r.length,l=this;a--;)r[a].pending(t);var h=function(u,d,v){if(u===n)return c.call(o,d,v);r[u][t](d,v,function(m,w){m&&(l._stopped[t]=!0),h(u+i,m,w)})};h(e,null,s)};Q5.exports=Te});var ts=E((pm,es)=>{"use strict";var Le=q5(),X5=Z5(),l3=function(){this._rsv1=this._rsv2=this._rsv3=null,this._byName={},this._inOrder=[],this._sessions=[],this._index={}};l3.MESSAGE_OPCODES=[1,2];var J5={add:function(t){if(typeof t.name!="string")throw new TypeError("extension.name must be a string");if(t.type!=="permessage")throw new TypeError('extension.type must be "permessage"');if(typeof t.rsv1!="boolean")throw new TypeError("extension.rsv1 must be true or false");if(typeof t.rsv2!="boolean")throw new TypeError("extension.rsv2 must be true or false");if(typeof t.rsv3!="boolean")throw new TypeError("extension.rsv3 must be true or false");if(this._byName.hasOwnProperty(t.name))throw new TypeError('An extension with name "'+t.name+'" is already registered');this._byName[t.name]=t,this._inOrder.push(t)},generateOffer:function(){var t=[],e=[],n={};return this._inOrder.forEach(function(i){var s=i.createClientSession();if(s){var c=[i,s];t.push(c),n[i.name]=c;var o=s.generateOffer();o=o?[].concat(o):[],o.forEach(function(r){e.push(Le.serializeParams(i.name,r))},this)}},this),this._sessions=t,this._index=n,e.length>0?e.join(", "):null},activate:function(t){var e=Le.parseHeader(t),n=[];e.eachOffer(function(i,s){var c=this._index[i];if(!c)throw new Error('Server sent an extension response for unknown extension "'+i+'"');var o=c[0],r=c[1],a=this._reserved(o);if(a)throw new Error("Server sent two extension responses that use the RSV"+a[0]+' bit: "'+a[1]+'" and "'+o.name+'"');if(r.activate(s)!==!0)throw new Error("Server sent unacceptable extension parameters: "+Le.serializeParams(i,s));this._reserve(o),n.push(c)},this),this._sessions=n,this._pipeline=new X5(n)},generateResponse:function(t){var e=[],n=[],i=Le.parseHeader(t);return this._inOrder.forEach(function(s){var c=i.byName(s.name);if(!(c.length===0||this._reserved(s))){var o=s.createServerSession(c);o&&(this._reserve(s),e.push([s,o]),n.push(Le.serializeParams(s.name,o.generateResponse())))}},this),this._sessions=e,this._pipeline=new X5(e),n.length>0?n.join(", "):null},validFrameRsv:function(t){var e={rsv1:!1,rsv2:!1,rsv3:!1},n;if(l3.MESSAGE_OPCODES.indexOf(t.opcode)>=0)for(var i=0,s=this._sessions.length;i<s;i++)n=this._sessions[i][0],e.rsv1=e.rsv1||n.rsv1,e.rsv2=e.rsv2||n.rsv2,e.rsv3=e.rsv3||n.rsv3;return(e.rsv1||!t.rsv1)&&(e.rsv2||!t.rsv2)&&(e.rsv3||!t.rsv3)},processIncomingMessage:function(t,e,n){this._pipeline.processIncomingMessage(t,e,n)},processOutgoingMessage:function(t,e,n){this._pipeline.processOutgoingMessage(t,e,n)},close:function(t,e){if(!this._pipeline)return t.call(e);this._pipeline.close(t,e)},_reserve:function(t){this._rsv1=this._rsv1||t.rsv1&&t.name,this._rsv2=this._rsv2||t.rsv2&&t.name,this._rsv3=this._rsv3||t.rsv3&&t.name},_reserved:function(t){return this._rsv1&&t.rsv1?[1,this._rsv1]:this._rsv2&&t.rsv2?[2,this._rsv2]:this._rsv3&&t.rsv3?[3,this._rsv3]:!1}};for(d6 in J5)l3.prototype[d6]=J5[d6];var d6;es.exports=l3});var cs=E((gm,ss)=>{"use strict";var is=function(){},ns={final:!1,rsv1:!1,rsv2:!1,rsv3:!1,opcode:null,masked:!1,maskingKey:null,lengthBytes:1,length:0,payload:null};for(f6 in ns)is.prototype[f6]=ns[f6];var f6;ss.exports=is});var ls=E((_m,as)=>{"use strict";var tl=x1().Buffer,rs=function(){this.rsv1=!1,this.rsv2=!1,this.rsv3=!1,this.opcode=null,this.length=0,this._chunks=[]},os={read:function(){return this.data=this.data||tl.concat(this._chunks,this.length)},pushFrame:function(t){this.rsv1=this.rsv1||t.rsv1,this.rsv2=this.rsv2||t.rsv2,this.rsv3=this.rsv3||t.rsv3,this.opcode===null&&(this.opcode=t.opcode),this._chunks.push(t.payload),this.length+=t.length}};for(v6 in os)rs.prototype[v6]=os[v6];var v6;as.exports=rs});var p6=E((zm,vs)=>{"use strict";var Ae=x1().Buffer,fs=S("crypto"),nl=S("util"),il=ts(),w4=X1(),hs=cs(),us=ls(),a1=function(t,e,n){if(w4.apply(this,arguments),this._extensions=new il,this._stage=0,this._masking=this._options.masking,this._protocols=this._options.protocols||[],this._requireMasking=this._options.requireMasking,this._pingCallbacks={},typeof this._protocols=="string"&&(this._protocols=this._protocols.split(/ *, */)),!!this._request){var i=this._request.headers["sec-websocket-protocol"],s=this._protocols;i!==void 0&&(typeof i=="string"&&(i=i.split(/ *, */)),this.protocol=i.filter(function(c){return s.indexOf(c)>=0})[0]),this.version="hybi-"+a1.VERSION}};nl.inherits(a1,w4);a1.VERSION="13";a1.mask=function(t,e,n){if(!e||e.length===0)return t;n=n||0;for(var i=0,s=t.length-n;i<s;i++)t[n+i]=t[n+i]^e[i%4];return t};a1.generateAccept=function(t){var e=fs.createHash("sha1");return e.update(t+a1.GUID),e.digest("base64")};a1.GUID="258EAFA5-E914-47DA-95CA-C5AB0DC85B11";var ds={FIN:128,MASK:128,RSV1:64,RSV2:32,RSV3:16,OPCODE:15,LENGTH:127,OPCODES:{continuation:0,text:1,binary:2,close:8,ping:9,pong:10},OPCODE_CODES:[0,1,2,8,9,10],MESSAGE_OPCODES:[0,1,2],OPENING_OPCODES:[1,2],ERRORS:{normal_closure:1e3,going_away:1001,protocol_error:1002,unacceptable:1003,encoding_error:1007,policy_violation:1008,too_large:1009,extension_error:1010,unexpected_condition:1011},ERROR_CODES:[1e3,1001,1002,1003,1007,1008,1009,1010,1011],DEFAULT_ERROR_CODE:1e3,MIN_RESERVED_ERROR:3e3,MAX_RESERVED_ERROR:4999,UTF8_MATCH:/^([\x00-\x7F]|[\xC2-\xDF][\x80-\xBF]|\xE0[\xA0-\xBF][\x80-\xBF]|[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}|\xED[\x80-\x9F][\x80-\xBF]|\xF0[\x90-\xBF][\x80-\xBF]{2}|[\xF1-\xF3][\x80-\xBF]{3}|\xF4[\x80-\x8F][\x80-\xBF]{2})*$/,addExtension:function(t){return this._extensions.add(t),!0},parse:function(t){this._reader.put(t);for(var e=!0;e;)switch(this._stage){case 0:e=this._reader.read(1),e&&this._parseOpcode(e[0]);break;case 1:e=this._reader.read(1),e&&this._parseLength(e[0]);break;case 2:e=this._reader.read(this._frame.lengthBytes),e&&this._parseExtendedLength(e);break;case 3:e=this._reader.read(4),e&&(this._stage=4,this._frame.maskingKey=e);break;case 4:e=this._reader.read(this._frame.length),e&&(this._stage=0,this._emitFrame(e));break;default:e=null}},text:function(t){return this.readyState>1?!1:this.frame(t,"text")},binary:function(t){return this.readyState>1?!1:this.frame(t,"binary")},ping:function(t,e){return this.readyState>1?!1:(t=t||"",e&&(this._pingCallbacks[t]=e),this.frame(t,"ping"))},pong:function(t){return this.readyState>1?!1:(t=t||"",this.frame(t,"pong"))},close:function(t,e){return t=t||"",e=e||this.ERRORS.normal_closure,this.readyState<=0?(this.readyState=3,this.emit("close",new w4.CloseEvent(e,t)),!0):this.readyState===1?(this.readyState=2,this._extensions.close(function(){this.frame(t,"close",e)},this),!0):!1},frame:function(t,e,n){if(this.readyState<=0)return this._queue([t,e,n]);if(this.readyState>2)return!1;t instanceof Array&&(t=Ae.from(t)),typeof t=="number"&&(t=t.toString());var i=new us,s=typeof t=="string",c,o;i.rsv1=i.rsv2=i.rsv3=!1,i.opcode=this.OPCODES[e||(s?"text":"binary")],c=s?Ae.from(t,"utf8"):t,n&&(o=c,c=Ae.allocUnsafe(2+o.length),c.writeUInt16BE(n,0),o.copy(c,2)),i.data=c;var r=function(a){var l=new hs;l.final=!0,l.rsv1=a.rsv1,l.rsv2=a.rsv2,l.rsv3=a.rsv3,l.opcode=a.opcode,l.masked=!!this._masking,l.length=a.data.length,l.payload=a.data,l.masked&&(l.maskingKey=fs.randomBytes(4)),this._sendFrame(l)};return this.MESSAGE_OPCODES.indexOf(i.opcode)>=0?this._extensions.processOutgoingMessage(i,function(a,l){if(a)return this._fail("extension_error",a.message);r.call(this,l)},this):r.call(this,i),!0},_sendFrame:function(t){var e=t.length,n=e<=125?2:e<=65535?4:10,i=n+(t.masked?4:0),s=Ae.allocUnsafe(i+e),c=t.masked?this.MASK:0;s[0]=(t.final?this.FIN:0)|(t.rsv1?this.RSV1:0)|(t.rsv2?this.RSV2:0)|(t.rsv3?this.RSV3:0)|t.opcode,e<=125?s[1]=c|e:e<=65535?(s[1]=c|126,s.writeUInt16BE(e,2)):(s[1]=c|127,s.writeUInt32BE(Math.floor(e/4294967296),2),s.writeUInt32BE(e%4294967296,6)),t.payload.copy(s,i),t.masked&&(t.maskingKey.copy(s,n),a1.mask(s,t.maskingKey,i)),this._write(s)},_handshakeResponse:function(){var t=this._request.headers["sec-websocket-key"],e=this._request.headers["sec-websocket-version"];if(e!==a1.VERSION)throw new Error("Unsupported WebSocket version: "+e);if(typeof t!="string")throw new Error("Missing handshake request header: Sec-WebSocket-Key");this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Accept",a1.generateAccept(t)),this.protocol&&this._headers.set("Sec-WebSocket-Protocol",this.protocol);var n=this._extensions.generateResponse(this._request.headers["sec-websocket-extensions"]);n&&this._headers.set("Sec-WebSocket-Extensions",n);var i="HTTP/1.1 101 Switching Protocols",s=[i,this._headers.toString(),""];return Ae.from(s.join(`\r
`),"utf8")},_shutdown:function(t,e,n){delete this._frame,delete this._message,this._stage=5;var i=this.readyState===1;this.readyState=2,this._extensions.close(function(){i&&this.frame(e,"close",t),this.readyState=3,n&&this.emit("error",new Error(e)),this.emit("close",new w4.CloseEvent(t,e))},this)},_fail:function(t,e){this.readyState>1||this._shutdown(this.ERRORS[t],e,!0)},_parseOpcode:function(t){var e=[this.RSV1,this.RSV2,this.RSV3].map(function(i){return(t&i)===i}),n=this._frame=new hs;if(n.final=(t&this.FIN)===this.FIN,n.rsv1=e[0],n.rsv2=e[1],n.rsv3=e[2],n.opcode=t&this.OPCODE,this._stage=1,!this._extensions.validFrameRsv(n))return this._fail("protocol_error","One or more reserved bits are on: reserved1 = "+(n.rsv1?1:0)+", reserved2 = "+(n.rsv2?1:0)+", reserved3 = "+(n.rsv3?1:0));if(this.OPCODE_CODES.indexOf(n.opcode)<0)return this._fail("protocol_error","Unrecognized frame opcode: "+n.opcode);if(this.MESSAGE_OPCODES.indexOf(n.opcode)<0&&!n.final)return this._fail("protocol_error","Received fragmented control frame: opcode = "+n.opcode);if(this._message&&this.OPENING_OPCODES.indexOf(n.opcode)>=0)return this._fail("protocol_error","Received new data frame but previous continuous frame is unfinished")},_parseLength:function(t){var e=this._frame;if(e.masked=(t&this.MASK)===this.MASK,e.length=t&this.LENGTH,e.length>=0&&e.length<=125){if(this._stage=e.masked?3:4,!this._checkFrameLength())return}else this._stage=2,e.lengthBytes=e.length===126?2:8;if(this._requireMasking&&!e.masked)return this._fail("unacceptable","Received unmasked frame but masking is required")},_parseExtendedLength:function(t){var e=this._frame;if(e.length=this._readUInt(t),this._stage=e.masked?3:4,this.MESSAGE_OPCODES.indexOf(e.opcode)<0&&e.length>125)return this._fail("protocol_error","Received control frame having too long payload: "+e.length);this._checkFrameLength()},_checkFrameLength:function(){var t=this._message?this._message.length:0;return t+this._frame.length>this._maxLength?(this._fail("too_large","WebSocket frame length too large"),!1):!0},_emitFrame:function(t){var e=this._frame,n=e.payload=a1.mask(t,e.maskingKey),i=e.opcode,s,c,o,r,a;if(delete this._frame,i===this.OPCODES.continuation){if(!this._message)return this._fail("protocol_error","Received unexpected continuation frame");this._message.pushFrame(e)}if((i===this.OPCODES.text||i===this.OPCODES.binary)&&(this._message=new us,this._message.pushFrame(e)),e.final&&this.MESSAGE_OPCODES.indexOf(i)>=0)return this._emitMessage(this._message);i===this.OPCODES.close&&(c=n.length>=2?n.readUInt16BE(0):null,o=n.length>2?this._encode(n.slice(2)):null,n.length!==0&&!(c!==null&&c>=this.MIN_RESERVED_ERROR&&c<=this.MAX_RESERVED_ERROR)&&this.ERROR_CODES.indexOf(c)<0&&(c=this.ERRORS.protocol_error),(n.length>125||n.length>2&&!o)&&(c=this.ERRORS.protocol_error),this._shutdown(c||this.DEFAULT_ERROR_CODE,o||"")),i===this.OPCODES.ping&&(this.frame(n,"pong"),this.emit("ping",new w4.PingEvent(n.toString()))),i===this.OPCODES.pong&&(r=this._pingCallbacks,s=this._encode(n),a=r[s],delete r[s],a&&a(),this.emit("pong",new w4.PongEvent(n.toString())))},_emitMessage:function(e){var e=this._message;e.read(),delete this._message,this._extensions.processIncomingMessage(e,function(n,i){if(n)return this._fail("extension_error",n.message);var s=i.data;if(i.opcode===this.OPCODES.text&&(s=this._encode(s)),s===null)return this._fail("encoding_error","Could not decode a text frame as UTF-8");this.emit("message",new w4.MessageEvent(s))},this)},_encode:function(t){try{var e=t.toString("binary",0,t.length);if(!this.UTF8_MATCH.test(e))return null}catch{}return t.toString("utf8",0,t.length)},_readUInt:function(t){return t.length===2?t.readUInt16BE(0):t.readUInt32BE(0)*4294967296+t.readUInt32BE(4)}};for(m6 in ds)a1.prototype[m6]=ds[m6];var m6;vs.exports=a1});var zs=E((wm,_s)=>{"use strict";var gs=x1().Buffer,sl=S("stream").Stream,ms=S("url"),cl=S("util"),ol=X1(),rl=n3(),al=a3(),ll={"ws:":80,"wss:":443},_6=function(t,e,n){this._client=t,this._http=new al("response"),this._origin=typeof t.url=="object"?t.url:ms.parse(t.url),this._url=typeof e=="object"?e:ms.parse(e),this._options=n||{},this._state=0,this.readable=this.writable=!0,this._paused=!1,this._headers=new rl,this._headers.set("Host",this._origin.host),this._headers.set("Connection","keep-alive"),this._headers.set("Proxy-Connection","keep-alive");var i=this._url.auth&&gs.from(this._url.auth,"utf8").toString("base64");i&&this._headers.set("Proxy-Authorization","Basic "+i)};cl.inherits(_6,sl);var ps={setHeader:function(t,e){return this._state!==0?!1:(this._headers.set(t,e),!0)},start:function(){if(this._state!==0)return!1;this._state=1;var t=this._origin,e=t.port||ll[t.protocol],n="CONNECT "+t.hostname+":"+e+" HTTP/1.1",i=[n,this._headers.toString(),""];return this.emit("data",gs.from(i.join(`\r
`),"utf8")),!0},pause:function(){this._paused=!0},resume:function(){this._paused=!1,this.emit("drain")},write:function(t){if(!this.writable)return!1;if(this._http.parse(t),!this._http.isComplete())return!this._paused;if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this.statusCode===200)this.emit("connect",new ol.ConnectEvent);else{var e="Can't establish a connection to the server at "+this._origin.href;this.emit("error",new Error(e))}return this.end(),!this._paused},end:function(t){this.writable&&(t!==void 0&&this.write(t),this.readable=this.writable=!1,this.emit("close"),this.emit("end"))},destroy:function(){this.end()}};for(g6 in ps)_6.prototype[g6]=ps[g6];var g6;_s.exports=_6});var bs=E((Mm,ys)=>{"use strict";var Ms=x1().Buffer,hl=S("crypto"),ul=S("url"),dl=S("util"),fl=a3(),vl=X1(),G4=p6(),ml=zs(),Oe=function(t,e){this.version="hybi-"+G4.VERSION,G4.call(this,null,t,e),this.readyState=-1,this._key=Oe.generateKey(),this._accept=G4.generateAccept(this._key),this._http=new fl("response");var n=ul.parse(this.url),i=n.auth&&Ms.from(n.auth,"utf8").toString("base64");if(this.VALID_PROTOCOLS.indexOf(n.protocol)<0)throw new Error(this.url+" is not a valid WebSocket URL");this._pathname=(n.pathname||"/")+(n.search||""),this._headers.set("Host",n.host),this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Key",this._key),this._headers.set("Sec-WebSocket-Version",G4.VERSION),this._protocols.length>0&&this._headers.set("Sec-WebSocket-Protocol",this._protocols.join(", ")),i&&this._headers.set("Authorization","Basic "+i)};dl.inherits(Oe,G4);Oe.generateKey=function(){return hl.randomBytes(16).toString("base64")};var ws={VALID_PROTOCOLS:["ws:","wss:"],proxy:function(t,e){return new ml(this,t,e)},start:function(){return this.readyState!==-1?!1:(this._write(this._handshakeRequest()),this.readyState=0,!0)},parse:function(t){if(this.readyState!==3){if(this.readyState>0)return G4.prototype.parse.call(this,t);this._http.parse(t),this._http.isComplete()&&(this._validateHandshake(),this.readyState!==3&&(this._open(),this.parse(this._http.body)))}},_handshakeRequest:function(){var t=this._extensions.generateOffer();t&&this._headers.set("Sec-WebSocket-Extensions",t);var e="GET "+this._pathname+" HTTP/1.1",n=[e,this._headers.toString(),""];return Ms.from(n.join(`\r
`),"utf8")},_failHandshake:function(t){t="Error during WebSocket handshake: "+t,this.readyState=3,this.emit("error",new Error(t)),this.emit("close",new vl.CloseEvent(this.ERRORS.protocol_error,t))},_validateHandshake:function(){if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this._http.error)return this._failHandshake(this._http.error.message);if(this._http.statusCode!==101)return this._failHandshake("Unexpected response code: "+this._http.statusCode);var t=this._http.headers,e=t.upgrade||"",n=t.connection||"",i=t["sec-websocket-accept"]||"",s=t["sec-websocket-protocol"]||"";if(e==="")return this._failHandshake("'Upgrade' header is missing");if(e.toLowerCase()!=="websocket")return this._failHandshake("'Upgrade' header value is not 'WebSocket'");if(n==="")return this._failHandshake("'Connection' header is missing");if(n.toLowerCase()!=="upgrade")return this._failHandshake("'Connection' header value is not 'Upgrade'");if(i!==this._accept)return this._failHandshake("Sec-WebSocket-Accept mismatch");if(this.protocol=null,s!==""){if(this._protocols.indexOf(s)<0)return this._failHandshake("Sec-WebSocket-Protocol mismatch");this.protocol=s}try{this._extensions.activate(this.headers["sec-websocket-extensions"])}catch(c){return this._failHandshake(c.message)}}};for(z6 in ws)Oe.prototype[z6]=ws[z6];var z6;ys.exports=Oe});var y6=E((ym,Vs)=>{"use strict";var h3=x1().Buffer,u3=X1(),pl=S("util"),M6=function(t,e,n){u3.apply(this,arguments),this._stage=0,this.version="hixie-75",this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("WebSocket-Origin",this._request.headers.origin),this._headers.set("WebSocket-Location",this.url)};pl.inherits(M6,u3);var Cs={close:function(){return this.readyState===3?!1:(this.readyState=3,this.emit("close",new u3.CloseEvent(null,null)),!0)},parse:function(t){this.readyState>1||(this._reader.put(t),this._reader.eachByte(function(e){var n;switch(this._stage){case-1:this._body.push(e),this._sendHandshakeBody();break;case 0:this._parseLeadingByte(e);break;case 1:if(this._length=(e&127)+128*this._length,this._closing&&this._length===0)return this.close();(e&128)!==128&&(this._length===0?this._stage=0:(this._skipped=0,this._stage=2));break;case 2:if(e===255)this._stage=0,n=h3.from(this._buffer).toString("utf8",0,this._buffer.length),this.emit("message",new u3.MessageEvent(n));else if(this._length)this._skipped+=1,this._skipped===this._length&&(this._stage=0);else if(this._buffer.push(e),this._buffer.length>this._maxLength)return this.close();break}},this))},frame:function(t){if(this.readyState===0)return this._queue([t]);if(this.readyState>1)return!1;typeof t!="string"&&(t=t.toString());var e=h3.byteLength(t),n=h3.allocUnsafe(e+2);return n[0]=0,n.write(t,1),n[n.length-1]=255,this._write(n),!0},_handshakeResponse:function(){var t="HTTP/1.1 101 Web Socket Protocol Handshake",e=[t,this._headers.toString(),""];return h3.from(e.join(`\r
`),"utf8")},_parseLeadingByte:function(t){(t&128)===128?(this._length=0,this._stage=1):(delete this._length,delete this._skipped,this._buffer=[],this._stage=2)}};for(w6 in Cs)M6.prototype[w6]=Cs[w6];var w6;Vs.exports=M6});var Ts=E((bm,Ss)=>{"use strict";var Ie=x1().Buffer,gl=X1(),d3=y6(),_l=S("crypto"),zl=S("util"),Es=function(t){return parseInt((t.match(/[0-9]/g)||[]).join(""),10)},Hs=function(t){return(t.match(/ /g)||[]).length},C6=function(t,e,n){d3.apply(this,arguments),this._stage=-1,this._body=[],this.version="hixie-76",this._headers.clear(),this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Origin",this._request.headers.origin),this._headers.set("Sec-WebSocket-Location",this.url)};zl.inherits(C6,d3);var xs={BODY_SIZE:8,start:function(){return d3.prototype.start.call(this)?(this._started=!0,this._sendHandshakeBody(),!0):!1},close:function(){return this.readyState===3?!1:(this.readyState===1&&this._write(Ie.from([255,0])),this.readyState=3,this.emit("close",new gl.CloseEvent(null,null)),!0)},_handshakeResponse:function(){var r=this._request.headers,t=r["sec-websocket-key1"],e=r["sec-websocket-key2"];if(!t)throw new Error("Missing required header: Sec-WebSocket-Key1");if(!e)throw new Error("Missing required header: Sec-WebSocket-Key2");var n=Es(t),i=Hs(t),s=Es(e),c=Hs(e);if(n%i!==0||s%c!==0)throw new Error("Client sent invalid Sec-WebSocket-Key headers");this._keyValues=[n/i,s/c];var o="HTTP/1.1 101 WebSocket Protocol Handshake",r=[o,this._headers.toString(),""];return Ie.from(r.join(`\r
`),"binary")},_handshakeSignature:function(){if(this._body.length<this.BODY_SIZE)return null;var t=_l.createHash("md5"),e=Ie.allocUnsafe(8+this.BODY_SIZE);return e.writeUInt32BE(this._keyValues[0],0),e.writeUInt32BE(this._keyValues[1],4),Ie.from(this._body).copy(e,8,0,this.BODY_SIZE),t.update(e),Ie.from(t.digest("binary"),"binary")},_sendHandshakeBody:function(){if(this._started){var t=this._handshakeSignature();t&&(this._write(t),this._stage=0,this._open(),this._body.length>this.BODY_SIZE&&this.parse(this._body.slice(this.BODY_SIZE)))}},_parseLeadingByte:function(t){if(t!==255)return d3.prototype._parseLeadingByte.call(this,t);this._closing=!0,this._length=0,this._stage=1}};for(b6 in xs)C6.prototype[b6]=xs[b6];var b6;Ss.exports=C6});var As=E((Cm,Ls)=>{"use strict";var wl=S("util"),Ml=a3(),H6=X1(),yl=y6(),bl=Ts(),Cl=p6(),M4=function(t){H6.call(this,null,null,t),this._http=new Ml("request")};wl.inherits(M4,H6);var E6={EVENTS:["open","message","error","close","ping","pong"],_bindEventListeners:function(){this.messages.on("error",function(){}),this.on("error",function(){})},parse:function(t){if(this._delegate)return this._delegate.parse(t);if(this._http.parse(t),!!this._http.isComplete()){this.method=this._http.method,this.url=this._http.url,this.headers=this._http.headers,this.body=this._http.body;var e=this;this._delegate=M4.http(this,this._options),this._delegate.messages=this.messages,this._delegate.io=this.io,this._open(),this.EVENTS.forEach(function(n){this._delegate.on(n,function(i){e.emit(n,i)})},this),this.protocol=this._delegate.protocol,this.version=this._delegate.version,this.parse(this._http.body),this.emit("connect",new H6.ConnectEvent)}},_open:function(){this.__queue.forEach(function(t){this._delegate[t[0]].apply(this._delegate,t[1])},this),this.__queue=[]}};["addExtension","setHeader","start","frame","text","binary","ping","close"].forEach(function(t){E6[t]=function(){return this._delegate?this._delegate[t].apply(this._delegate,arguments):(this.__queue.push([t,arguments]),!0)}});for(V6 in E6)M4.prototype[V6]=E6[V6];var V6;M4.isSecureRequest=function(t){if(t.connection&&t.connection.authorized!==void 0||t.socket&&t.socket.secure)return!0;var e=t.headers;return e?e.https==="on"||e["x-forwarded-ssl"]==="on"||e["x-forwarded-scheme"]==="https"||e["x-forwarded-proto"]==="https":!1};M4.determineUrl=function(t){var e=this.isSecureRequest(t)?"wss:":"ws:";return e+"//"+t.headers.host+t.url};M4.http=function(t,e){e=e||{},e.requireMasking===void 0&&(e.requireMasking=!0);var n=t.headers,i=n["sec-websocket-version"],s=n["sec-websocket-key"],c=n["sec-websocket-key1"],o=n["sec-websocket-key2"],r=this.determineUrl(t);return i||s?new Cl(t,r,e):c||o?new bl(t,r,e):new yl(t,r,e)};Ls.exports=M4});var ke=E((Vm,Is)=>{"use strict";var Os=X1(),Vl=bs(),f3=As(),El={client:function(t,e){return e=e||{},e.masking===void 0&&(e.masking=!0),new Vl(t,e)},server:function(t){return t=t||{},t.requireMasking===void 0&&(t.requireMasking=!0),new f3(t)},http:function(){return f3.http.apply(f3,arguments)},isSecureRequest:function(t){return f3.isSecureRequest(t)},isWebSocket:function(t){return Os.isWebSocket(t)},validateOptions:function(t,e){Os.validateOptions(t,e)}};Is.exports=El});var Be=E((Em,ks)=>{"use strict";var y4=function(t,e){this.type=t;for(var n in e)this[n]=e[n]};y4.prototype.initEvent=function(t,e,n){this.type=t,this.bubbles=e,this.cancelable=n};y4.prototype.stopPropagation=function(){};y4.prototype.preventDefault=function(){};y4.CAPTURING_PHASE=1;y4.AT_TARGET=2;y4.BUBBLING_PHASE=3;ks.exports=y4});var x6=E((Hm,Bs)=>{"use strict";var Hl=Be(),xl={onopen:null,onmessage:null,onerror:null,onclose:null,addEventListener:function(t,e,n){this.on(t,e)},removeEventListener:function(t,e,n){this.removeListener(t,e)},dispatchEvent:function(t){t.target=t.currentTarget=this,t.eventPhase=Hl.AT_TARGET,this["on"+t.type]&&this["on"+t.type](t),this.emit(t.type,t)}};Bs.exports=xl});var m3=E((xm,Fs)=>{"use strict";var Sl=S("stream").Stream,Tl=S("util"),Ll=ke(),Ds=x6(),v3=Be(),O=function(t){t=t||{},Ll.validateOptions(t,["headers","extensions","maxLength","ping","proxy","tls","ca"]),this.readable=this.writable=!0;var e=t.headers;if(e)for(var n in e)this._driver.setHeader(n,e[n]);var i=t.extensions;i&&[].concat(i).forEach(this._driver.addExtension,this._driver),this._ping=t.ping,this._pingId=0,this.readyState=O.CONNECTING,this.bufferedAmount=0,this.protocol="",this.url=this._driver.url,this.version=this._driver.version;var s=this;this._driver.on("open",function(c){s._open()}),this._driver.on("message",function(c){s._receiveMessage(c.data)}),this._driver.on("close",function(c){s._beginClose(c.reason,c.code)}),this._driver.on("error",function(c){s._emitError(c.message)}),this.on("error",function(){}),this._driver.messages.on("drain",function(){s.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){s._pingId+=1,s.ping(s._pingId.toString())},this._ping*1e3)),this._configureStream(),this._proxy||(this._stream.pipe(this._driver.io),this._driver.io.pipe(this._stream))};Tl.inherits(O,Sl);O.CONNECTING=0;O.OPEN=1;O.CLOSING=2;O.CLOSED=3;O.CLOSE_TIMEOUT=3e4;var Rs={write:function(t){return this.send(t)},end:function(t){t!==void 0&&this.send(t),this.close()},pause:function(){return this._driver.messages.pause()},resume:function(){return this._driver.messages.resume()},send:function(t){return this.readyState>O.OPEN?!1:(t instanceof Buffer||(t=String(t)),this._driver.messages.write(t))},ping:function(t,e){return this.readyState>O.OPEN?!1:this._driver.ping(t,e)},close:function(t,e){if(t===void 0&&(t=1e3),e===void 0&&(e=""),t!==1e3&&(t<3e3||t>4999))throw new Error("Failed to execute 'close' on WebSocket: The code must be either 1000, or between 3000 and 4999. "+t+" is neither.");if(this.readyState<O.CLOSING){var n=this;this._closeTimer=setTimeout(function(){n._beginClose("",1006)},O.CLOSE_TIMEOUT)}this.readyState!==O.CLOSED&&(this.readyState=O.CLOSING),this._driver.close(e,t)},_configureStream:function(){var t=this;this._stream.setTimeout(0),this._stream.setNoDelay(!0),["close","end"].forEach(function(e){this._stream.on(e,function(){t._finalizeClose()})},this),this._stream.on("error",function(e){t._emitError("Network error: "+t.url+": "+e.message),t._finalizeClose()})},_open:function(){if(this.readyState===O.CONNECTING){this.readyState=O.OPEN,this.protocol=this._driver.protocol||"";var t=new v3("open");t.initEvent("open",!1,!1),this.dispatchEvent(t)}},_receiveMessage:function(t){if(this.readyState>O.OPEN)return!1;this.readable&&this.emit("data",t);var e=new v3("message",{data:t});e.initEvent("message",!1,!1),this.dispatchEvent(e)},_emitError:function(t){if(!(this.readyState>=O.CLOSING)){var e=new v3("error",{message:t});e.initEvent("error",!1,!1),this.dispatchEvent(e)}},_beginClose:function(t,e){this.readyState!==O.CLOSED&&(this.readyState=O.CLOSING,this._closeParams=[t,e],this._stream&&(this._stream.destroy(),this._stream.readable||this._finalizeClose()))},_finalizeClose:function(){if(this.readyState!==O.CLOSED){this.readyState=O.CLOSED,this._closeTimer&&clearTimeout(this._closeTimer),this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end(),this.readable&&this.emit("end"),this.readable=this.writable=!1;var t=this._closeParams?this._closeParams[0]:"",e=this._closeParams?this._closeParams[1]:1006,n=new v3("close",{code:e,reason:t});n.initEvent("close",!1,!1),this.dispatchEvent(n)}}};for(S6 in Rs)O.prototype[S6]=Rs[S6];var S6;for(T6 in Ds)O.prototype[T6]=Ds[T6];var T6;Fs.exports=O});var Ws=E((Tm,js)=>{"use strict";var Al=S("util"),Ol=S("net"),Ns=S("tls"),Ps=S("url"),Il=ke(),qs=m3(),Sm=Be(),kl={"http:":80,"https:":443,"ws:":80,"wss:":443},Us=["https:","wss:"],p3=function(t,e,n){n=n||{},this.url=t,this._driver=Il.client(this.url,{maxLength:n.maxLength,protocols:e}),["open","error"].forEach(function(d){this._driver.on(d,function(){u.headers=u._driver.headers,u.statusCode=u._driver.statusCode})},this);var i=n.proxy||{},s=Ps.parse(i.origin||this.url),c=s.port||kl[s.protocol],o=Us.indexOf(s.protocol)>=0,r=function(){u._onConnect()},a=n.net||{},l=n.tls||{},h=i.origin?i.tls||{}:l,u=this;a.host=h.host=s.hostname,a.port=h.port=c,l.ca=l.ca||n.ca,h.servername=h.servername||s.hostname,this._stream=o?Ns.connect(h,r):Ol.connect(a,r),i.origin&&this._configureProxy(i,l),qs.call(this,n)};Al.inherits(p3,qs);p3.prototype._onConnect=function(){var t=this._proxy||this._driver;t.start()};p3.prototype._configureProxy=function(t,e){var n=Ps.parse(this.url),i=Us.indexOf(n.protocol)>=0,s=this,c;if(this._proxy=this._driver.proxy(t.origin),t.headers)for(c in t.headers)this._proxy.setHeader(c,t.headers[c]);this._proxy.pipe(this._stream,{end:!1}),this._stream.pipe(this._proxy),this._proxy.on("connect",function(){if(i){var o={socket:s._stream,servername:n.hostname};for(c in e)o[c]=e[c];s._stream=Ns.connect(o),s._configureStream()}s._driver.io.pipe(s._stream),s._stream.pipe(s._driver.io),s._driver.start()}),this._proxy.on("error",function(o){s._driver.emit("error",o)})};js.exports=p3});var Qs=E((Lm,Ys)=>{"use strict";var Bl=S("stream").Stream,Dl=S("util"),Rl=ke(),Fl=n3(),$4=m3(),Gs=x6(),$s=Be(),De=function(t,e,n){this.writable=!0,n=n||{},this._stream=e.socket,this._ping=n.ping||this.DEFAULT_PING,this._retry=n.retry||this.DEFAULT_RETRY;var i=Rl.isSecureRequest(t)?"https:":"http:";this.url=i+"//"+t.headers.host+t.url,this.lastEventId=t.headers["last-event-id"]||"",this.readyState=$4.CONNECTING;var s=new Fl,c=this;if(n.headers)for(var o in n.headers)s.set(o,n.headers[o]);if(!(!this._stream||!this._stream.writable)){process.nextTick(function(){c._open()}),this._stream.setTimeout(0),this._stream.setNoDelay(!0);var r=`HTTP/1.1 200 OK\r
Content-Type: text/event-stream\r
Cache-Control: no-cache, no-store\r
Connection: close\r
`+s.toString()+`\r
retry: `+Math.floor(this._retry*1e3)+`\r
\r
`;this._write(r),this._stream.on("drain",function(){c.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){c.ping()},this._ping*1e3)),["error","end"].forEach(function(a){c._stream.on(a,function(){c.close()})})}};Dl.inherits(De,Bl);De.isEventSource=function(t){if(t.method!=="GET")return!1;var e=(t.headers.accept||"").split(/\s*,\s*/);return e.indexOf("text/event-stream")>=0};var Ks={DEFAULT_PING:10,DEFAULT_RETRY:5,_write:function(t){if(!this.writable)return!1;try{return this._stream.write(t,"utf8")}catch{return!1}},_open:function(){if(this.readyState===$4.CONNECTING){this.readyState=$4.OPEN;var t=new $s("open");t.initEvent("open",!1,!1),this.dispatchEvent(t)}},write:function(t){return this.send(t)},end:function(t){t!==void 0&&this.write(t),this.close()},send:function(t,e){if(this.readyState>$4.OPEN)return!1;t=String(t).replace(/(\r\n|\r|\n)/g,"$1data: "),e=e||{};var n="";return e.event&&(n+="event: "+e.event+`\r
`),e.id&&(n+="id: "+e.id+`\r
`),n+="data: "+t+`\r
\r
`,this._write(n)},ping:function(){return this._write(`:\r
\r
`)},close:function(){if(this.readyState>$4.OPEN)return!1;this.readyState=$4.CLOSED,this.writable=!1,this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end();var t=new $s("close");return t.initEvent("close",!1,!1),this.dispatchEvent(t),!0}};for(L6 in Ks)De.prototype[L6]=Ks[L6];var L6;for(A6 in Gs)De.prototype[A6]=Gs[A6];var A6;Ys.exports=De});var Js=E((Am,Xs)=>{"use strict";var Nl=S("util"),O6=ke(),Zs=m3(),J1=function(t,e,n,i,s){s=s||{},this._stream=e,this._driver=O6.http(t,{maxLength:s.maxLength,protocols:i});var c=this;if(!(!this._stream||!this._stream.writable)){if(!this._stream.readable)return this._stream.end();var o=function(){c._stream.removeListener("data",o)};this._stream.on("data",o),Zs.call(this,s),process.nextTick(function(){c._driver.start(),c._driver.io.write(n)})}};Nl.inherits(J1,Zs);J1.isWebSocket=function(t){return O6.isWebSocket(t)};J1.validateOptions=function(t,e){O6.validateOptions(t,e)};J1.WebSocket=J1;J1.Client=Ws();J1.EventSource=Qs();Xs.exports=J1});function R(t,e){Vo(t)&&(t="100%");var n=Eo(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function we(t){return Math.min(1,Math.max(0,t))}function Vo(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function Eo(t){return typeof t=="string"&&t.indexOf("%")!==-1}function O2(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Me(t){return t<=1?"".concat(Number(t)*100,"%"):t}function K1(t){return t.length===1?"0"+t:String(t)}function an(t,e,n){return{r:R(t,255)*255,g:R(e,255)*255,b:R(n,255)*255}}function _8(t,e,n){t=R(t,255),e=R(e,255),n=R(n,255);var i=Math.max(t,e,n),s=Math.min(t,e,n),c=0,o=0,r=(i+s)/2;if(i===s)o=0,c=0;else{var a=i-s;switch(o=r>.5?a/(2-i-s):a/(i+s),i){case t:c=(e-n)/a+(e<n?6:0);break;case e:c=(n-t)/a+2;break;case n:c=(t-e)/a+4;break;default:break}c/=6}return{h:c,s:o,l:r}}function g8(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*(6*n):n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function ln(t,e,n){var i,s,c;if(t=R(t,360),e=R(e,100),n=R(n,100),e===0)s=n,c=n,i=n;else{var o=n<.5?n*(1+e):n+e-n*e,r=2*n-o;i=g8(r,o,t+1/3),s=g8(r,o,t),c=g8(r,o,t-1/3)}return{r:i*255,g:s*255,b:c*255}}function d4(t,e,n){t=R(t,255),e=R(e,255),n=R(n,255);var i=Math.max(t,e,n),s=Math.min(t,e,n),c=0,o=i,r=i-s,a=i===0?0:r/i;if(i===s)c=0;else{switch(i){case t:c=(e-n)/r+(e<n?6:0);break;case e:c=(n-t)/r+2;break;case n:c=(t-e)/r+4;break;default:break}c/=6}return{h:c,s:a,v:o}}function hn(t,e,n){t=R(t,360)*6,e=R(e,100),n=R(n,100);var i=Math.floor(t),s=t-i,c=n*(1-e),o=n*(1-s*e),r=n*(1-(1-s)*e),a=i%6,l=[n,o,c,c,r,n][a],h=[r,n,n,o,c,c][a],u=[c,c,r,n,n,o][a];return{r:l*255,g:h*255,b:u*255}}function f4(t,e,n,i){var s=[K1(Math.round(t).toString(16)),K1(Math.round(e).toString(16)),K1(Math.round(n).toString(16))];return i&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function un(t,e,n,i,s){var c=[K1(Math.round(t).toString(16)),K1(Math.round(e).toString(16)),K1(Math.round(n).toString(16)),K1(Ho(i))];return s&&c[0].startsWith(c[0].charAt(1))&&c[1].startsWith(c[1].charAt(1))&&c[2].startsWith(c[2].charAt(1))&&c[3].startsWith(c[3].charAt(1))?c[0].charAt(0)+c[1].charAt(0)+c[2].charAt(0)+c[3].charAt(0):c.join("")}function Ho(t){return Math.round(parseFloat(t)*255).toString(16)}function z8(t){return n1(t)/255}function n1(t){return parseInt(t,16)}function dn(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var ye={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function i1(t){var e={r:0,g:0,b:0},n=1,i=null,s=null,c=null,o=!1,r=!1;return typeof t=="string"&&(t=To(t)),typeof t=="object"&&(D1(t.r)&&D1(t.g)&&D1(t.b)?(e=an(t.r,t.g,t.b),o=!0,r=String(t.r).substr(-1)==="%"?"prgb":"rgb"):D1(t.h)&&D1(t.s)&&D1(t.v)?(i=Me(t.s),s=Me(t.v),e=hn(t.h,i,s),o=!0,r="hsv"):D1(t.h)&&D1(t.s)&&D1(t.l)&&(i=Me(t.s),c=Me(t.l),e=ln(t.h,i,c),o=!0,r="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=O2(n),{ok:o,format:t.format||r,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}var xo="[-\\+]?\\d+%?",So="[-\\+]?\\d*\\.\\d+%?",Y1="(?:".concat(So,")|(?:").concat(xo,")"),w8="[\\s|\\(]+(".concat(Y1,")[,|\\s]+(").concat(Y1,")[,|\\s]+(").concat(Y1,")\\s*\\)?"),M8="[\\s|\\(]+(".concat(Y1,")[,|\\s]+(").concat(Y1,")[,|\\s]+(").concat(Y1,")[,|\\s]+(").concat(Y1,")\\s*\\)?"),M1={CSS_UNIT:new RegExp(Y1),rgb:new RegExp("rgb"+w8),rgba:new RegExp("rgba"+M8),hsl:new RegExp("hsl"+w8),hsla:new RegExp("hsla"+M8),hsv:new RegExp("hsv"+w8),hsva:new RegExp("hsva"+M8),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function To(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var e=!1;if(ye[t])t=ye[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n=M1.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=M1.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=M1.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=M1.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=M1.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=M1.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=M1.hex8.exec(t),n?{r:n1(n[1]),g:n1(n[2]),b:n1(n[3]),a:z8(n[4]),format:e?"name":"hex8"}:(n=M1.hex6.exec(t),n?{r:n1(n[1]),g:n1(n[2]),b:n1(n[3]),format:e?"name":"hex"}:(n=M1.hex4.exec(t),n?{r:n1(n[1]+n[1]),g:n1(n[2]+n[2]),b:n1(n[3]+n[3]),a:z8(n[4]+n[4]),format:e?"name":"hex8"}:(n=M1.hex3.exec(t),n?{r:n1(n[1]+n[1]),g:n1(n[2]+n[2]),b:n1(n[3]+n[3]),format:e?"name":"hex"}:!1)))))))))}function D1(t){return!!M1.CSS_UNIT.exec(String(t))}var I2=function(){function t(e,n){e===void 0&&(e=""),n===void 0&&(n={});var i;if(e instanceof t)return e;typeof e=="number"&&(e=dn(e)),this.originalInput=e;var s=i1(e);this.originalInput=e,this.r=s.r,this.g=s.g,this.b=s.b,this.a=s.a,this.roundA=Math.round(100*this.a)/100,this.format=(i=n.format)!==null&&i!==void 0?i:s.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=s.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},t.prototype.getLuminance=function(){var e=this.toRgb(),n,i,s,c=e.r/255,o=e.g/255,r=e.b/255;return c<=.03928?n=c/12.92:n=Math.pow((c+.055)/1.055,2.4),o<=.03928?i=o/12.92:i=Math.pow((o+.055)/1.055,2.4),r<=.03928?s=r/12.92:s=Math.pow((r+.055)/1.055,2.4),.2126*n+.7152*i+.0722*s},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(e){return this.a=O2(e),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},t.prototype.toHsv=function(){var e=d4(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},t.prototype.toHsvString=function(){var e=d4(this.r,this.g,this.b),n=Math.round(e.h*360),i=Math.round(e.s*100),s=Math.round(e.v*100);return this.a===1?"hsv(".concat(n,", ").concat(i,"%, ").concat(s,"%)"):"hsva(".concat(n,", ").concat(i,"%, ").concat(s,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var e=_8(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},t.prototype.toHslString=function(){var e=_8(this.r,this.g,this.b),n=Math.round(e.h*360),i=Math.round(e.s*100),s=Math.round(e.l*100);return this.a===1?"hsl(".concat(n,", ").concat(i,"%, ").concat(s,"%)"):"hsla(".concat(n,", ").concat(i,"%, ").concat(s,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(e){return e===void 0&&(e=!1),f4(this.r,this.g,this.b,e)},t.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},t.prototype.toHex8=function(e){return e===void 0&&(e=!1),un(this.r,this.g,this.b,this.a,e)},t.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},t.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var e=Math.round(this.r),n=Math.round(this.g),i=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(n,", ").concat(i,")"):"rgba(".concat(e,", ").concat(n,", ").concat(i,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var e=function(n){return"".concat(Math.round(R(n,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var e=function(n){return Math.round(R(n,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+f4(this.r,this.g,this.b,!1),n=0,i=Object.entries(ye);n<i.length;n++){var s=i[n],c=s[0],o=s[1];if(e===o)return c}return!1},t.prototype.toString=function(e){var n=!!e;e=e??this.format;var i=!1,s=this.a<1&&this.a>=0,c=!n&&s&&(e.startsWith("hex")||e==="name");return c?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l+=e/100,n.l=we(n.l),new t(n)},t.prototype.brighten=function(e){e===void 0&&(e=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),new t(n)},t.prototype.darken=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l-=e/100,n.l=we(n.l),new t(n)},t.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},t.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},t.prototype.desaturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s-=e/100,n.s=we(n.s),new t(n)},t.prototype.saturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s+=e/100,n.s=we(n.s),new t(n)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var n=this.toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,new t(n)},t.prototype.mix=function(e,n){n===void 0&&(n=50);var i=this.toRgb(),s=new t(e).toRgb(),c=n/100,o={r:(s.r-i.r)*c+i.r,g:(s.g-i.g)*c+i.g,b:(s.b-i.b)*c+i.b,a:(s.a-i.a)*c+i.a};return new t(o)},t.prototype.analogous=function(e,n){e===void 0&&(e=6),n===void 0&&(n=30);var i=this.toHsl(),s=360/n,c=[this];for(i.h=(i.h-(s*e>>1)+720)%360;--e;)i.h=(i.h+s)%360,c.push(new t(i));return c},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var n=this.toHsv(),i=n.h,s=n.s,c=n.v,o=[],r=1/e;e--;)o.push(new t({h:i,s,v:c})),c=(c+r)%1;return o},t.prototype.splitcomplement=function(){var e=this.toHsl(),n=e.h;return[this,new t({h:(n+72)%360,s:e.s,l:e.l}),new t({h:(n+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var n=this.toRgb(),i=new t(e).toRgb(),s=n.a+i.a*(1-n.a);return new t({r:(n.r*n.a+i.r*i.a*(1-n.a))/s,g:(n.g*n.a+i.g*i.a*(1-n.a))/s,b:(n.b*n.a+i.b*i.a*(1-n.a))/s,a:s})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var n=this.toHsl(),i=n.h,s=[this],c=360/e,o=1;o<e;o++)s.push(new t({h:(i+o*c)%360,s:n.s,l:n.l}));return s},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}();var k2=2,fn=.16,Lo=.05,Ao=.05,Oo=.15,_n=5,zn=4,Io=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function vn(t){var e=t.r,n=t.g,i=t.b,s=d4(e,n,i);return{h:s.h*360,s:s.s,v:s.v}}function B2(t){var e=t.r,n=t.g,i=t.b;return"#".concat(f4(e,n,i,!1))}function ko(t,e,n){var i=n/100,s={r:(e.r-t.r)*i+t.r,g:(e.g-t.g)*i+t.g,b:(e.b-t.b)*i+t.b};return s}function mn(t,e,n){var i;return Math.round(t.h)>=60&&Math.round(t.h)<=240?i=n?Math.round(t.h)-k2*e:Math.round(t.h)+k2*e:i=n?Math.round(t.h)+k2*e:Math.round(t.h)-k2*e,i<0?i+=360:i>=360&&(i-=360),i}function pn(t,e,n){if(t.h===0&&t.s===0)return t.s;var i;return n?i=t.s-fn*e:e===zn?i=t.s+fn:i=t.s+Lo*e,i>1&&(i=1),n&&e===_n&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2))}function gn(t,e,n){var i;return n?i=t.v+Ao*e:i=t.v-Oo*e,i>1&&(i=1),Number(i.toFixed(2))}function D4(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[],i=i1(t),s=_n;s>0;s-=1){var c=vn(i),o=B2(i1({h:mn(c,s,!0),s:pn(c,s,!0),v:gn(c,s,!0)}));n.push(o)}n.push(B2(i));for(var r=1;r<=zn;r+=1){var a=vn(i),l=B2(i1({h:mn(a,r),s:pn(a,r),v:gn(a,r)}));n.push(l)}return e.theme==="dark"?Io.map(function(h){var u=h.index,d=h.opacity,v=B2(ko(i1(e.backgroundColor||"#141414"),i1(n[u]),d*100));return v}):n}var y8={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},W={},b8={};Object.keys(y8).forEach(function(t){W[t]=D4(y8[t]),W[t].primary=W[t][5],b8[t]=D4(y8[t],{theme:"dark",backgroundColor:"#141414"}),b8[t].primary=b8[t][5]});var od=W.red,rd=W.volcano,ad=W.gold,ld=W.orange,hd=W.yellow,ud=W.lime,dd=W.green,fd=W.cyan,vd=W.blue,md=W.geekblue,pd=W.purple,gd=W.magenta,_d=W.grey,zd=W.grey;var R1="[@ant-design/icons-angular]:";function Ro(t){console.error(`${R1} ${t}.`)}function Fo(t){u4()&&console.warn(`${R1} ${t}.`)}function wn(t){return D4(t)[0]}function C8(t,e){switch(e){case"fill":return`${t}-fill`;case"outline":return`${t}-o`;case"twotone":return`${t}-twotone`;case void 0:return t;default:throw new Error(`${R1}Theme "${e}" is not a recognized theme!`)}}function No(t,e,n,i){return`${C8(t,e)}-${n}-${i}`}function Po(t){return t==="o"?"outline":t}function qo(t){return typeof t=="object"&&typeof t.name=="string"&&(typeof t.theme=="string"||t.theme===void 0)&&typeof t.icon=="string"}function Uo(t){let e=t.split("-"),n=Po(e.splice(e.length-1,1)[0]);return{name:e.join("-"),theme:n,icon:""}}function jo(t){return t.cloneNode(!0)}function Wo(t){return t.replace(/['"]#333['"]/g,'"primaryColor"').replace(/['"]#E6E6E6['"]/g,'"secondaryColor"').replace(/['"]#D9D9D9['"]/g,'"secondaryColor"').replace(/['"]#D8D8D8['"]/g,'"secondaryColor"')}function V8(t){let e=t.split(":");switch(e.length){case 1:return[t,""];case 2:return[e[1],e[0]];default:throw new Error(`${R1}The icon type ${t} is not valid!`)}}function Go(t){return V8(t)[1]!==""}function $o(){return new Error(`${R1}Type should have a namespace. Try "namespace:${name}".`)}function Mn(t){return new Error(`${R1}the icon ${t} does not exist or is not registered.`)}function Ko(){return Ro('you need to import "HttpClientModule" to use dynamic importing.'),null}function Yo(t){return new Error(`${R1}The url "${t}" is unsafe.`)}function Qo(){return new Error(`${R1}<svg> tag not found.`)}function Zo(){return new Error(`${R1}Importing timeout error.`)}var Xo="__ant_icon_load",Jo=new H("ant_icons"),yn=(()=>{let e=class e{set twoToneColor({primaryColor:i,secondaryColor:s}){this._twoToneColorPalette.primaryColor=i,this._twoToneColorPalette.secondaryColor=s||wn(i)}get twoToneColor(){return F({},this._twoToneColorPalette)}get _disableDynamicLoading(){return!1}constructor(i,s,c,o,r){this._rendererFactory=i,this._handler=s,this._document=c,this.sanitizer=o,this._antIcons=r,this.defaultTheme="outline",this._svgDefinitions=new Map,this._svgRenderedDefinitions=new Map,this._inProgressFetches=new Map,this._assetsUrlRoot="",this._twoToneColorPalette={primaryColor:"#333333",secondaryColor:"#E6E6E6"},this._enableJsonpLoading=!1,this._jsonpIconLoad$=new U1,this._renderer=this._rendererFactory.createRenderer(null,null),this._handler&&(this._http=new G0(this._handler)),this._antIcons&&this.addIcon(...this._antIcons)}useJsonpLoading(){this._enableJsonpLoading?Fo("You are already using jsonp loading."):(this._enableJsonpLoading=!0,window[Xo]=i=>{this._jsonpIconLoad$.next(i)})}changeAssetsSource(i){this._assetsUrlRoot=i.endsWith("/")?i:i+"/"}addIcon(...i){i.forEach(s=>{this._svgDefinitions.set(C8(s.name,s.theme),s)})}addIconLiteral(i,s){let[c,o]=V8(i);if(!o)throw $o();this.addIcon({name:i,icon:s})}clear(){this._svgDefinitions.clear(),this._svgRenderedDefinitions.clear()}getRenderedContent(i,s){let c=qo(i)?i:this._svgDefinitions.get(i)||null;if(!c&&this._disableDynamicLoading)throw Mn(i);return(c?z1(c):this._loadIconDynamically(i)).pipe(G(r=>{if(!r)throw Mn(i);return this._loadSVGFromCacheOrCreateNew(r,s)}))}getCachedIcons(){return this._svgDefinitions}_loadIconDynamically(i){if(!this._http&&!this._enableJsonpLoading)return z1(Ko());let s=this._inProgressFetches.get(i);if(!s){let[c,o]=V8(i),r=o?{name:i,icon:""}:Uo(c),a=this._enableJsonpLoading?".js":".svg",l=(o?`${this._assetsUrlRoot}assets/${o}/${c}`:`${this._assetsUrlRoot}assets/${r.theme}/${r.name}`)+a,h=this.sanitizer.sanitize(P0.URL,l);if(!h)throw Yo(l);s=(this._enableJsonpLoading?this._loadIconDynamicallyWithJsonp(r,h):this._http.get(h,{responseType:"text"}).pipe(G(d=>f1(F({},r),{icon:d})))).pipe(w2(d=>this.addIcon(d)),I0(()=>this._inProgressFetches.delete(i)),T0(()=>z1(null)),z2()),this._inProgressFetches.set(i,s)}return s}_loadIconDynamicallyWithJsonp(i,s){return new q1(c=>{let o=this._document.createElement("script"),r=setTimeout(()=>{a(),c.error(Zo())},6e3);o.src=s;function a(){o.parentNode.removeChild(o),clearTimeout(r)}this._document.body.appendChild(o),this._jsonpIconLoad$.pipe(I4(l=>l.name===i.name&&l.theme===i.theme),L0(1)).subscribe(l=>{c.next(l),a()})})}_loadSVGFromCacheOrCreateNew(i,s){let c,o=s||this._twoToneColorPalette.primaryColor,r=wn(o)||this._twoToneColorPalette.secondaryColor,a=i.theme==="twotone"?No(i.name,i.theme,o,r):i.theme===void 0?i.name:C8(i.name,i.theme),l=this._svgRenderedDefinitions.get(a);return l?c=l.icon:(c=this._setSVGAttribute(this._colorizeSVGIcon(this._createSVGElementFromString(Go(i.name)?i.icon:Wo(i.icon)),i.theme==="twotone",o,r)),this._svgRenderedDefinitions.set(a,f1(F({},i),{icon:c}))),jo(c)}_createSVGElementFromString(i){let s=this._document.createElement("div");s.innerHTML=i;let c=s.querySelector("svg");if(!c)throw Qo;return c}_setSVGAttribute(i){return this._renderer.setAttribute(i,"width","1em"),this._renderer.setAttribute(i,"height","1em"),i}_colorizeSVGIcon(i,s,c,o){if(s){let r=i.childNodes,a=r.length;for(let l=0;l<a;l++){let h=r[l];h.getAttribute("fill")==="secondaryColor"?this._renderer.setAttribute(h,"fill",o):this._renderer.setAttribute(h,"fill",c)}}return this._renderer.setAttribute(i,"fill","currentColor"),i}};e.\u0275fac=function(s){return new(s||e)(g(b2),g(H2,8),g(E2,8),g(x2),g(Jo,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac});let t=e;return t})();var bn={isTestMode:!1};var Cn={},er="[NG-ZORRO]:";function tr(...t){let e=t.reduce((n,i)=>n+i.toString(),"");return Cn[e]?!1:(Cn[e]=!0,!0)}function nr(t,...e){(bn.isTestMode||u4()&&tr(...e))&&t(...e)}var D2=(...t)=>nr((...e)=>console.warn(er,...e),...t);var ir=typeof window<"u",Fd=ir&&window.mozInnerScreenX!=null;function H8(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var sr="rc-util-key";function En({mark:t}={}){return t?t.startsWith("data-")?t:`data-${t}`:sr}function x8(t){return t.attachTo?t.attachTo:document.querySelector("head")||document.body}function Vn(t,e={}){if(!H8())return null;let n=document.createElement("style");e.cspNonce&&(n.nonce=e.cspNonce),n.innerHTML=t;let i=x8(e),{firstChild:s}=i;return e.prepend&&i.prepend?i.prepend(n):e.prepend&&s?i.insertBefore(n,s):i.appendChild(n),n}var E8=new Map;function cr(t,e={}){let n=x8(e);return Array.from(E8.get(n)?.children||[]).find(i=>i.tagName==="STYLE"&&i.getAttribute(En(e))===t)}function Hn(t,e,n={}){let i=x8(n);if(!E8.has(i)){let o=Vn("",n),{parentNode:r}=o;E8.set(i,r),r.removeChild(o)}let s=cr(e,n);if(s)return n.cspNonce&&s.nonce!==n.cspNonce&&(s.nonce=n.cspNonce),s.innerHTML!==t&&(s.innerHTML=t),s;let c=Vn(t,n);return c?.setAttribute(En(n),e),c}var xn={name:"bars",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z" /></svg>'};var Sn={name:"calendar",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z" /></svg>'},Tn={name:"caret-down",theme:"fill",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z" /></svg>'};var Ln={name:"caret-up",theme:"fill",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M858.9 689L530.5 308.2c-9.4-10.9-27.5-10.9-37 0L165.1 689c-12.2 14.2-1.2 35 18.5 35h656.8c19.7 0 30.7-20.8 18.5-35z" /></svg>'};var An={name:"check-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z" /></svg>'},On={name:"check-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z" /><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /></svg>'};var In={name:"check",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z" /></svg>'};var kn={name:"caret-down",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z" /></svg>'};var Bn={name:"close-circle",theme:"fill",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z" /></svg>'};var Dn={name:"close-circle",theme:"outline",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z" /></svg>'},Rn={name:"clock-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z" /></svg>'};var Fn={name:"close",theme:"outline",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z" /></svg>'};var Nn={name:"caret-up",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M858.9 689L530.5 308.2c-9.4-10.9-27.5-10.9-37 0L165.1 689c-12.2 14.2-1.2 35 18.5 35h656.8c19.7 0 30.7-20.8 18.5-35z" /></svg>'};var Pn={name:"copy",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z" /></svg>'};var qn={name:"delete",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z" /></svg>'};var Pd={name:"dashboard",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M924.8 385.6a446.7 446.7 0 00-96-142.4 446.7 446.7 0 00-142.4-96C631.1 123.8 572.5 112 512 112s-119.1 11.8-174.4 35.2a446.7 446.7 0 00-142.4 96 446.7 446.7 0 00-96 142.4C75.8 440.9 64 499.5 64 560c0 132.7 58.3 257.7 159.9 343.1l1.7 1.4c5.8 4.8 13.1 7.5 20.6 7.5h531.7c7.5 0 14.8-2.7 20.6-7.5l1.7-1.4C901.7 817.7 960 692.7 960 560c0-60.5-11.9-119.1-35.2-174.4zM761.4 836H262.6A371.12 371.12 0 01140 560c0-99.4 38.7-192.8 109-263 70.3-70.3 163.7-109 263-109 99.4 0 192.8 38.7 263 109 70.3 70.3 109 163.7 109 263 0 105.6-44.5 205.5-122.6 276zM623.5 421.5a8.03 8.03 0 00-11.3 0L527.7 506c-18.7-5-39.4-.2-54.1 14.5a55.95 55.95 0 000 79.2 55.95 55.95 0 0079.2 0 55.87 55.87 0 0014.5-54.1l84.5-84.5c3.1-3.1 3.1-8.2 0-11.3l-28.3-28.3zM490 320h44c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8h-44c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8zm260 218v44c0 4.4 3.6 8 8 8h80c4.4 0 8-3.6 8-8v-44c0-4.4-3.6-8-8-8h-80c-4.4 0-8 3.6-8 8zm12.7-197.2l-31.1-31.1a8.03 8.03 0 00-11.3 0l-56.6 56.6a8.03 8.03 0 000 11.3l31.1 31.1c3.1 3.1 8.2 3.1 11.3 0l56.6-56.6c3.1-3.1 3.1-8.2 0-11.3zm-458.6-31.1a8.03 8.03 0 00-11.3 0l-31.1 31.1a8.03 8.03 0 000 11.3l56.6 56.6c3.1 3.1 8.2 3.1 11.3 0l31.1-31.1c3.1-3.1 3.1-8.2 0-11.3l-56.6-56.6zM262 530h-80c-4.4 0-8 3.6-8 8v44c0 4.4 3.6 8 8 8h80c4.4 0 8-3.6 8-8v-44c0-4.4-3.6-8-8-8z" /></svg>'};var Un={name:"double-left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M272.9 512l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512zm304 0l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z" /></svg>'};var jn={name:"double-right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1A7.98 7.98 0 00188 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5zm304 0L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1A7.98 7.98 0 00492 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z" /></svg>'};var Wn={name:"down",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z" /></svg>'};var Gn={name:"edit",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z" /></svg>'},$n={name:"ellipsis",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z" /></svg>'};var Kn={name:"exclamation-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z" /></svg>'};var Yn={name:"exclamation-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z" /></svg>'};var Qn={name:"file",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M854.6 288.7c6 6 9.4 14.1 9.4 22.6V928c0 17.7-14.3 32-32 32H192c-17.7 0-32-14.3-32-32V96c0-17.7 14.3-32 32-32h424.7c8.5 0 16.7 3.4 22.7 9.4l215.2 215.3zM790.2 326L602 137.8V326h188.2z" /></svg>'};var Zn={name:"filter",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M349 838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V642H349v196zm531.1-684H143.9c-24.5 0-39.8 26.7-27.5 48l221.3 376h348.8l221.3-376c12.1-21.3-3.2-48-27.7-48z" /></svg>'};var qd={name:"form",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z" /><path d="M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z" /></svg>'};var Xn={name:"info-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z" /></svg>'};var Jn={name:"info-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z" /></svg>'};var ei={name:"file",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z" /></svg>'};var ti={name:"left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z" /></svg>'};var ni={name:"loading",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z" /></svg>'};var ii={name:"eye",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z" /></svg>'};var Ud={name:"menu-unfold",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z" /></svg>'};var jd={name:"menu-fold",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 000 13.8z" /></svg>'};var si={name:"paper-clip",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z" /></svg>'};var ci={name:"question-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z" /></svg>'};var oi={name:"right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z" /></svg>'};var ri={name:"rotate-left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><defs><style /></defs><path d="M672 418H144c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H188V494h440v326z" /><path d="M819.3 328.5c-78.8-100.7-196-153.6-314.6-154.2l-.2-64c0-6.5-7.6-10.1-12.6-6.1l-128 101c-4 3.1-3.9 9.1 0 12.3L492 318.6c5.1 4 12.7.4 12.6-6.1v-63.9c12.9.1 25.9.9 38.8 2.5 42.1 5.2 82.1 18.2 119 38.7 38.1 21.2 71.2 49.7 98.4 84.3 27.1 34.7 46.7 73.7 58.1 115.8a325.95 325.95 0 016.5 140.9h74.9c14.8-103.6-11.3-213-81-302.3z" /></svg>'};var ai={name:"rotate-right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><defs><style /></defs><path d="M480.5 251.2c13-1.6 25.9-2.4 38.8-2.5v63.9c0 6.5 7.5 10.1 12.6 6.1L660 217.6c4-3.2 4-9.2 0-12.3l-128-101c-5.1-4-12.6-.4-12.6 6.1l-.2 64c-118.6.5-235.8 53.4-314.6 154.2A399.75 399.75 0 00123.5 631h74.9c-.9-5.3-1.7-10.7-2.4-16.1-5.1-42.1-2.1-84.1 8.9-124.8 11.4-42.2 31-81.1 58.1-115.8 27.2-34.7 60.3-63.2 98.4-84.3 37-20.6 76.9-33.6 119.1-38.8z" /><path d="M880 418H352c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H396V494h440v326z" /></svg>'};var li={name:"search",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z" /></svg>'};var S8={name:"star",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z" /></svg>'};var hi={name:"swap-right",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M873.1 596.2l-164-208A32 32 0 00684 376h-64.8c-6.7 0-10.4 7.7-6.3 13l144.3 183H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h695.9c26.8 0 41.7-30.8 25.2-51.8z" /></svg>'};var ui={name:"upload",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z" /></svg>'},di={name:"up",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z" /></svg>'};var fi={name:"vertical-align-top",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z" /></svg>'};var vi={name:"zoom-in",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z" /></svg>'};var mi={name:"zoom-out",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z" /></svg>'};var R2=2,pi=.16,or=.05,rr=.05,ar=.15,Mi=5,yi=4,lr=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function gi({r:t,g:e,b:n}){let i=d4(t,e,n);return{h:i.h*360,s:i.s,v:i.v}}function F2({r:t,g:e,b:n}){return`#${f4(t,e,n,!1)}`}function hr(t,e,n){let i=n/100;return{r:(e.r-t.r)*i+t.r,g:(e.g-t.g)*i+t.g,b:(e.b-t.b)*i+t.b}}function _i(t,e,n){let i;return Math.round(t.h)>=60&&Math.round(t.h)<=240?i=n?Math.round(t.h)-R2*e:Math.round(t.h)+R2*e:i=n?Math.round(t.h)+R2*e:Math.round(t.h)-R2*e,i<0?i+=360:i>=360&&(i-=360),i}function zi(t,e,n){if(t.h===0&&t.s===0)return t.s;let i;return n?i=t.s-pi*e:e===yi?i=t.s+pi:i=t.s+or*e,i>1&&(i=1),n&&e===Mi&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2))}function wi(t,e,n){let i;return n?i=t.v+rr*e:i=t.v-ar*e,i>1&&(i=1),Number(i.toFixed(2))}function T8(t,e={}){let n=[],i=i1(t);for(let s=Mi;s>0;s-=1){let c=gi(i),o=F2(i1({h:_i(c,s,!0),s:zi(c,s,!0),v:wi(c,s,!0)}));n.push(o)}n.push(F2(i));for(let s=1;s<=yi;s+=1){let c=gi(i),o=F2(i1({h:_i(c,s),s:zi(c,s),v:wi(c,s)}));n.push(o)}return e.theme==="dark"?lr.map(({index:s,opacity:c})=>F2(hr(i1(e.backgroundColor||"#141414"),i1(n[s]),c*100))):n}var ur=new H("nz-config");var dr=`-ant-${Date.now()}-${Math.random()}`;function fr(t,e){let n={},i=(o,r)=>{let a=o.clone();return a=r?.(a)||a,a.toRgbString()},s=(o,r)=>{let a=new I2(o),l=T8(a.toRgbString());n[`${r}-color`]=i(a),n[`${r}-color-disabled`]=l[1],n[`${r}-color-hover`]=l[4],n[`${r}-color-active`]=l[7],n[`${r}-color-outline`]=a.clone().setAlpha(.2).toRgbString(),n[`${r}-color-deprecated-bg`]=l[1],n[`${r}-color-deprecated-border`]=l[3]};if(e.primaryColor){s(e.primaryColor,"primary");let o=new I2(e.primaryColor),r=T8(o.toRgbString());r.forEach((l,h)=>{n[`primary-${h+1}`]=l}),n["primary-color-deprecated-l-35"]=i(o,l=>l.lighten(35)),n["primary-color-deprecated-l-20"]=i(o,l=>l.lighten(20)),n["primary-color-deprecated-t-20"]=i(o,l=>l.tint(20)),n["primary-color-deprecated-t-50"]=i(o,l=>l.tint(50)),n["primary-color-deprecated-f-12"]=i(o,l=>l.setAlpha(l.getAlpha()*.12));let a=new I2(r[0]);n["primary-color-active-deprecated-f-30"]=i(a,l=>l.setAlpha(l.getAlpha()*.3)),n["primary-color-active-deprecated-d-02"]=i(a,l=>l.darken(2))}return e.successColor&&s(e.successColor,"success"),e.warningColor&&s(e.warningColor,"warning"),e.errorColor&&s(e.errorColor,"error"),e.infoColor&&s(e.infoColor,"info"),`
  :root {
    ${Object.keys(n).map(o=>`--${t}-${o}: ${n[o]};`).join(`
`)}
  }
  `.trim()}function bi(t,e,n){let i=fr(t,e);H8()?Hn(i,`${dr}-dynamic-theme`,{cspNonce:n}):D2("NzConfigService: SSR do not support dynamic theme with css variables.")}var Ci="ant",Vi=(()=>{let e=class e{constructor(i,s){this.configUpdated$=new U1,this.config=i||{},this.cspNonce=s,this.config.theme&&bi(this.getConfig().prefixCls?.prefixCls||Ci,this.config.theme,s)}getConfig(){return this.config}getConfigForComponent(i){return this.config[i]}getConfigChangeEventForComponent(i){return this.configUpdated$.pipe(I4(s=>s===i),A0(void 0))}set(i,s){this.config[i]=F(F({},this.config[i]),s),i==="theme"&&this.config.theme&&bi(this.getConfig().prefixCls?.prefixCls||Ci,this.config.theme,this.cspNonce),this.configUpdated$.next(i)}};e.\u0275fac=function(s){return new(s||e)(g(ur,8),g(R0,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var L8;try{L8=typeof Intl<"u"&&Intl.v8BreakIterator}catch{L8=!1}var Ei=(()=>{let e=class e{constructor(i){this._platformId=i,this.isBrowser=this._platformId?j0(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||L8)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(s){return new(s||e)(g(j1))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var gr=[xn,Sn,Ln,Nn,Tn,kn,An,On,In,Rn,Dn,Bn,Fn,Pn,qn,Un,jn,Wn,Gn,$n,Yn,Kn,ii,Qn,ei,Zn,Jn,Xn,ti,ni,si,ci,oi,ai,ri,S8,li,S8,ui,fi,di,hi,vi,mi],xi=new H("nz_icons"),Ef=new H("nz_icon_default_twotone_color"),Hi="#1890ff",_r=(()=>{let e=class e extends yn{get _disableDynamicLoading(){return!this.platform.isBrowser}ngOnDestroy(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}normalizeSvgElement(i){i.getAttribute("viewBox")||this._renderer.setAttribute(i,"viewBox","0 0 1024 1024"),(!i.getAttribute("width")||!i.getAttribute("height"))&&(this._renderer.setAttribute(i,"width","1em"),this._renderer.setAttribute(i,"height","1em")),i.getAttribute("fill")||this._renderer.setAttribute(i,"fill","currentColor")}fetchFromIconfont(i){let{scriptUrl:s}=i;if(this._document&&!this.iconfontCache.has(s)){let c=this._renderer.createElement("script");this._renderer.setAttribute(c,"src",s),this._renderer.setAttribute(c,"data-namespace",s.replace(/^(https?|http):/g,"")),this._renderer.appendChild(this._document.body,c),this.iconfontCache.add(s)}}createIconfontIcon(i){return this._createSVGElementFromString(`<svg><use xlink:href="${i}"></svg>`)}constructor(i,s,c,o,r,a,l){super(i,r,a,s,[...gr,...l||[]]),this.nzConfigService=c,this.platform=o,this.configUpdated$=new U1,this.iconfontCache=new Set,this.subscription=null,this.onConfigChange(),this.configDefaultTwotoneColor(),this.configDefaultTheme()}onConfigChange(){this.subscription=this.nzConfigService.getConfigChangeEventForComponent("icon").subscribe(()=>{this.configDefaultTwotoneColor(),this.configDefaultTheme(),this.configUpdated$.next()})}configDefaultTheme(){let i=this.getConfig();this.defaultTheme=i.nzTheme||"outline"}configDefaultTwotoneColor(){let s=this.getConfig().nzTwotoneColor||Hi,c=Hi;s&&(s.startsWith("#")?c=s:D2("Twotone color must be a hex color!")),this.twoToneColor={primaryColor:c}}getConfig(){return this.nzConfigService.getConfigForComponent("icon")||{}}};e.\u0275fac=function(s){return new(s||e)(g(b2),g(x2),g(Vi),g(Ei),g(H2,8),g(E2,8),g(xi,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Si=new H("nz_icons_patch"),zr=(()=>{let e=class e{constructor(i,s){this.extraIcons=i,this.rootIconService=s,this.patched=!1}doPatch(){this.patched||(this.extraIcons.forEach(i=>this.rootIconService.addIcon(i)),this.patched=!0)}};e.\u0275fac=function(s){return new(s||e)(g(Si,2),g(_r))},e.\u0275prov=j({token:e,factory:e.\u0275fac});let t=e;return t})();var Hf=(()=>{let e=class e{static forRoot(i){return{ngModule:e,providers:[{provide:xi,useValue:i}]}}static forChild(i){return{ngModule:e,providers:[zr,{provide:Si,useValue:i}]}}};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=o1({type:e}),e.\u0275inj=r1({});let t=e;return t})();var Ri=(()=>{let e=class e{constructor(i,s){this._renderer=i,this._elementRef=s,this.onChange=c=>{},this.onTouched=()=>{}}setProperty(i,s){this._renderer.setProperty(this._elementRef.nativeElement,i,s)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}};e.\u0275fac=function(s){return new(s||e)(N(pe),N(ve))},e.\u0275dir=w1({type:e});let t=e;return t})(),wr=(()=>{let e=class e extends Ri{};e.\u0275fac=(()=>{let i;return function(c){return(i||(i=N0(e)))(c||e)}})(),e.\u0275dir=w1({type:e,features:[W1]});let t=e;return t})(),Fi=new H("");var Mr={provide:Fi,useExisting:y2(()=>Ni),multi:!0};function yr(){let t=f8()?f8().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var br=new H(""),Ni=(()=>{let e=class e extends Ri{constructor(i,s,c){super(i,s),this._compositionMode=c,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!yr())}writeValue(i){let s=i??"";this.setProperty("value",s)}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}};e.\u0275fac=function(s){return new(s||e)(N(pe),N(ve),N(br,8))},e.\u0275dir=w1({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(s,c){s&1&&u8("input",function(r){return c._handleInput(r.target.value)})("blur",function(){return c.onTouched()})("compositionstart",function(){return c._compositionStart()})("compositionend",function(r){return c._compositionEnd(r.target.value)})},features:[V2([Mr]),W1]});let t=e;return t})();var Pi=new H(""),qi=new H("");function Ui(t){return t!=null}function ji(t){return U0(t)?O4(t):t}function Wi(t){let e={};return t.forEach(n=>{e=n!=null?F(F({},e),n):e}),Object.keys(e).length===0?null:e}function Gi(t,e){return e.map(n=>n(t))}function Cr(t){return!t.validate}function $i(t){return t.map(e=>Cr(e)?e:n=>e.validate(n))}function Vr(t){if(!t)return null;let e=t.filter(Ui);return e.length==0?null:function(n){return Wi(Gi(n,e))}}function Ki(t){return t!=null?Vr($i(t)):null}function Er(t){if(!t)return null;let e=t.filter(Ui);return e.length==0?null:function(n){let i=Gi(n,e).map(ji);return S0(i).pipe(G(Wi))}}function Yi(t){return t!=null?Er($i(t)):null}function Ti(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function Qi(t){return t._rawValidators}function Zi(t){return t._rawAsyncValidators}function A8(t){return t?Array.isArray(t)?t:[t]:[]}function q2(t,e){return Array.isArray(t)?t.includes(e):t===e}function Li(t,e){let n=A8(e);return A8(t).forEach(s=>{q2(n,s)||n.push(s)}),n}function Ai(t,e){return A8(e).filter(n=>!q2(t,n))}var U2=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ki(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Yi(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},F4=class extends U2{get formDirective(){return null}get path(){return null}},Ve=class extends U2{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},j2=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},Hr={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Kf=f1(F({},Hr),{"[class.ng-submitted]":"isSubmitted"}),Yf=(()=>{let e=class e extends j2{constructor(i){super(i)}};e.\u0275fac=function(s){return new(s||e)(N(Ve,2))},e.\u0275dir=w1({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(s,c){s&2&&C2("ng-untouched",c.isUntouched)("ng-touched",c.isTouched)("ng-pristine",c.isPristine)("ng-dirty",c.isDirty)("ng-valid",c.isValid)("ng-invalid",c.isInvalid)("ng-pending",c.isPending)},features:[W1]});let t=e;return t})(),Qf=(()=>{let e=class e extends j2{constructor(i){super(i)}};e.\u0275fac=function(s){return new(s||e)(N(F4,10))},e.\u0275dir=w1({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(s,c){s&2&&C2("ng-untouched",c.isUntouched)("ng-touched",c.isTouched)("ng-pristine",c.isPristine)("ng-dirty",c.isDirty)("ng-valid",c.isValid)("ng-invalid",c.isInvalid)("ng-pending",c.isPending)("ng-submitted",c.isSubmitted)},features:[W1]});let t=e;return t})();var be="VALID",N2="INVALID",R4="PENDING",Ce="DISABLED";function k8(t){return(K2(t)?t.validators:t)||null}function xr(t){return Array.isArray(t)?Ki(t):t||null}function B8(t,e){return(K2(e)?e.asyncValidators:t)||null}function Sr(t){return Array.isArray(t)?Yi(t):t||null}function K2(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function Xi(t,e,n){let i=t.controls;if(!(e?Object.keys(i):i).length)throw new M2(1e3,"");if(!i[n])throw new M2(1001,"")}function Ji(t,e,n){t._forEachChild((i,s)=>{if(n[s]===void 0)throw new M2(1002,"")})}var N4=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===be}get invalid(){return this.status===N2}get pending(){return this.status==R4}get disabled(){return this.status===Ce}get enabled(){return this.status!==Ce}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Li(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Li(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Ai(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Ai(e,this._rawAsyncValidators))}hasValidator(e){return q2(this._rawValidators,e)}hasAsyncValidator(e){return q2(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=R4,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Ce,this.errors=null,this._forEachChild(i=>{i.disable(f1(F({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(f1(F({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=be,this._forEachChild(i=>{i.enable(f1(F({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(f1(F({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===be||this.status===R4)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ce:be}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=R4,this._hasOwnPendingAsyncValidator=!0;let n=ji(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((i,s)=>i&&i._find(s),this)}getError(e,n){let i=n?this.get(n):this;return i&&i.errors?i.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new de,this.statusChanges=new de}_calculateStatus(){return this._allControlsDisabled()?Ce:this.errors?N2:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(R4)?R4:this._anyControlsHaveStatus(N2)?N2:be}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){K2(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=xr(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=Sr(this._rawAsyncValidators)}},W2=class extends N4{constructor(e,n,i){super(k8(n),B8(i,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,i={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){Ji(this,!0,e),Object.keys(e).forEach(i=>{Xi(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(i=>{let s=this.controls[i];s&&s.patchValue(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((i,s)=>{i.reset(e?e[s]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,i)=>(e[i]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,i)=>i._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let i=this.controls[n];i&&e(i,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,i]of Object.entries(this.controls))if(this.contains(n)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,i,s)=>((i.enabled||this.disabled)&&(n[s]=i.value),n))}_reduceChildren(e,n){let i=e;return this._forEachChild((s,c)=>{i=n(i,s,c)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var O8=class extends W2{};var D8=new H("CallSetDisabledState",{providedIn:"root",factory:()=>Y2}),Y2="always";function Tr(t,e){return[...e.path,t]}function Oi(t,e,n=Y2){R8(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),Ar(t,e),Ir(t,e),Or(t,e),Lr(t,e)}function Ii(t,e,n=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),$2(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function G2(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function Lr(t,e){if(e.valueAccessor.setDisabledState){let n=i=>{e.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function R8(t,e){let n=Qi(t);e.validator!==null?t.setValidators(Ti(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let i=Zi(t);e.asyncValidator!==null?t.setAsyncValidators(Ti(i,e.asyncValidator)):typeof i=="function"&&t.setAsyncValidators([i]);let s=()=>t.updateValueAndValidity();G2(e._rawValidators,s),G2(e._rawAsyncValidators,s)}function $2(t,e){let n=!1;if(t!==null){if(e.validator!==null){let s=Qi(t);if(Array.isArray(s)&&s.length>0){let c=s.filter(o=>o!==e.validator);c.length!==s.length&&(n=!0,t.setValidators(c))}}if(e.asyncValidator!==null){let s=Zi(t);if(Array.isArray(s)&&s.length>0){let c=s.filter(o=>o!==e.asyncValidator);c.length!==s.length&&(n=!0,t.setAsyncValidators(c))}}}let i=()=>{};return G2(e._rawValidators,i),G2(e._rawAsyncValidators,i),n}function Ar(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&e5(t,e)})}function Or(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&e5(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function e5(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function Ir(t,e){let n=(i,s)=>{e.valueAccessor.writeValue(i),s&&e.viewToModelUpdate(i)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function kr(t,e){t==null,R8(t,e)}function Br(t,e){return $2(t,e)}function Dr(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function Rr(t){return Object.getPrototypeOf(t.constructor)===wr}function Fr(t,e){t._syncPendingControls(),e.forEach(n=>{let i=n.control;i.updateOn==="submit"&&i._pendingChange&&(n.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function Nr(t,e){if(!e)return null;Array.isArray(e);let n,i,s;return e.forEach(c=>{c.constructor===Ni?n=c:Rr(c)?i=c:s=c}),s||i||n||null}function Pr(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function ki(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Bi(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var P2=class extends N4{constructor(e=null,n,i){super(k8(n),B8(i,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),K2(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Bi(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){ki(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){ki(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Bi(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var qr=t=>t instanceof P2;var Xf=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275dir=w1({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})();var t5=new H("");var Ur={provide:F4,useExisting:y2(()=>jr)},jr=(()=>{let e=class e extends F4{constructor(i,s,c){super(),this.callSetDisabledState=c,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new de,this._setValidators(i),this._setAsyncValidators(s)}ngOnChanges(i){this._checkFormPresent(),i.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&($2(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(i){let s=this.form.get(i.path);return Oi(s,i,this.callSetDisabledState),s.updateValueAndValidity({emitEvent:!1}),this.directives.push(i),s}getControl(i){return this.form.get(i.path)}removeControl(i){Ii(i.control||null,i,!1),Pr(this.directives,i)}addFormGroup(i){this._setUpFormContainer(i)}removeFormGroup(i){this._cleanUpFormContainer(i)}getFormGroup(i){return this.form.get(i.path)}addFormArray(i){this._setUpFormContainer(i)}removeFormArray(i){this._cleanUpFormContainer(i)}getFormArray(i){return this.form.get(i.path)}updateModel(i,s){this.form.get(i.path).setValue(s)}onSubmit(i){return this.submitted=!0,Fr(this.form,this.directives),this.ngSubmit.emit(i),i?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this.submitted=!1}_updateDomValue(){this.directives.forEach(i=>{let s=i.control,c=this.form.get(i.path);s!==c&&(Ii(s||null,i),qr(c)&&(Oi(c,i,this.callSetDisabledState),i.control=c))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(i){let s=this.form.get(i.path);kr(s,i),s.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(i){if(this.form){let s=this.form.get(i.path);s&&Br(s,i)&&s.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){R8(this.form,this),this._oldForm&&$2(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(s){return new(s||e)(N(Pi,10),N(qi,10),N(D8,8))},e.\u0275dir=w1({type:e,selectors:[["","formGroup",""]],hostBindings:function(s,c){s&1&&u8("submit",function(r){return c.onSubmit(r)})("reset",function(){return c.onReset()})},inputs:{form:[fe.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[V2([Ur]),W1,me]});let t=e;return t})();var Wr={provide:Ve,useExisting:y2(()=>Gr)},Gr=(()=>{let e=class e extends Ve{set isDisabled(i){}constructor(i,s,c,o,r){super(),this._ngModelWarningConfig=r,this._added=!1,this.name=null,this.update=new de,this._ngModelWarningSent=!1,this._parent=i,this._setValidators(s),this._setAsyncValidators(c),this.valueAccessor=Nr(this,o)}ngOnChanges(i){this._added||this._setUpControl(),Dr(i,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}get path(){return Tr(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(s){return new(s||e)(N(F4,13),N(Pi,10),N(qi,10),N(Fi,10),N(t5,8))},e.\u0275dir=w1({type:e,selectors:[["","formControlName",""]],inputs:{name:[fe.None,"formControlName","name"],isDisabled:[fe.None,"disabled","isDisabled"],model:[fe.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[V2([Wr]),W1,me]});let t=e;return t})();var n5=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=o1({type:e}),e.\u0275inj=r1({});let t=e;return t})(),I8=class extends N4{constructor(e,n,i){super(k8(n),B8(i,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,n={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(e,n,i={}){this.controls.splice(e,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(e,n,i={}){let s=this._adjustIndex(e);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),n&&(this.controls.splice(s,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,n={}){Ji(this,!1,e),e.forEach((i,s)=>{Xi(this,!1,s),this.at(s).setValue(i,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(e.forEach((i,s)=>{this.at(s)&&this.at(s).patchValue(i,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e=[],n={}){this._forEachChild((i,s)=>{i.reset(e[s],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((n,i)=>i._syncPendingControls()?!0:n,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((n,i)=>{e(n,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(n=>n.enabled&&e(n))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function Di(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var Jf=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let i=new e;return i.useNonNullable=!0,i}group(i,s=null){let c=this._reduceControls(i),o={};return Di(s)?o=s:s!==null&&(o.validators=s.validator,o.asyncValidators=s.asyncValidator),new W2(c,o)}record(i,s=null){let c=this._reduceControls(i);return new O8(c,s)}control(i,s,c){let o={};return this.useNonNullable?(Di(s)?o=s:(o.validators=s,o.asyncValidators=c),new P2(i,f1(F({},o),{nonNullable:!0}))):new P2(i,s,c)}array(i,s,c){let o=i.map(r=>this._createControl(r));return new I8(o,s,c)}_reduceControls(i){let s={};return Object.keys(i).forEach(c=>{s[c]=this._createControl(i[c])}),s}_createControl(i){if(i instanceof P2)return i;if(i instanceof N4)return i;if(Array.isArray(i)){let s=i[0],c=i.length>1?i[1]:null,o=i.length>2?i[2]:null;return this.control(s,c,o)}else return this.control(i)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var ev=(()=>{let e=class e{static withConfig(i){return{ngModule:e,providers:[{provide:D8,useValue:i.callSetDisabledState??Y2}]}}};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=o1({type:e}),e.\u0275inj=r1({imports:[n5]});let t=e;return t})(),tv=(()=>{let e=class e{static withConfig(i){return{ngModule:e,providers:[{provide:t5,useValue:i.warnOnNgModelWithFormControl??"always"},{provide:D8,useValue:i.callSetDisabledState??Y2}]}}};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=o1({type:e}),e.\u0275inj=r1({imports:[n5]});let t=e;return t})();var $r="firebase",Kr="10.10.0";$1($r,Kr,"app");var P4=new d8("ANGULARFIRE2_VERSION");var Yr=(t,e)=>{let n=e?[e]:rn(),i=[];return n.forEach(s=>{s.container.getProvider(t).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i},v4=class{constructor(){return Yr(Qr)}},Qr="app-check";function F8(){}var Q2=class{zone;delegate;constructor(e,n=x0){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,i){let s=this.zone,c=function(o){s.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(c,n,i)}},N8=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",F8,{},F8,F8)),n.pipe(w2({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Z2=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Q2(Zone.current)),this.insideAngular=n.run(()=>new Q2(Zone.current,_2)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||t)(g(k1))};static \u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Zr(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function F1(t){return Xr(Zr())(t)}function Xr(t){return function(n){return n=n.lift(new N8(t.ngZone)),n.pipe(A4(t.outsideAngular),h4(t.insideAngular))}}var Jr="firebase",ea="10.10.0";t1.registerVersion(Jr,ea,"app-compat");var ta=["ngOnDestroy"],c5=(t,e,n,i={})=>new Proxy(t,{get:(s,c)=>n.runOutsideAngular(()=>{if(t[c])return i?.spy?.get&&i.spy.get(c,t[c]),t[c];if(ta.indexOf(c)>-1)return()=>{};let o=e.toPromise().then(r=>{let a=r?.[c];return typeof a=="function"?a.bind(r):a?.then?a.then(l=>n.run(()=>l)):n.run(()=>a)});return new Proxy(()=>{},{get:(r,a)=>o[a],apply:(r,a,l)=>o.then(h=>{let u=h?.(...l);return i?.spy?.apply&&i.spy.apply(c,l,u),u})})})});var X2=class{constructor(e){return e}},q4=new H("angularfire2.app.options"),U4=new H("angularfire2.app.name");function Ee(t,e,n){let i=typeof n=="string"&&n||"[DEFAULT]",s=typeof n=="object"&&n||{};s.name=s.name||i;let o=t1.apps.filter(r=>r&&r.name===s.name)[0]||e.runOutsideAngular(()=>t1.initializeApp(t,s));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let r=!!module.hot;na("error",`${o.name} Firebase App already initialized with different options${r?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new X2(o)}var na=(t,...e)=>{u4()&&typeof console<"u"&&console[t](...e)},ia={provide:X2,useFactory:Ee,deps:[q4,k1,[new F0,U4]]},wv=(()=>{class t{static initializeApp(n,i){return{ngModule:t,providers:[{provide:q4,useValue:n},{provide:U4,useValue:i}]}}constructor(n){t1.registerVersion("angularfire",P4.full,"core"),t1.registerVersion("angularfire",P4.full,"app-compat"),t1.registerVersion("angular",q0.full,n.toString())}static \u0275fac=function(i){return new(i||t)(g(j1))};static \u0275mod=o1({type:t});static \u0275inj=r1({providers:[ia]})}return t})();function J2(t,e,n,i,s){let[,c,o]=globalThis.\u0275AngularfireInstanceCache.find(r=>r[0]===t)||[];if(c)return sa(s,o)||(s5("error",`${e} was already initialized on the ${n} Firebase App with different settings.${ca?" You may need to reload as Firebase is not HMR aware.":""}`),s5("warn",{is:s,was:o})),c;{let r=i();return globalThis.\u0275AngularfireInstanceCache.push([t,r,s]),r}}function sa(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var ca=typeof module<"u"&&!!module.hot,s5=(t,...e)=>{u4()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var aa=new Map,la={activated:!1,tokenObservers:[]},ha={initialized:!1,enabled:!1};function y1(t){return aa.get(t)||Object.assign({},la)}function h5(){return ha}var ua="https://content-firebaseappcheck.googleapis.com/v1";var da="exchangeDebugToken",o5={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Tv=24*60*60*1e3;var q8=class{constructor(e,n,i,s,c){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=i,this.lowerBound=s,this.upperBound=c,this.pending=null,this.nextErrorWaitInterval=s,s>c)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return V1(this,null,function*(){this.stop();try{this.pending=new P,this.pending.promise.catch(n=>{}),yield fa(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new P,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function fa(t){return new Promise(e=>{setTimeout(e,t)})}var va={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Z1=new X0("appCheck","AppCheck",va);function u5(t){if(!y1(t).activated)throw Z1.create("use-before-activation",{appName:t.name})}function d5(i,s){return V1(this,arguments,function*({url:t,body:e},n){let c={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let v=yield o.getHeartbeatsHeader();v&&(c["X-Firebase-Client"]=v)}let r={method:"POST",body:JSON.stringify(e),headers:c},a;try{a=yield fetch(t,r)}catch(v){throw Z1.create("fetch-network-error",{originalErrorMessage:v?.message})}if(a.status!==200)throw Z1.create("fetch-status-error",{httpStatus:a.status});let l;try{l=yield a.json()}catch(v){throw Z1.create("fetch-parse-error",{originalErrorMessage:v?.message})}let h=l.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw Z1.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let u=Number(h[1])*1e3,d=Date.now();return{token:l.token,expireTimeMillis:d+u,issuedAtTimeMillis:d}})}function f5(t,e){let{projectId:n,appId:i,apiKey:s}=t.options;return{url:`${ua}/projects/${n}/apps/${i}:${da}?key=${s}`,body:{debug_token:e}}}var ma="firebase-app-check-database",pa=1,U8="firebase-app-check-store";var e3=null;function ga(){return e3||(e3=new Promise((t,e)=>{try{let n=indexedDB.open(ma,pa);n.onsuccess=i=>{t(i.target.result)},n.onerror=i=>{var s;e(Z1.create("storage-open",{originalErrorMessage:(s=i.target.error)===null||s===void 0?void 0:s.message}))},n.onupgradeneeded=i=>{let s=i.target.result;switch(i.oldVersion){case 0:s.createObjectStore(U8,{keyPath:"compositeKey"})}}}catch(n){e(Z1.create("storage-open",{originalErrorMessage:n?.message}))}}),e3)}function _a(t,e){return za(wa(t),e)}function za(t,e){return V1(this,null,function*(){let i=(yield ga()).transaction(U8,"readwrite"),c=i.objectStore(U8).put({compositeKey:t,value:e});return new Promise((o,r)=>{c.onsuccess=a=>{o()},i.onerror=a=>{var l;r(Z1.create("storage-set",{originalErrorMessage:(l=a.target.error)===null||l===void 0?void 0:l.message}))}})})}function wa(t){return`${t.options.appId}-${t.name}`}var j8=new B4("@firebase/app-check");function P8(t,e){return Z0()?_a(t,e).catch(n=>{j8.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function v5(){return h5().enabled}function m5(){return V1(this,null,function*(){let t=h5();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Ma={error:"UNKNOWN_ERROR"};function ya(t){return S2.encodeString(JSON.stringify(t),!1)}function W8(t,e=!1){return V1(this,null,function*(){let n=t.app;u5(n);let i=y1(n),s=i.token,c;if(s&&!He(s)&&(i.token=void 0,s=void 0),!s){let a=yield i.cachedTokenPromise;a&&(He(a)?s=a:yield P8(n,void 0))}if(!e&&s&&He(s))return{token:s.token};let o=!1;if(v5()){i.exchangeTokenPromise||(i.exchangeTokenPromise=d5(f5(n,yield m5()),t.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),o=!0);let a=yield i.exchangeTokenPromise;return yield P8(n,a),i.token=a,{token:a.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),o=!0),s=yield y1(n).exchangeTokenPromise}catch(a){a.code==="appCheck/throttled"?j8.warn(a.message):j8.error(a),c=a}let r;return s?c?He(s)?r={token:s.token,internalError:c}:r=a5(c):(r={token:s.token},i.token=s,yield P8(n,s)):r=a5(c),o&&Ea(n,r),r})}function ba(t){return V1(this,null,function*(){let e=t.app;u5(e);let{provider:n}=y1(e);if(v5()){let i=yield m5(),{token:s}=yield d5(f5(e,i),t.heartbeatServiceProvider);return{token:s}}else{let{token:i}=yield n.getToken();return{token:i}}})}function Ca(t,e,n,i){let{app:s}=t,c=y1(s),o={next:n,error:i,type:e};if(c.tokenObservers=[...c.tokenObservers,o],c.token&&He(c.token)){let r=c.token;Promise.resolve().then(()=>{n({token:r.token}),r5(t)}).catch(()=>{})}c.cachedTokenPromise.then(()=>r5(t))}function p5(t,e){let n=y1(t),i=n.tokenObservers.filter(s=>s.next!==e);i.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=i}function r5(t){let{app:e}=t,n=y1(e),i=n.tokenRefresher;i||(i=Va(t),n.tokenRefresher=i),!i.isRunning()&&n.isTokenAutoRefreshEnabled&&i.start()}function Va(t){let{app:e}=t;return new q8(()=>V1(this,null,function*(){let n=y1(e),i;if(n.token?i=yield W8(t,!0):i=yield W8(t),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{let n=y1(e);if(n.token){let i=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,s=n.token.expireTimeMillis-5*60*1e3;return i=Math.min(i,s),Math.max(0,i-Date.now())}else return 0},o5.RETRIAL_MIN_WAIT,o5.RETRIAL_MAX_WAIT)}function Ea(t,e){let n=y1(t).tokenObservers;for(let i of n)try{i.type==="EXTERNAL"&&e.error!=null?i.error(e.error):i.next(e)}catch{}}function He(t){return t.expireTimeMillis-Date.now()>0}function a5(t){return{token:ya(Ma),error:t}}var G8=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=y1(this.app);for(let n of e)p5(this.app,n.next);return Promise.resolve()}};function Ha(t,e){return new G8(t,e)}function xa(t){return{getToken:e=>W8(t,e),getLimitedUseToken:()=>ba(t),addTokenListener:e=>Ca(t,"INTERNAL",e),removeTokenListener:e=>p5(t.app,e)}}var Sa="@firebase/app-check",Ta="0.8.3";var La="app-check",l5="app-check-internal";function Aa(){ze(new B1(La,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return Ha(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(l5).initialize()})),ze(new B1(l5,t=>{let e=t.getProvider("app-check").getImmediate();return xa(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),$1(Sa,Ta)}Aa();var Oa=["localhost","0.0.0.0","127.0.0.1"],qv=typeof window<"u"&&Oa.includes(window.location.hostname);var $8=new H("angularfire2.auth.use-emulator"),K8=new H("angularfire2.auth.settings"),Y8=new H("angularfire2.auth.tenant-id"),Q8=new H("angularfire2.auth.langugage-code"),Z8=new H("angularfire2.auth.use-device-language"),X8=new H("angularfire.auth.persistence"),J8=(t,e,n,i,s,c,o,r)=>J2(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let a=e.runOutsideAngular(()=>t.auth());if(n&&a.useEmulator(...n),i&&(a.tenantId=i),a.languageCode=s,c&&a.useDeviceLanguage(),o)for(let[l,h]of Object.entries(o))a.settings[l]=h;return r&&a.setPersistence(r),a},[n,i,s,c,o,r]),_5=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,i,s,c,o,r,a,l,h,u,d,v){let m=new U1,w=z1(void 0).pipe(h4(o.outsideAngular),I1(()=>c.runOutsideAngular(()=>import("./chunk-RY3T2HD6.mjs"))),G(()=>Ee(n,c,i)),G(x=>J8(x,c,r,l,h,u,a,d)),l8({bufferSize:1,refCount:!1}));if(W0(s))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=z1(null);else{w.pipe(k0()).subscribe();let x=w.pipe(I1(A=>A.getRedirectResult().then(_1=>_1,()=>null)),F1,l8({bufferSize:1,refCount:!1})),s1=w.pipe(I1(A=>new q1(_1=>({unsubscribe:c.runOutsideAngular(()=>A.onAuthStateChanged(l4=>_1.next(l4),l4=>_1.error(l4),()=>_1.complete()))})))),c1=w.pipe(I1(A=>new q1(_1=>({unsubscribe:c.runOutsideAngular(()=>A.onIdTokenChanged(l4=>_1.next(l4),l4=>_1.error(l4),()=>_1.complete()))}))));this.authState=x.pipe(h8(s1),A4(o.outsideAngular),h4(o.insideAngular)),this.user=x.pipe(h8(c1),A4(o.outsideAngular),h4(o.insideAngular)),this.idToken=this.user.pipe(I1(A=>A?O4(A.getIdToken()):z1(null))),this.idTokenResult=this.user.pipe(I1(A=>A?O4(A.getIdTokenResult()):z1(null))),this.credential=ue(x,m,this.authState.pipe(I4(A=>!A))).pipe(G(A=>A?.user?A:null),A4(o.outsideAngular),h4(o.insideAngular))}return c5(this,w,c,{spy:{apply:(x,s1,c1)=>{(x.startsWith("signIn")||x.startsWith("createUser"))&&c1.then(A=>m.next(A))}}})}static \u0275fac=function(i){return new(i||t)(g(q4),g(U4,8),g(j1),g(k1),g(Z2),g($8,8),g(K8,8),g(Y8,8),g(Q8,8),g(Z8,8),g(X8,8),g(v4,8))};static \u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var Ac=Co(Js(),1);var _3="5",Oc="v",Ic="s",kc="r",Bc="f",Dc=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Rc="ls",Fc="p",P6="ac",Nc="websocket",Pc="long_polling";var q6=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),B(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:T2(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var U6=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return v1(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var qc=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new q6(e)}}catch{}return new U6},C4=qc("localStorage"),j6=qc("sessionStorage");var Z4=new B4("@firebase/database"),Uc=function(){let t=1;return function(){return t++}}(),jc=function(t){let e=sn(t),n=new nn;n.update(e);let i=n.digest();return S2.encodeByteArray(i)},a2=function(...t){let e="";for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=a2.apply(null,i):typeof i=="object"?e+=B(i):e+=i,e+=" "}return e},V4=null,ec=!0,Wc=function(t,e){f(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Z4.logLevel=cn.VERBOSE,V4=Z4.log.bind(Z4),e&&j6.set("logging_enabled",!0)):typeof t=="function"?V4=t:(V4=null,j6.remove("logging_enabled"))},q=function(...t){if(ec===!0&&(ec=!1,V4===null&&j6.get("logging_enabled")===!0&&Wc(!0)),V4){let e=a2.apply(null,t);V4(e)}},l2=function(t){return function(...e){q(t,...e)}},W6=function(...t){let e="FIREBASE INTERNAL ERROR: "+a2(...t);Z4.error(e)},L1=function(...t){let e=`FIREBASE FATAL ERROR: ${a2(...t)}`;throw Z4.error(e),new Error(e)},$=function(...t){let e="FIREBASE WARNING: "+a2(...t);Z4.warn(e)},Pl=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&$("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},U3=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},ql=function(t){if(E1()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},i4="[MIN_NAME]",N1="[MAX_NAME]",H4=function(t,e){if(t===e)return 0;if(t===i4||e===N1)return-1;if(e===i4||t===N1)return 1;{let n=tc(t),i=tc(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},Ul=function(t,e){return t===e?0:t<e?-1:1},Re=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+B(e))},Wt=function(t){if(typeof t!="object"||t===null)return B(t);let e=[];for(let i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=B(e[i]),n+=":",n+=Wt(t[e[i]]);return n+="}",n},Gc=function(t,e){let n=t.length;if(n<=e)return[t];let i=[];for(let s=0;s<n;s+=e)s+e>n?i.push(t.substring(s,n)):i.push(t.substring(s,s+e));return i};function U(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var $c=function(t){f(!U3(t),"Invalid JSON number");let e=11,n=52,i=(1<<e-1)-1,s,c,o,r,a;t===0?(c=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(r=Math.min(Math.floor(Math.log(t)/Math.LN2),i),c=r+i,o=Math.round(t*Math.pow(2,n-r)-Math.pow(2,n))):(c=0,o=Math.round(t/Math.pow(2,1-i-n))));let l=[];for(a=n;a;a-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(a=e;a;a-=1)l.push(c%2?1:0),c=Math.floor(c/2);l.push(s?1:0),l.reverse();let h=l.join(""),u="";for(a=0;a<64;a+=8){let d=parseInt(h.substr(a,8),2).toString(16);d.length===1&&(d="0"+d),u=u+d}return u.toLowerCase()},jl=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Wl=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Gl(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}var $l=new RegExp("^-?(0*)\\d{1,10}$"),Kl=-2147483648,Yl=2147483647,tc=function(t){if($l.test(t)){let e=Number(t);if(e>=Kl&&e<=Yl)return e}return null},oe=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw $("Exception was thrown by user callback.",n),e},Math.floor(0))}},Ql=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},qe=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var z3=class{constructor(e,n,i,s,c=!1,o="",r=!1,a=!1){this.secure=n,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=c,this.persistenceKey=o,this.includeNamespaceInQueryParams=r,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=C4.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&C4.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function Zl(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Kc(t,e,n){f(typeof e=="string","typeof type must == string"),f(typeof n=="object","typeof params must == object");let i;if(e===Nc)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Pc)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Zl(t)&&(n.ns=t.namespace);let s=[];return U(n,(c,o)=>{s.push(c+"="+o)}),i+s.join("&")}var G6=class{constructor(){this.counters_={}}incrementCounter(e,n=1){v1(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return K0(this.counters_)}};var I6={},k6={};function Gt(t){let e=t.toString();return I6[e]||(I6[e]=new G6),I6[e]}function Xl(t,e){let n=t.toString();return k6[n]||(k6[n]=e()),k6[n]}var $t="";function Kt(t){$t=t}var Jl=16384,e9=45e3,$e=null;typeof MozWebSocket<"u"?$e=MozWebSocket:typeof WebSocket<"u"&&($e=WebSocket);function t9(t){$e=t}var Y4=(()=>{class t{constructor(n,i,s,c,o,r,a){this.connId=n,this.applicationId=s,this.appCheckToken=c,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=l2(this.connId),this.stats_=Gt(i),this.connURL=t.connectionURL_(i,r,a,c,s),this.nodeAdmin=i.nodeAdmin}static connectionURL_(n,i,s,c,o){let r={};return r[Oc]=_3,!E1()&&typeof location<"u"&&location.hostname&&Dc.test(location.hostname)&&(r[kc]=Bc),i&&(r[Ic]=i),s&&(r[Rc]=s),c&&(r[P6]=c),o&&(r[Fc]=o),Kc(n,Nc,r)}open(n,i){this.onDisconnect=i,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,C4.set("previous_websocket_failure",!0);try{let s;if(E1()){let c=this.nodeAdmin?"AdminNode":"Node";s={headers:{"User-Agent":`Firebase/${_3}/${$t}/${process.platform}/${c}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(s.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(s.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,r=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;r&&(s.proxy={origin:r})}this.mySock=new $e(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");let c=s.message||s.data;c&&this.log_(c),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");let c=s.message||s.data;c&&this.log_(c),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(i);s&&s.length>1&&parseFloat(s[1])<4.4&&(n=!0)}return!n&&$e!==null&&!t.forceDisallow_}static previouslyFailed(){return C4.isInMemoryStorage||C4.get("previous_websocket_failure")===!0}markConnectionHealthy(){C4.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let s=T2(i);this.onMessage(s)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(f(this.frames===null,"We already have a frame buffer"),n.length<=6){let i=Number(n);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let i=n.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let s=this.extractFrameCount_(i);s!==null&&this.appendFrame_(s)}}send(n){this.resetKeepAlive();let i=B(n);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let s=Gc(i,Jl);s.length>1&&this.sendString_(String(s.length));for(let c=0;c<s.length;c++)this.sendString_(s[c])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(e9))}sendString_(n){try{this.mySock.send(n)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t})(),nc="@firebase/database",ic="1.0.4";var $6=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){$(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var K6=class{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(q("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',$(e)}},Ue=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Y6=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&oe(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var sc="start",n9="close",i9="pLPCommand",s9="pRTLPCB",Yc="id",Qc="pw",Zc="ser",c9="cb",o9="seg",r9="ts",a9="d",l9="dframe",Xc=1870,Jc=30,h9=Xc-Jc,u9=25e3,d9=3e4,Ke=class t{constructor(e,n,i,s,c,o,r){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=s,this.authToken=c,this.transportSessionId=o,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=l2(e),this.stats_=Gt(n),this.urlFn=a=>(this.appCheckToken&&(a[P6]=this.appCheckToken),Kc(n,Pc,a))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Y6(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(d9)),ql(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Q6((...c)=>{let[o,r,a,l,h]=c;if(this.incrementIncomingBytes_(c),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===sc)this.id=r,this.password=a;else if(o===n9)r?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(r,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...c)=>{let[o,r]=c;this.incrementIncomingBytes_(c),this.myPacketOrderer.handleResponse(o,r)},()=>{this.onClosed_()},this.urlFn);let i={};i[sc]="t",i[Zc]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[c9]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Oc]=_3,this.transportSessionId&&(i[Ic]=this.transportSessionId),this.lastSessionId&&(i[Rc]=this.lastSessionId),this.applicationId&&(i[Fc]=this.applicationId),this.appCheckToken&&(i[P6]=this.appCheckToken),typeof location<"u"&&location.hostname&&Dc.test(location.hostname)&&(i[kc]=Bc);let s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return E1()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!jl()&&!Wl()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=B(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let i=$0(n),s=Gc(i,h9);for(let c=0;c<s.length;c++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[c]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(E1())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[l9]="t",i[Yc]=e,i[Qc]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=B(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},Q6=class t{constructor(e,n,i,s){if(this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,E1())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=Uc(),window[i9+this.uniqueCallbackIdentifier]=e,window[s9+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let c="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(c='<script>document.domain="'+document.domain+'";</script>');let o="<html><body>"+c+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(r){q("frame writing exception"),r.stack&&q(r.stack),q(r)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||q("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[Yc]=this.myID,e[Qc]=this.myPW,e[Zc]=this.currentSerial;let n=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Jc+i.length<=Xc;){let o=this.pendingSegs.shift();i=i+"&"+o9+s+"="+o.seg+"&"+r9+s+"="+o.ts+"&"+a9+s+"="+o.d,s++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(i,Math.floor(u9)),c=()=>{clearTimeout(s),i()};this.addTag(e,c)}addTag(e,n){E1()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{q("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var e7=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Ke,Y4]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let i=Y4&&Y4.isAvailable(),s=i&&!Y4.previouslyFailed();if(n.webSocketOnly&&(i||$("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Y4];else{let c=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&c.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),f9=6e4,v9=5e3,m9=10*1024,p9=100*1024,B6="t",cc="d",g9="s",oc="r",_9="e",rc="o",ac="a",lc="n",hc="p",z9="h",Z6=class{constructor(e,n,i,s,c,o,r,a,l,h){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=c,this.onMessage_=o,this.onReady_=r,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=l2("c:"+this.id+":"),this.transportManager_=new e7(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));let s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=qe(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>p9?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>m9?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(B6 in e){let n=e[B6];n===ac?this.upgradeIfSecondaryHealthy_():n===oc?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===rc&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Re("t",e),i=Re("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:hc,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:ac,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:lc,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Re("t",e),i=Re("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Re(B6,e);if(cc in e){let i=e[cc];if(n===z9){let s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===lc){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===g9?this.onConnectionShutdown_(i):n===oc?this.onReset_(i):n===_9?W6("Server Error: "+i):n===rc?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):W6("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),_3!==i&&$("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),qe(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(f9))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):qe(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(v9))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:hc,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(C4.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var w3=class{put(e,n,i,s){}merge(e,n,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}};var M3=class{constructor(e){this.allowedEvents_=e,this.listeners_={},f(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});let s=this.getInitialEvent(e);s&&n.apply(i,s)}off(e,n,i){this.validateEventType_(e);let s=this.listeners_[e]||[];for(let c=0;c<s.length;c++)if(s[c].callback===n&&(!i||i===s[c].context)){s.splice(c,1);return}}validateEventType_(e){f(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var y3=class t extends M3{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!v8()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return f(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var uc=32,dc=768,V=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function C(){return new V("")}function M(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function s4(t){return t.pieces_.length-t.pieceNum_}function T(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new V(t.pieces_,e)}function Yt(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function w9(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Ye(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function t7(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new V(e,0)}function I(t,e){let n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof V)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{let i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&n.push(i[s])}return new V(n,0)}function y(t){return t.pieceNum_>=t.pieces_.length}function Z(t,e){let n=M(t),i=M(e);if(n===null)return e;if(n===i)return Z(T(t),T(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function M9(t,e){let n=Ye(t,0),i=Ye(e,0);for(let s=0;s<n.length&&s<i.length;s++){let c=H4(n[s],i[s]);if(c!==0)return c}return n.length===i.length?0:n.length<i.length?-1:1}function Qt(t,e){if(s4(t)!==s4(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function m1(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(s4(t)>s4(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}var X6=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Ye(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=_e(this.parts_[i]);n7(this)}};function y9(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=_e(e),n7(t)}function b9(t){let e=t.parts_.pop();t.byteLength_-=_e(e),t.parts_.length>0&&(t.byteLength_-=1)}function n7(t){if(t.byteLength_>dc)throw new Error(t.errorPrefix_+"has a key path longer than "+dc+" bytes ("+t.byteLength_+").");if(t.parts_.length>uc)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+uc+") or object contains a cycle "+b4(t))}function b4(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var J6=class t extends M3{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new t}getInitialEvent(e){return f(e==="visible","Unknown event type: "+e),[this.visible_]}};var Fe=1e3,C9=60*5*1e3,fc=30*1e3,V9=1.3,E9=3e4,H9="server_kill",vc=3,Zt=(()=>{class t extends w3{constructor(n,i,s,c,o,r,a,l){if(super(),this.repoInfo_=n,this.applicationId_=i,this.onDataUpdate_=s,this.onConnectStatus_=c,this.onServerInfoUpdate_=o,this.authTokenProvider_=r,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=l2("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Fe,this.maxReconnectDelay_=C9,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!E1())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");J6.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&y3.getInstance().on("online",this.onOnline_,this)}sendRequest(n,i,s){let c=++this.requestNumber_,o={r:c,a:n,b:i};this.log_(B(o)),f(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),s&&(this.requestCBHash_[c]=s)}get(n){this.initConnection_();let i=new P,c={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:r=>{let a=r.d;r.s==="ok"?i.resolve(a):i.reject(a)}};this.outstandingGets_.push(c),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),i.promise}listen(n,i,s,c){this.initConnection_();let o=n._queryIdentifier,r=n._path.toString();this.log_("Listen called for "+r+" "+o),this.listens.has(r)||this.listens.set(r,new Map),f(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),f(!this.listens.get(r).has(o),"listen() called twice for same path/queryId.");let a={onComplete:c,hashFn:i,query:n,tag:s};this.listens.get(r).set(o,a),this.connected_&&this.sendListen_(a)}sendGet_(n){let i=this.outstandingGets_[n];this.sendRequest("g",i.request,s=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(s)})}sendListen_(n){let i=n.query,s=i._path.toString(),c=i._queryIdentifier;this.log_("Listen on "+s+" for "+c);let o={p:s},r="q";n.tag&&(o.q=i._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(r,o,a=>{let l=a.d,h=a.s;t.warnOnListenWarnings_(l,i),(this.listens.get(s)&&this.listens.get(s).get(c))===n&&(this.log_("listen response",a),h!=="ok"&&this.removeListen_(s,c),n.onComplete&&n.onComplete(h,l))})}static warnOnListenWarnings_(n,i){if(n&&typeof n=="object"&&v1(n,"w")){let s=G1(n,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){let c='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();$(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${c} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||en(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=fc)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,i=J0(n)?"auth":"gauth",s={cred:n};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(i,s,c=>{let o=c.s,r=c.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let i=n.s,s=n.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,s)})}unlisten(n,i){let s=n._path.toString(),c=n._queryIdentifier;this.log_("Unlisten called for "+s+" "+c),f(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,c)&&this.connected_&&this.sendUnlisten_(s,c,n._queryObject,i)}sendUnlisten_(n,i,s,c){this.log_("Unlisten on "+n+" for "+i);let o={p:n},r="n";c&&(o.q=s,o.t=c),this.sendRequest(r,o)}onDisconnectPut(n,i,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,i,s):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:i,onComplete:s})}onDisconnectMerge(n,i,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,i,s):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:i,onComplete:s})}onDisconnectCancel(n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(n,i,s,c){let o={p:i,d:s};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,r=>{c&&setTimeout(()=>{c(r.s,r.d)},Math.floor(0))})}put(n,i,s,c){this.putInternal("p",n,i,s,c)}merge(n,i,s,c){this.putInternal("m",n,i,s,c)}putInternal(n,i,s,c,o){this.initConnection_();let r={p:i,d:s};o!==void 0&&(r.h=o),this.outstandingPuts_.push({action:n,request:r,onComplete:c}),this.outstandingPutCount_++;let a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+i)}sendPut_(n){let i=this.outstandingPuts_[n].action,s=this.outstandingPuts_[n].request,c=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(i,s,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),c&&c(o.s,o.d)})}reportStats(n){if(this.connected_){let i={c:n};this.log_("reportStats",i),this.sendRequest("s",i,s=>{if(s.s!=="ok"){let o=s.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+B(n));let i=n.r,s=this.requestCBHash_[i];s&&(delete this.requestCBHash_[i],s(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,i){this.log_("handleServerMessage",n,i),n==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):n==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):n==="c"?this.onListenRevoked_(i.p,i.q):n==="ac"?this.onAuthRevoked_(i.s,i.d):n==="apc"?this.onAppCheckRevoked_(i.s,i.d):n==="sd"?this.onSecurityDebugPacket_(i):W6("Unrecognized action received from server: "+B(n)+`
Are you using the latest client?`)}onReady_(n,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){f(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Fe,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Fe,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>E9&&(this.reconnectDelay_=Fe),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,i=Math.max(0,this.reconnectDelay_-n);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*V9)}this.onConnectStatus_(!1)}establishConnection_(){return V1(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),c=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,r=!1,a=null,l=function(){a?a.close():(r=!0,s())},h=function(d){f(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:l,sendRequest:h};let u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[d,v]=yield Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);r?q("getToken() completed but was canceled"):(q("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=v&&v.token,a=new Z6(c,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,i,s,m=>{$(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(H9)},o))}catch(d){this.log_("Failed to get token: "+d),r||(this.repoInfo_.nodeAdmin&&$(d),l())}}})}interrupt(n){q("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){q("Resuming connection for reason: "+n),delete this.interruptReasons_[n],L2(this.interruptReasons_)&&(this.reconnectDelay_=Fe,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let i=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let i=this.outstandingPuts_[n];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,i){let s;i?s=i.map(o=>Wt(o)).join("$"):s="default";let c=this.removeListen_(n,s);c&&c.onComplete&&c.onComplete("permission_denied")}removeListen_(n,i){let s=new V(n).toString(),c;if(this.listens.has(s)){let o=this.listens.get(s);c=o.get(i),o.delete(i),o.size===0&&this.listens.delete(s)}else c=void 0;return c}onAuthRevoked_(n,i){q("Auth token revoked: "+n+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=vc&&(this.reconnectDelay_=fc,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,i){q("App check token revoked: "+n+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=vc&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let i of n.values())this.sendListen_(i);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},i="js";E1()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),n["sdk."+i+"."+$t.replace(/\./g,"-")]=1,v8()?n["framework.cordova"]=1:Q0()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=y3.getInstance().currentlyOnline();return L2(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),b=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var X4=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let i=new b(i4,e),s=new b(i4,n);return this.compare(i,s)!==0}minPost(){return b.MIN}};var g3,b3=class extends X4{static get __EMPTY_NODE(){return g3}static set __EMPTY_NODE(e){g3=e}compare(e,n){return H4(e.name,n.name)}isDefinedOn(e){throw k4("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return b.MIN}maxPost(){return new b(N1,g3)}makePost(e,n){return f(typeof e=="string","KeyIndex indexValue must always be a string."),new b(e,g3)}toString(){return".key"}},T1=new b3;var Q4=class{constructor(e,n,i,s,c=null){this.isReverse_=s,this.resultGenerator_=c,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?i(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},b1=(()=>{class t{constructor(n,i,s,c,o){this.key=n,this.value=i,this.color=s??t.RED,this.left=c??p1.EMPTY_NODE,this.right=o??p1.EMPTY_NODE}copy(n,i,s,c,o){return new t(n??this.key,i??this.value,s??this.color,c??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,i,s){let c=this,o=s(n,c.key);return o<0?c=c.copy(null,null,null,c.left.insert(n,i,s),null):o===0?c=c.copy(null,i,null,null,null):c=c.copy(null,null,null,null,c.right.insert(n,i,s)),c.fixUp_()}removeMin_(){if(this.left.isEmpty())return p1.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,i){let s,c;if(s=this,i(n,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(n,i),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),i(n,s.key)===0){if(s.right.isEmpty())return p1.EMPTY_NODE;c=s.right.min_(),s=s.copy(c.key,c.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(n,i))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,i)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),et=class{copy(e,n,i,s,c){return this}insert(e,n,i){return new b1(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},p1=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,b1.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,b1.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,s=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Q4(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Q4(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Q4(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Q4(this.root_,null,this.comparator_,!0,e)}};p1.EMPTY_NODE=new et;function x9(t,e){return H4(t.name,e.name)}function Xt(t,e){return H4(t,e)}var tt;function S9(t){tt=t}var i7=function(t){return typeof t=="number"?"number:"+$c(t):"string:"+t},s7=function(t){if(t.isLeafNode()){let e=t.val();f(typeof e=="string"||typeof e=="number"||typeof e=="object"&&v1(e,".sv"),"Priority must be a string or number.")}else f(t===tt||t.isEmpty(),"priority of unexpected type.");f(t===tt||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var mc,J4=(()=>{class t{constructor(n,i=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=i,this.lazyHash_=null,f(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),s7(this.priorityNode_)}static set __childrenNodeConstructor(n){mc=n}static get __childrenNodeConstructor(){return mc}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return y(n)?this:M(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,i){return null}updateImmediateChild(n,i){return n===".priority"?this.updatePriority(i):i.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,i).updatePriority(this.priorityNode_)}updateChild(n,i){let s=M(n);return s===null?i:i.isEmpty()&&s!==".priority"?this:(f(s!==".priority"||s4(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(T(n),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,i){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+i7(this.priorityNode_.val())+":");let i=typeof this.value_;n+=i+":",i==="number"?n+=$c(this.value_):n+=this.value_,this.lazyHash_=jc(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(f(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let i=typeof n.value_,s=typeof this.value_,c=t.VALUE_TYPE_ORDER.indexOf(i),o=t.VALUE_TYPE_ORDER.indexOf(s);return f(c>=0,"Unknown leaf type: "+i),f(o>=0,"Unknown leaf type: "+s),c===o?s==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-c}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let i=n;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),c7,o7;function T9(t){c7=t}function L9(t){o7=t}var nt=class extends X4{compare(e,n){let i=e.node.getPriority(),s=n.node.getPriority(),c=i.compareTo(s);return c===0?H4(e.name,n.name):c}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return b.MIN}maxPost(){return new b(N1,new J4("[PRIORITY-POST]",o7))}makePost(e,n){let i=c7(e);return new b(n,new J4("[PRIORITY-POST]",i))}toString(){return".priority"}},L=new nt;var A9=Math.log(2),it=class{constructor(e){let n=c=>parseInt(Math.log(c)/A9,10),i=c=>parseInt(Array(c+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},C3=function(t,e,n,i){t.sort(e);let s=function(a,l){let h=l-a,u,d;if(h===0)return null;if(h===1)return u=t[a],d=n?n(u):u,new b1(d,u.node,b1.BLACK,null,null);{let v=parseInt(h/2,10)+a,m=s(a,v),w=s(v+1,l);return u=t[v],d=n?n(u):u,new b1(d,u.node,b1.BLACK,m,w)}},c=function(a){let l=null,h=null,u=t.length,d=function(m,w){let x=u-m,s1=u;u-=m;let c1=s(x+1,s1),A=t[x],_1=n?n(A):A;v(new b1(_1,A.node,w,null,c1))},v=function(m){l?(l.left=m,l=m):(h=m,l=m)};for(let m=0;m<a.count;++m){let w=a.nextBitIsOne(),x=Math.pow(2,a.count-(m+1));w?d(x,b1.BLACK):(d(x,b1.BLACK),d(x,b1.RED))}return h},o=new it(t.length),r=c(o);return new p1(i||e,r)};var D6,K4={},ee=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return f(K4&&L,"ChildrenNode.ts has not been loaded"),D6=D6||new t({".priority":K4},{".priority":L}),D6}get(e){let n=G1(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof p1?n:null}hasIndex(e){return v1(this.indexSet_,e.toString())}addIndex(e,n){f(e!==T1,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],s=!1,c=n.getIterator(b.Wrap),o=c.getNext();for(;o;)s=s||e.isDefinedOn(o.node),i.push(o),o=c.getNext();let r;s?r=C3(i,e.getCompare()):r=K4;let a=e.toString(),l=Object.assign({},this.indexSet_);l[a]=e;let h=Object.assign({},this.indexes_);return h[a]=r,new t(h,l)}addToIndexes(e,n){let i=ge(this.indexes_,(s,c)=>{let o=G1(this.indexSet_,c);if(f(o,"Missing index implementation for "+c),s===K4)if(o.isDefinedOn(e.node)){let r=[],a=n.getIterator(b.Wrap),l=a.getNext();for(;l;)l.name!==e.name&&r.push(l),l=a.getNext();return r.push(e),C3(r,o.getCompare())}else return K4;else{let r=n.get(e.name),a=s;return r&&(a=a.remove(new b(e.name,r))),a.insert(e,e.node)}});return new t(i,this.indexSet_)}removeFromIndexes(e,n){let i=ge(this.indexes_,s=>{if(s===K4)return s;{let c=n.get(e.name);return c?s.remove(new b(e.name,c)):s}});return new t(i,this.indexSet_)}};var Ne,z=(()=>{class t{constructor(n,i,s){this.children_=n,this.priorityNode_=i,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&s7(this.priorityNode_),this.children_.isEmpty()&&f(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ne||(Ne=new t(new p1(Xt),null,ee.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ne}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let i=this.children_.get(n);return i===null?Ne:i}}getChild(n){let i=M(n);return i===null?this:this.getImmediateChild(i).getChild(T(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,i){if(f(i,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(i);{let s=new b(n,i),c,o;i.isEmpty()?(c=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(s,this.children_)):(c=this.children_.insert(n,i),o=this.indexMap_.addToIndexes(s,this.children_));let r=c.isEmpty()?Ne:this.priorityNode_;return new t(c,r,o)}}updateChild(n,i){let s=M(n);if(s===null)return i;{f(M(n)!==".priority"||s4(n)===1,".priority must be the last token in a path");let c=this.getImmediateChild(s).updateChild(T(n),i);return this.updateImmediateChild(s,c)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let i={},s=0,c=0,o=!0;if(this.forEachChild(L,(r,a)=>{i[r]=a.val(n),s++,o&&t.INTEGER_REGEXP_.test(r)?c=Math.max(c,Number(r)):o=!1}),!n&&o&&c<2*s){let r=[];for(let a in i)r[a]=i[a];return r}else return n&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+i7(this.getPriority().val())+":"),this.forEachChild(L,(i,s)=>{let c=s.hash();c!==""&&(n+=":"+i+":"+c)}),this.lazyHash_=n===""?"":jc(n)}return this.lazyHash_}getPredecessorChildName(n,i,s){let c=this.resolveIndex_(s);if(c){let o=c.getPredecessorKey(new b(n,i));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let i=this.resolveIndex_(n);if(i){let s=i.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(n){let i=this.getFirstChildName(n);return i?new b(i,this.children_.get(i)):null}getLastChildName(n){let i=this.resolveIndex_(n);if(i){let s=i.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(n){let i=this.getLastChildName(n);return i?new b(i,this.children_.get(i)):null}forEachChild(n,i){let s=this.resolveIndex_(n);return s?s.inorderTraversal(c=>i(c.name,c.node)):this.children_.inorderTraversal(i)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,i){let s=this.resolveIndex_(i);if(s)return s.getIteratorFrom(n,c=>c);{let c=this.children_.getIteratorFrom(n.name,b.Wrap),o=c.peek();for(;o!=null&&i.compare(o,n)<0;)c.getNext(),o=c.peek();return c}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,i){let s=this.resolveIndex_(i);if(s)return s.getReverseIteratorFrom(n,c=>c);{let c=this.children_.getReverseIteratorFrom(n.name,b.Wrap),o=c.peek();for(;o!=null&&i.compare(o,n)>0;)c.getNext(),o=c.peek();return c}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===h2?-1:0}withIndex(n){if(n===T1||this.indexMap_.hasIndex(n))return this;{let i=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,i)}}isIndexed(n){return n===T1||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let i=n;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let s=this.getIterator(L),c=i.getIterator(L),o=s.getNext(),r=c.getNext();for(;o&&r;){if(o.name!==r.name||!o.node.equals(r.node))return!1;o=s.getNext(),r=c.getNext()}return o===null&&r===null}else return!1;else return!1}}resolveIndex_(n){return n===T1?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),st=class extends z{constructor(){super(new p1(Xt),z.EMPTY_NODE,ee.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return z.EMPTY_NODE}isEmpty(){return!1}},h2=new st;Object.defineProperties(b,{MIN:{value:new b(i4,z.EMPTY_NODE)},MAX:{value:new b(N1,h2)}});b3.__EMPTY_NODE=z.EMPTY_NODE;J4.__childrenNodeConstructor=z;S9(h2);L9(h2);var O9=!0;function k(t,e=null){if(t===null)return z.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),f(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new J4(n,k(e))}if(!(t instanceof Array)&&O9){let n=[],i=!1;if(U(t,(o,r)=>{if(o.substring(0,1)!=="."){let a=k(r);a.isEmpty()||(i=i||!a.getPriority().isEmpty(),n.push(new b(o,a)))}}),n.length===0)return z.EMPTY_NODE;let c=C3(n,x9,o=>o.name,Xt);if(i){let o=C3(n,L.getCompare());return new z(c,k(e),new ee({".priority":o},{".priority":L}))}else return new z(c,k(e),ee.Default)}else{let n=z.EMPTY_NODE;return U(t,(i,s)=>{if(v1(t,i)&&i.substring(0,1)!=="."){let c=k(s);(c.isLeafNode()||!c.isEmpty())&&(n=n.updateImmediateChild(i,c))}}),n.updatePriority(k(e))}}T9(k);var Qe=class extends X4{constructor(e){super(),this.indexPath_=e,f(!y(e)&&M(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let i=this.extractChild(e.node),s=this.extractChild(n.node),c=i.compareTo(s);return c===0?H4(e.name,n.name):c}makePost(e,n){let i=k(e),s=z.EMPTY_NODE.updateChild(this.indexPath_,i);return new b(n,s)}maxPost(){let e=z.EMPTY_NODE.updateChild(this.indexPath_,h2);return new b(N1,e)}toString(){return Ye(this.indexPath_,0).join("/")}};var ct=class extends X4{compare(e,n){let i=e.node.compareTo(n.node);return i===0?H4(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return b.MIN}maxPost(){return b.MAX}makePost(e,n){let i=k(e);return new b(n,i)}toString(){return".value"}},Jt=new ct;function r7(t){return{type:"value",snapshotNode:t}}function te(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ze(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Xe(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function I9(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Je=class{constructor(e){this.index_=e}updateChild(e,n,i,s,c,o){f(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let r=e.getImmediateChild(n);return r.getChild(s).equals(i.getChild(s))&&r.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(n)?o.trackChildChange(Ze(n,r)):f(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):r.isEmpty()?o.trackChildChange(te(n,i)):o.trackChildChange(Xe(n,i,r))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(e,n,i){return i!=null&&(e.isLeafNode()||e.forEachChild(L,(s,c)=>{n.hasChild(s)||i.trackChildChange(Ze(s,c))}),n.isLeafNode()||n.forEachChild(L,(s,c)=>{if(e.hasChild(s)){let o=e.getImmediateChild(s);o.equals(c)||i.trackChildChange(Xe(s,c,o))}else i.trackChildChange(te(s,c))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?z.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var V3=class t{constructor(e){this.indexedFilter_=new Je(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&i}updateChild(e,n,i,s,c,o){return this.matches(new b(n,i))||(i=z.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,i,s,c,o)}updateFullNode(e,n,i){n.isLeafNode()&&(n=z.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(z.EMPTY_NODE);let c=this;return n.forEachChild(L,(o,r)=>{c.matches(new b(o,r))||(s=s.updateImmediateChild(o,z.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var ot=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let i=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=n=>{let i=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new V3(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,i,s,c,o){return this.rangedFilter_.matches(new b(n,i))||(i=z.EMPTY_NODE),e.getImmediateChild(n).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,i,s,c,o):this.fullLimitUpdateChild_(e,n,i,c,o)}updateFullNode(e,n,i){let s;if(n.isLeafNode()||n.isEmpty())s=z.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=z.EMPTY_NODE.withIndex(this.index_);let c;this.reverse_?c=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):c=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;c.hasNext()&&o<this.limit_;){let r=c.getNext();if(this.withinDirectionalStart(r))if(this.withinDirectionalEnd(r))s=s.updateImmediateChild(r.name,r.node),o++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(z.EMPTY_NODE);let c;this.reverse_?c=s.getReverseIterator(this.index_):c=s.getIterator(this.index_);let o=0;for(;c.hasNext();){let r=c.getNext();o<this.limit_&&this.withinDirectionalStart(r)&&this.withinDirectionalEnd(r)?o++:s=s.updateImmediateChild(r.name,z.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,i,s,c){let o;if(this.reverse_){let u=this.index_.getCompare();o=(d,v)=>u(v,d)}else o=this.index_.getCompare();let r=e;f(r.numChildren()===this.limit_,"");let a=new b(n,i),l=this.reverse_?r.getFirstChild(this.index_):r.getLastChild(this.index_),h=this.rangedFilter_.matches(a);if(r.hasChild(n)){let u=r.getImmediateChild(n),d=s.getChildAfterChild(this.index_,l,this.reverse_);for(;d!=null&&(d.name===n||r.hasChild(d.name));)d=s.getChildAfterChild(this.index_,d,this.reverse_);let v=d==null?1:o(d,a);if(h&&!i.isEmpty()&&v>=0)return c?.trackChildChange(Xe(n,i,u)),r.updateImmediateChild(n,i);{c?.trackChildChange(Ze(n,u));let w=r.updateImmediateChild(n,z.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(c?.trackChildChange(te(d.name,d.node)),w.updateImmediateChild(d.name,d.node)):w}}else return i.isEmpty()?e:h&&o(l,a)>=0?(c!=null&&(c.trackChildChange(Ze(l.name,l.node)),c.trackChildChange(te(n,i))),r.updateImmediateChild(n,i).updateImmediateChild(l.name,z.EMPTY_NODE)):e}};var e2=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=L}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return f(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return f(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:i4}hasEnd(){return this.endSet_}getIndexEndValue(){return f(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return f(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:N1}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return f(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===L}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function k9(t){return t.loadsAllData()?new Je(t.getIndex()):t.hasLimit()?new ot(t):new V3(t)}function B9(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function D9(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function rt(t,e,n){let i=t.copy();return i.startSet_=!0,e===void 0&&(e=null),i.indexStartValue_=e,n!=null?(i.startNameSet_=!0,i.indexStartName_=n):(i.startNameSet_=!1,i.indexStartName_=""),i}function R9(t,e,n){let i;return t.index_===T1||n?i=rt(t,e,n):i=rt(t,e,N1),i.startAfterSet_=!0,i}function at(t,e,n){let i=t.copy();return i.endSet_=!0,e===void 0&&(e=null),i.indexEndValue_=e,n!==void 0?(i.endNameSet_=!0,i.indexEndName_=n):(i.endNameSet_=!1,i.indexEndName_=""),i}function F9(t,e,n){let i;return t.index_===T1||n?i=at(t,e,n):i=at(t,e,i4),i.endBeforeSet_=!0,i}function j3(t,e){let n=t.copy();return n.index_=e,n}function pc(t){let e={};if(t.isDefault())return e;let n;if(t.index_===L?n="$priority":t.index_===Jt?n="$value":t.index_===T1?n="$key":(f(t.index_ instanceof Qe,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=B(n),t.startSet_){let i=t.startAfterSet_?"startAfter":"startAt";e[i]=B(t.indexStartValue_),t.startNameSet_&&(e[i]+=","+B(t.indexStartName_))}if(t.endSet_){let i=t.endBeforeSet_?"endBefore":"endAt";e[i]=B(t.indexEndValue_),t.endNameSet_&&(e[i]+=","+B(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function gc(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==L&&(e.i=t.index_.toString()),e}var lt=class t extends w3{constructor(e,n,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=l2("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(f(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,i,s){let c=e._path.toString();this.log_("Listen called for "+c+" "+e._queryIdentifier);let o=t.getListenId_(e,i),r={};this.listens_[o]=r;let a=pc(e._queryParams);this.restRequest_(c+".json",a,(l,h)=>{let u=h;if(l===404&&(u=null,l=null),l===null&&this.onDataUpdate_(c,u,!1,i),G1(this.listens_,o)===r){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",s(d,null)}})}unlisten(e,n){let i=t.getListenId_(e,n);delete this.listens_[i]}get(e){let n=pc(e._queryParams),i=e._path.toString(),s=new P;return this.restRequest_(i+".json",n,(c,o)=>{let r=o;c===404&&(r=null,c=null),c===null?(this.onDataUpdate_(i,r,!1,null),s.resolve(r)):s.reject(new Error(r))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,c])=>{s&&s.accessToken&&(n.auth=s.accessToken),c&&c.token&&(n.ac=c.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+tn(n);this.log_("Sending REST request for "+o);let r=new XMLHttpRequest;r.onreadystatechange=()=>{if(i&&r.readyState===4){this.log_("REST Response for "+o+" received. status:",r.status,"response:",r.responseText);let a=null;if(r.status>=200&&r.status<300){try{a=T2(r.responseText)}catch{$("Failed to parse JSON response for "+o+": "+r.responseText)}i(null,a)}else r.status!==401&&r.status!==404&&$("Got unsuccessful REST response for "+o+" Status: "+r.status),i(r.status);i=null}},r.open("GET",o,!0),r.send()})}};var ht=class{constructor(){this.rootNode_=z.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function E3(){return{value:null,children:new Map}}function re(t,e,n){if(y(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let i=M(e);t.children.has(i)||t.children.set(i,E3());let s=t.children.get(i);e=T(e),re(s,e,n)}}function ut(t,e){if(y(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(L,(i,s)=>{re(t,new V(i),s)}),ut(t,e)}}else if(t.children.size>0){let n=M(e);return e=T(e),t.children.has(n)&&ut(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function dt(t,e,n){t.value!==null?n(e,t.value):N9(t,(i,s)=>{let c=new V(e.toString()+"/"+i);dt(s,c,n)})}function N9(t,e){t.children.forEach((n,i)=>{e(i,n)})}var ft=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&U(this.last_,(i,s)=>{n[i]=n[i]-s}),this.last_=e,n}};var _c=10*1e3,P9=30*1e3,q9=5*60*1e3,vt=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new ft(e);let i=_c+(P9-_c)*Math.random();qe(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),n={},i=!1;U(e,(s,c)=>{c>0&&v1(this.statsToReport_,s)&&(n[s]=c,i=!0)}),i&&this.server_.reportStats(n),qe(this.reportStats_.bind(this),Math.floor(Math.random()*2*q9))}};var S1=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(S1||{});function e0(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function t0(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function n0(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var mt=class t{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=S1.ACK_USER_WRITE,this.source=e0()}operationForChild(e){if(y(this.path)){if(this.affectedTree.value!=null)return f(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new V(e));return new t(C(),n,this.revert)}}else return f(M(this.path)===e,"operationForChild called for unrelated child."),new t(T(this.path),this.affectedTree,this.revert)}};var H3=class t{constructor(e,n){this.source=e,this.path=n,this.type=S1.LISTEN_COMPLETE}operationForChild(e){return y(this.path)?new t(this.source,C()):new t(this.source,T(this.path))}};var ne=class t{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=S1.OVERWRITE}operationForChild(e){return y(this.path)?new t(this.source,C(),this.snap.getImmediateChild(e)):new t(this.source,T(this.path),this.snap)}};var t2=class t{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=S1.MERGE}operationForChild(e){if(y(this.path)){let n=this.children.subtree(new V(e));return n.isEmpty()?null:n.value?new ne(this.source,C(),n.value):new t(this.source,C(),n)}else return f(M(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,T(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var A1=class{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(y(e))return this.isFullyInitialized()&&!this.filtered_;let n=M(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var pt=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function U9(t,e,n,i){let s=[],c=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&c.push(I9(o.childName,o.snapshotNode))}),Pe(t,s,"child_removed",e,i,n),Pe(t,s,"child_added",e,i,n),Pe(t,s,"child_moved",c,i,n),Pe(t,s,"child_changed",e,i,n),Pe(t,s,"value",e,i,n),s}function Pe(t,e,n,i,s,c){let o=i.filter(r=>r.type===n);o.sort((r,a)=>W9(t,r,a)),o.forEach(r=>{let a=j9(t,r,c);s.forEach(l=>{l.respondsTo(r.type)&&e.push(l.createEvent(a,t.query_))})})}function j9(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function W9(t,e,n){if(e.childName==null||n.childName==null)throw k4("Should only compare child_ events.");let i=new b(e.childName,e.snapshotNode),s=new b(n.childName,n.snapshotNode);return t.index_.compare(i,s)}function W3(t,e){return{eventCache:t,serverCache:e}}function je(t,e,n,i){return W3(new A1(e,n,i),t.serverCache)}function a7(t,e,n,i){return W3(t.eventCache,new A1(e,n,i))}function x3(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function E4(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var R6,G9=()=>(R6||(R6=new p1(Ul)),R6),X=class t{constructor(e,n=G9()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return U(e,(i,s)=>{n=n.set(new V(i),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:C(),value:this.value};if(y(e))return null;{let i=M(e),s=this.children.get(i);if(s!==null){let c=s.findRootMostMatchingPathAndValue(T(e),n);return c!=null?{path:I(new V(i),c.path),value:c.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(y(e))return this;{let n=M(e),i=this.children.get(n);return i!==null?i.subtree(T(e)):new t(null)}}set(e,n){if(y(e))return new t(n,this.children);{let i=M(e),c=(this.children.get(i)||new t(null)).set(T(e),n),o=this.children.insert(i,c);return new t(this.value,o)}}remove(e){if(y(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=M(e),i=this.children.get(n);if(i){let s=i.remove(T(e)),c;return s.isEmpty()?c=this.children.remove(n):c=this.children.insert(n,s),this.value===null&&c.isEmpty()?new t(null):new t(this.value,c)}else return this}}get(e){if(y(e))return this.value;{let n=M(e),i=this.children.get(n);return i?i.get(T(e)):null}}setTree(e,n){if(y(e))return n;{let i=M(e),c=(this.children.get(i)||new t(null)).setTree(T(e),n),o;return c.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,c),new t(this.value,o)}}fold(e){return this.fold_(C(),e)}fold_(e,n){let i={};return this.children.inorderTraversal((s,c)=>{i[s]=c.fold_(I(e,s),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,C(),n)}findOnPath_(e,n,i){let s=this.value?i(n,this.value):!1;if(s)return s;if(y(e))return null;{let c=M(e),o=this.children.get(c);return o?o.findOnPath_(T(e),I(n,c),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,C(),n)}foreachOnPath_(e,n,i){if(y(e))return this;{this.value&&i(n,this.value);let s=M(e),c=this.children.get(s);return c?c.foreachOnPath_(T(e),I(n,s),i):new t(null)}}foreach(e){this.foreach_(C(),e)}foreach_(e,n){this.children.inorderTraversal((i,s)=>{s.foreach_(I(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}};var C1=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new X(null))}};function We(t,e,n){if(y(e))return new C1(new X(n));{let i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){let s=i.path,c=i.value,o=Z(s,e);return c=c.updateChild(o,n),new C1(t.writeTree_.set(s,c))}else{let s=new X(n),c=t.writeTree_.setTree(e,s);return new C1(c)}}}function gt(t,e,n){let i=t;return U(n,(s,c)=>{i=We(i,I(e,s),c)}),i}function zc(t,e){if(y(e))return C1.empty();{let n=t.writeTree_.setTree(e,new X(null));return new C1(n)}}function _t(t,e){return x4(t,e)!=null}function x4(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Z(n.path,e)):null}function wc(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(L,(i,s)=>{e.push(new b(i,s))}):t.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new b(i,s.value))}),e}function t4(t,e){if(y(e))return t;{let n=x4(t,e);return n!=null?new C1(new X(n)):new C1(t.writeTree_.subtree(e))}}function zt(t){return t.writeTree_.isEmpty()}function ie(t,e){return l7(C(),t.writeTree_,e)}function l7(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((s,c)=>{s===".priority"?(f(c.value!==null,"Priority writes must always be leaf nodes"),i=c.value):n=l7(I(t,s),c,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(I(t,".priority"),i)),n}}function G3(t,e){return f7(e,t)}function $9(t,e,n,i,s){f(i>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:s}),s&&(t.visibleWrites=We(t.visibleWrites,e,n)),t.lastWriteId=i}function K9(t,e,n,i){f(i>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:i,visible:!0}),t.visibleWrites=gt(t.visibleWrites,e,n),t.lastWriteId=i}function Y9(t,e){for(let n=0;n<t.allWrites.length;n++){let i=t.allWrites[n];if(i.writeId===e)return i}return null}function Q9(t,e){let n=t.allWrites.findIndex(r=>r.writeId===e);f(n>=0,"removeWrite called with nonexistent writeId.");let i=t.allWrites[n];t.allWrites.splice(n,1);let s=i.visible,c=!1,o=t.allWrites.length-1;for(;s&&o>=0;){let r=t.allWrites[o];r.visible&&(o>=n&&Z9(r,i.path)?s=!1:m1(i.path,r.path)&&(c=!0)),o--}if(s){if(c)return X9(t),!0;if(i.snap)t.visibleWrites=zc(t.visibleWrites,i.path);else{let r=i.children;U(r,a=>{t.visibleWrites=zc(t.visibleWrites,I(i.path,a))})}return!0}else return!1}function Z9(t,e){if(t.snap)return m1(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&m1(I(t.path,n),e))return!0;return!1}function X9(t){t.visibleWrites=h7(t.allWrites,J9,C()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function J9(t){return t.visible}function h7(t,e,n){let i=C1.empty();for(let s=0;s<t.length;++s){let c=t[s];if(e(c)){let o=c.path,r;if(c.snap)m1(n,o)?(r=Z(n,o),i=We(i,r,c.snap)):m1(o,n)&&(r=Z(o,n),i=We(i,C(),c.snap.getChild(r)));else if(c.children){if(m1(n,o))r=Z(n,o),i=gt(i,r,c.children);else if(m1(o,n))if(r=Z(o,n),y(r))i=gt(i,C(),c.children);else{let a=G1(c.children,M(r));if(a){let l=a.getChild(T(r));i=We(i,C(),l)}}}else throw k4("WriteRecord should have .snap or .children")}}return i}function u7(t,e,n,i,s){if(!i&&!s){let c=x4(t.visibleWrites,e);if(c!=null)return c;{let o=t4(t.visibleWrites,e);if(zt(o))return n;if(n==null&&!_t(o,C()))return null;{let r=n||z.EMPTY_NODE;return ie(o,r)}}}else{let c=t4(t.visibleWrites,e);if(!s&&zt(c))return n;if(!s&&n==null&&!_t(c,C()))return null;{let o=function(l){return(l.visible||s)&&(!i||!~i.indexOf(l.writeId))&&(m1(l.path,e)||m1(e,l.path))},r=h7(t.allWrites,o,e),a=n||z.EMPTY_NODE;return ie(r,a)}}}function eh(t,e,n){let i=z.EMPTY_NODE,s=x4(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(L,(c,o)=>{i=i.updateImmediateChild(c,o)}),i;if(n){let c=t4(t.visibleWrites,e);return n.forEachChild(L,(o,r)=>{let a=ie(t4(c,new V(o)),r);i=i.updateImmediateChild(o,a)}),wc(c).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let c=t4(t.visibleWrites,e);return wc(c).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function th(t,e,n,i,s){f(i||s,"Either existingEventSnap or existingServerSnap must exist");let c=I(e,n);if(_t(t.visibleWrites,c))return null;{let o=t4(t.visibleWrites,c);return zt(o)?s.getChild(n):ie(o,s.getChild(n))}}function nh(t,e,n,i){let s=I(e,n),c=x4(t.visibleWrites,s);if(c!=null)return c;if(i.isCompleteForChild(n)){let o=t4(t.visibleWrites,s);return ie(o,i.getNode().getImmediateChild(n))}else return null}function ih(t,e){return x4(t.visibleWrites,e)}function sh(t,e,n,i,s,c,o){let r,a=t4(t.visibleWrites,e),l=x4(a,C());if(l!=null)r=l;else if(n!=null)r=ie(a,n);else return[];if(r=r.withIndex(o),!r.isEmpty()&&!r.isLeafNode()){let h=[],u=o.getCompare(),d=c?r.getReverseIteratorFrom(i,o):r.getIteratorFrom(i,o),v=d.getNext();for(;v&&h.length<s;)u(v,i)!==0&&h.push(v),v=d.getNext();return h}else return[]}function ch(){return{visibleWrites:C1.empty(),allWrites:[],lastWriteId:-1}}function S3(t,e,n,i){return u7(t.writeTree,t.treePath,e,n,i)}function i0(t,e){return eh(t.writeTree,t.treePath,e)}function Mc(t,e,n,i){return th(t.writeTree,t.treePath,e,n,i)}function T3(t,e){return ih(t.writeTree,I(t.treePath,e))}function oh(t,e,n,i,s,c){return sh(t.writeTree,t.treePath,e,n,i,s,c)}function s0(t,e,n){return nh(t.writeTree,t.treePath,e,n)}function d7(t,e){return f7(I(t.treePath,e),t.writeTree)}function f7(t,e){return{treePath:t,writeTree:e}}var wt=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,i=e.childName;f(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),f(i!==".priority","Only non-priority child changes can be tracked.");let s=this.changeMap.get(i);if(s){let c=s.type;if(n==="child_added"&&c==="child_removed")this.changeMap.set(i,Xe(i,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&c==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&c==="child_changed")this.changeMap.set(i,Ze(i,s.oldSnap));else if(n==="child_changed"&&c==="child_added")this.changeMap.set(i,te(i,e.snapshotNode));else if(n==="child_changed"&&c==="child_changed")this.changeMap.set(i,Xe(i,e.snapshotNode,s.oldSnap));else throw k4("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var Mt=class{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}},v7=new Mt,n2=class{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new A1(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return s0(this.writes_,e,i)}}getChildAfterChild(e,n,i){let s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:E4(this.viewCache_),c=oh(this.writes_,s,n,1,i,e);return c.length===0?null:c[0]}};function rh(t){return{filter:t}}function ah(t,e){f(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),f(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function lh(t,e,n,i,s){let c=new wt,o,r;if(n.type===S1.OVERWRITE){let l=n;l.source.fromUser?o=yt(t,e,l.path,l.snap,i,s,c):(f(l.source.fromServer,"Unknown source."),r=l.source.tagged||e.serverCache.isFiltered()&&!y(l.path),o=L3(t,e,l.path,l.snap,i,s,r,c))}else if(n.type===S1.MERGE){let l=n;l.source.fromUser?o=uh(t,e,l.path,l.children,i,s,c):(f(l.source.fromServer,"Unknown source."),r=l.source.tagged||e.serverCache.isFiltered(),o=bt(t,e,l.path,l.children,i,s,r,c))}else if(n.type===S1.ACK_USER_WRITE){let l=n;l.revert?o=vh(t,e,l.path,i,s,c):o=dh(t,e,l.path,l.affectedTree,i,s,c)}else if(n.type===S1.LISTEN_COMPLETE)o=fh(t,e,n.path,i,c);else throw k4("Unknown operation type: "+n.type);let a=c.getChanges();return hh(e,o,a),{viewCache:o,changes:a}}function hh(t,e,n){let i=e.eventCache;if(i.isFullyInitialized()){let s=i.getNode().isLeafNode()||i.getNode().isEmpty(),c=x3(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!i.getNode().equals(c)||!i.getNode().getPriority().equals(c.getPriority()))&&n.push(r7(x3(e)))}}function m7(t,e,n,i,s,c){let o=e.eventCache;if(T3(i,n)!=null)return e;{let r,a;if(y(n))if(f(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=E4(e),h=l instanceof z?l:z.EMPTY_NODE,u=i0(i,h);r=t.filter.updateFullNode(e.eventCache.getNode(),u,c)}else{let l=S3(i,E4(e));r=t.filter.updateFullNode(e.eventCache.getNode(),l,c)}else{let l=M(n);if(l===".priority"){f(s4(n)===1,"Can't have a priority with additional path components");let h=o.getNode();a=e.serverCache.getNode();let u=Mc(i,n,h,a);u!=null?r=t.filter.updatePriority(h,u):r=o.getNode()}else{let h=T(n),u;if(o.isCompleteForChild(l)){a=e.serverCache.getNode();let d=Mc(i,n,o.getNode(),a);d!=null?u=o.getNode().getImmediateChild(l).updateChild(h,d):u=o.getNode().getImmediateChild(l)}else u=s0(i,l,e.serverCache);u!=null?r=t.filter.updateChild(o.getNode(),l,u,h,s,c):r=o.getNode()}}return je(e,r,o.isFullyInitialized()||y(n),t.filter.filtersNodes())}}function L3(t,e,n,i,s,c,o,r){let a=e.serverCache,l,h=o?t.filter:t.filter.getIndexedFilter();if(y(n))l=h.updateFullNode(a.getNode(),i,null);else if(h.filtersNodes()&&!a.isFiltered()){let v=a.getNode().updateChild(n,i);l=h.updateFullNode(a.getNode(),v,null)}else{let v=M(n);if(!a.isCompleteForPath(n)&&s4(n)>1)return e;let m=T(n),x=a.getNode().getImmediateChild(v).updateChild(m,i);v===".priority"?l=h.updatePriority(a.getNode(),x):l=h.updateChild(a.getNode(),v,x,m,v7,null)}let u=a7(e,l,a.isFullyInitialized()||y(n),h.filtersNodes()),d=new n2(s,u,c);return m7(t,u,n,s,d,r)}function yt(t,e,n,i,s,c,o){let r=e.eventCache,a,l,h=new n2(s,e,c);if(y(n))l=t.filter.updateFullNode(e.eventCache.getNode(),i,o),a=je(e,l,!0,t.filter.filtersNodes());else{let u=M(n);if(u===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),i),a=je(e,l,r.isFullyInitialized(),r.isFiltered());else{let d=T(n),v=r.getNode().getImmediateChild(u),m;if(y(d))m=i;else{let w=h.getCompleteChild(u);w!=null?Yt(d)===".priority"&&w.getChild(t7(d)).isEmpty()?m=w:m=w.updateChild(d,i):m=z.EMPTY_NODE}if(v.equals(m))a=e;else{let w=t.filter.updateChild(r.getNode(),u,m,d,h,o);a=je(e,w,r.isFullyInitialized(),t.filter.filtersNodes())}}}return a}function yc(t,e){return t.eventCache.isCompleteForChild(e)}function uh(t,e,n,i,s,c,o){let r=e;return i.foreach((a,l)=>{let h=I(n,a);yc(e,M(h))&&(r=yt(t,r,h,l,s,c,o))}),i.foreach((a,l)=>{let h=I(n,a);yc(e,M(h))||(r=yt(t,r,h,l,s,c,o))}),r}function bc(t,e,n){return n.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function bt(t,e,n,i,s,c,o,r){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let a=e,l;y(n)?l=i:l=new X(null).setTree(n,i);let h=e.serverCache.getNode();return l.children.inorderTraversal((u,d)=>{if(h.hasChild(u)){let v=e.serverCache.getNode().getImmediateChild(u),m=bc(t,v,d);a=L3(t,a,new V(u),m,s,c,o,r)}}),l.children.inorderTraversal((u,d)=>{let v=!e.serverCache.isCompleteForChild(u)&&d.value===null;if(!h.hasChild(u)&&!v){let m=e.serverCache.getNode().getImmediateChild(u),w=bc(t,m,d);a=L3(t,a,new V(u),w,s,c,o,r)}}),a}function dh(t,e,n,i,s,c,o){if(T3(s,n)!=null)return e;let r=e.serverCache.isFiltered(),a=e.serverCache;if(i.value!=null){if(y(n)&&a.isFullyInitialized()||a.isCompleteForPath(n))return L3(t,e,n,a.getNode().getChild(n),s,c,r,o);if(y(n)){let l=new X(null);return a.getNode().forEachChild(T1,(h,u)=>{l=l.set(new V(h),u)}),bt(t,e,n,l,s,c,r,o)}else return e}else{let l=new X(null);return i.foreach((h,u)=>{let d=I(n,h);a.isCompleteForPath(d)&&(l=l.set(h,a.getNode().getChild(d)))}),bt(t,e,n,l,s,c,r,o)}}function fh(t,e,n,i,s){let c=e.serverCache,o=a7(e,c.getNode(),c.isFullyInitialized()||y(n),c.isFiltered());return m7(t,o,n,i,v7,s)}function vh(t,e,n,i,s,c){let o;if(T3(i,n)!=null)return e;{let r=new n2(i,e,s),a=e.eventCache.getNode(),l;if(y(n)||M(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=S3(i,E4(e));else{let u=e.serverCache.getNode();f(u instanceof z,"serverChildren would be complete if leaf node"),h=i0(i,u)}h=h,l=t.filter.updateFullNode(a,h,c)}else{let h=M(n),u=s0(i,h,e.serverCache);u==null&&e.serverCache.isCompleteForChild(h)&&(u=a.getImmediateChild(h)),u!=null?l=t.filter.updateChild(a,h,u,T(n),r,c):e.eventCache.getNode().hasChild(h)?l=t.filter.updateChild(a,h,z.EMPTY_NODE,T(n),r,c):l=a,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=S3(i,E4(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,c)))}return o=e.serverCache.isFullyInitialized()||T3(i,C())!=null,je(e,l,o,t.filter.filtersNodes())}}var Ct=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let i=this.query_._queryParams,s=new Je(i.getIndex()),c=k9(i);this.processor_=rh(c);let o=n.serverCache,r=n.eventCache,a=s.updateFullNode(z.EMPTY_NODE,o.getNode(),null),l=c.updateFullNode(z.EMPTY_NODE,r.getNode(),null),h=new A1(a,o.isFullyInitialized(),s.filtersNodes()),u=new A1(l,r.isFullyInitialized(),c.filtersNodes());this.viewCache_=W3(u,h),this.eventGenerator_=new pt(this.query_)}get query(){return this.query_}};function mh(t){return t.viewCache_.serverCache.getNode()}function ph(t){return x3(t.viewCache_)}function gh(t,e){let n=E4(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!y(e)&&!n.getImmediateChild(M(e)).isEmpty())?n.getChild(e):null}function Cc(t){return t.eventRegistrations_.length===0}function _h(t,e){t.eventRegistrations_.push(e)}function Vc(t,e,n){let i=[];if(n){f(e==null,"A cancel should cancel all event registrations.");let s=t.query._path;t.eventRegistrations_.forEach(c=>{let o=c.createCancelEvent(n,s);o&&i.push(o)})}if(e){let s=[];for(let c=0;c<t.eventRegistrations_.length;++c){let o=t.eventRegistrations_[c];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(c+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return i}function Ec(t,e,n,i){e.type===S1.MERGE&&e.source.queryId!==null&&(f(E4(t.viewCache_),"We should always have a full cache before handling merges"),f(x3(t.viewCache_),"Missing event cache, even though we have a server cache"));let s=t.viewCache_,c=lh(t.processor_,s,e,n,i);return ah(t.processor_,c.viewCache),f(c.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=c.viewCache,p7(t,c.changes,c.viewCache.eventCache.getNode(),null)}function zh(t,e){let n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(L,(c,o)=>{i.push(te(c,o))}),n.isFullyInitialized()&&i.push(r7(n.getNode())),p7(t,i,n.getNode(),e)}function p7(t,e,n,i){let s=i?[i]:t.eventRegistrations_;return U9(t.eventGenerator_,e,n,s)}var A3,O3=class{constructor(){this.views=new Map}};function wh(t){f(!A3,"__referenceConstructor has already been defined"),A3=t}function Mh(){return f(A3,"Reference.ts has not been loaded"),A3}function yh(t){return t.views.size===0}function c0(t,e,n,i){let s=e.source.queryId;if(s!==null){let c=t.views.get(s);return f(c!=null,"SyncTree gave us an op for an invalid query."),Ec(c,e,n,i)}else{let c=[];for(let o of t.views.values())c=c.concat(Ec(o,e,n,i));return c}}function g7(t,e,n,i,s){let c=e._queryIdentifier,o=t.views.get(c);if(!o){let r=S3(n,s?i:null),a=!1;r?a=!0:i instanceof z?(r=i0(n,i),a=!1):(r=z.EMPTY_NODE,a=!1);let l=W3(new A1(r,a,!1),new A1(i,s,!1));return new Ct(e,l)}return o}function bh(t,e,n,i,s,c){let o=g7(t,e,i,s,c);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),_h(o,n),zh(o,n)}function Ch(t,e,n,i){let s=e._queryIdentifier,c=[],o=[],r=c4(t);if(s==="default")for(let[a,l]of t.views.entries())o=o.concat(Vc(l,n,i)),Cc(l)&&(t.views.delete(a),l.query._queryParams.loadsAllData()||c.push(l.query));else{let a=t.views.get(s);a&&(o=o.concat(Vc(a,n,i)),Cc(a)&&(t.views.delete(s),a.query._queryParams.loadsAllData()||c.push(a.query)))}return r&&!c4(t)&&c.push(new(Mh())(e._repo,e._path)),{removed:c,events:o}}function _7(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function n4(t,e){let n=null;for(let i of t.views.values())n=n||gh(i,e);return n}function z7(t,e){if(e._queryParams.loadsAllData())return $3(t);{let i=e._queryIdentifier;return t.views.get(i)}}function w7(t,e){return z7(t,e)!=null}function c4(t){return $3(t)!=null}function $3(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var I3;function Vh(t){f(!I3,"__referenceConstructor has already been defined"),I3=t}function Eh(){return f(I3,"Reference.ts has not been loaded"),I3}var Hh=1,k3=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new X(null),this.pendingWriteTree_=ch(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function o0(t,e,n,i,s){return $9(t.pendingWriteTree_,e,n,i,s),s?ae(t,new ne(e0(),e,n)):[]}function xh(t,e,n,i){K9(t.pendingWriteTree_,e,n,i);let s=X.fromObject(n);return ae(t,new t2(e0(),e,s))}function e4(t,e,n=!1){let i=Y9(t.pendingWriteTree_,e);if(Q9(t.pendingWriteTree_,e)){let c=new X(null);return i.snap!=null?c=c.set(C(),!0):U(i.children,o=>{c=c.set(new V(o),!0)}),ae(t,new mt(i.path,c,n))}else return[]}function u2(t,e,n){return ae(t,new ne(t0(),e,n))}function Sh(t,e,n){let i=X.fromObject(n);return ae(t,new t2(t0(),e,i))}function Th(t,e){return ae(t,new H3(t0(),e))}function Lh(t,e,n){let i=r0(t,n);if(i){let s=a0(i),c=s.path,o=s.queryId,r=Z(c,e),a=new H3(n0(o),r);return l0(t,c,a)}else return[]}function B3(t,e,n,i,s=!1){let c=e._path,o=t.syncPointTree_.get(c),r=[];if(o&&(e._queryIdentifier==="default"||w7(o,e))){let a=Ch(o,e,n,i);yh(o)&&(t.syncPointTree_=t.syncPointTree_.remove(c));let l=a.removed;if(r=a.events,!s){let h=l.findIndex(d=>d._queryParams.loadsAllData())!==-1,u=t.syncPointTree_.findOnPath(c,(d,v)=>c4(v));if(h&&!u){let d=t.syncPointTree_.subtree(c);if(!d.isEmpty()){let v=Ih(d);for(let m=0;m<v.length;++m){let w=v[m],x=w.query,s1=C7(t,w);t.listenProvider_.startListening(Ge(x),i2(t,x),s1.hashFn,s1.onComplete)}}}!u&&l.length>0&&!i&&(h?t.listenProvider_.stopListening(Ge(e),null):l.forEach(d=>{let v=t.queryToTagMap.get(Y3(d));t.listenProvider_.stopListening(Ge(d),v)}))}kh(t,l)}return r}function M7(t,e,n,i){let s=r0(t,i);if(s!=null){let c=a0(s),o=c.path,r=c.queryId,a=Z(o,e),l=new ne(n0(r),a,n);return l0(t,o,l)}else return[]}function Ah(t,e,n,i){let s=r0(t,i);if(s){let c=a0(s),o=c.path,r=c.queryId,a=Z(o,e),l=X.fromObject(n),h=new t2(n0(r),a,l);return l0(t,o,h)}else return[]}function Vt(t,e,n,i=!1){let s=e._path,c=null,o=!1;t.syncPointTree_.foreachOnPath(s,(d,v)=>{let m=Z(d,s);c=c||n4(v,m),o=o||c4(v)});let r=t.syncPointTree_.get(s);r?(o=o||c4(r),c=c||n4(r,C())):(r=new O3,t.syncPointTree_=t.syncPointTree_.set(s,r));let a;c!=null?a=!0:(a=!1,c=z.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((v,m)=>{let w=n4(m,C());w&&(c=c.updateImmediateChild(v,w))}));let l=w7(r,e);if(!l&&!e._queryParams.loadsAllData()){let d=Y3(e);f(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");let v=Bh();t.queryToTagMap.set(d,v),t.tagToQueryMap.set(v,d)}let h=G3(t.pendingWriteTree_,s),u=bh(r,e,n,h,c,a);if(!l&&!o&&!i){let d=z7(r,e);u=u.concat(Dh(t,e,d))}return u}function K3(t,e,n){let s=t.pendingWriteTree_,c=t.syncPointTree_.findOnPath(e,(o,r)=>{let a=Z(o,e),l=n4(r,a);if(l)return l});return u7(s,e,c,n,!0)}function Oh(t,e){let n=e._path,i=null;t.syncPointTree_.foreachOnPath(n,(l,h)=>{let u=Z(l,n);i=i||n4(h,u)});let s=t.syncPointTree_.get(n);s?i=i||n4(s,C()):(s=new O3,t.syncPointTree_=t.syncPointTree_.set(n,s));let c=i!=null,o=c?new A1(i,!0,!1):null,r=G3(t.pendingWriteTree_,e._path),a=g7(s,e,r,c?o.getNode():z.EMPTY_NODE,c);return ph(a)}function ae(t,e){return y7(e,t.syncPointTree_,null,G3(t.pendingWriteTree_,C()))}function y7(t,e,n,i){if(y(t.path))return b7(t,e,n,i);{let s=e.get(C());n==null&&s!=null&&(n=n4(s,C()));let c=[],o=M(t.path),r=t.operationForChild(o),a=e.children.get(o);if(a&&r){let l=n?n.getImmediateChild(o):null,h=d7(i,o);c=c.concat(y7(r,a,l,h))}return s&&(c=c.concat(c0(s,t,i,n))),c}}function b7(t,e,n,i){let s=e.get(C());n==null&&s!=null&&(n=n4(s,C()));let c=[];return e.children.inorderTraversal((o,r)=>{let a=n?n.getImmediateChild(o):null,l=d7(i,o),h=t.operationForChild(o);h&&(c=c.concat(b7(h,r,a,l)))}),s&&(c=c.concat(c0(s,t,i,n))),c}function C7(t,e){let n=e.query,i=i2(t,n);return{hashFn:()=>(mh(e)||z.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?Lh(t,n._path,i):Th(t,n._path);{let c=Gl(s,n);return B3(t,n,null,c)}}}}function i2(t,e){let n=Y3(e);return t.queryToTagMap.get(n)}function Y3(t){return t._path.toString()+"$"+t._queryIdentifier}function r0(t,e){return t.tagToQueryMap.get(e)}function a0(t){let e=t.indexOf("$");return f(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new V(t.substr(0,e))}}function l0(t,e,n){let i=t.syncPointTree_.get(e);f(i,"Missing sync point for query tag that we're tracking");let s=G3(t.pendingWriteTree_,e);return c0(i,n,s,null)}function Ih(t){return t.fold((e,n,i)=>{if(n&&c4(n))return[$3(n)];{let s=[];return n&&(s=_7(n)),U(i,(c,o)=>{s=s.concat(o)}),s}})}function Ge(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(Eh())(t._repo,t._path):t}function kh(t,e){for(let n=0;n<e.length;++n){let i=e[n];if(!i._queryParams.loadsAllData()){let s=Y3(i),c=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(c)}}}function Bh(){return Hh++}function Dh(t,e,n){let i=e._path,s=i2(t,e),c=C7(t,n),o=t.listenProvider_.startListening(Ge(e),s,c.hashFn,c.onComplete),r=t.syncPointTree_.subtree(i);if(s)f(!c4(r.value),"If we're adding a query, it shouldn't be shadowed");else{let a=r.fold((l,h,u)=>{if(!y(l)&&h&&c4(h))return[$3(h).query];{let d=[];return h&&(d=d.concat(_7(h).map(v=>v.query))),U(u,(v,m)=>{d=d.concat(m)}),d}});for(let l=0;l<a.length;++l){let h=a[l];t.listenProvider_.stopListening(Ge(h),i2(t,h))}}return o}var Et=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},Ht=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=I(this.path_,e);return new t(this.syncTree_,n)}node(){return K3(this.syncTree_,this.path_)}},Rh=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Hc=function(t,e,n){if(!t||typeof t!="object")return t;if(f(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Fh(t[".sv"],e,n);if(typeof t[".sv"]=="object")return Nh(t[".sv"],e);f(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Fh=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:f(!1,"Unexpected server value: "+t)}},Nh=function(t,e,n){t.hasOwnProperty("increment")||f(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let i=t.increment;typeof i!="number"&&f(!1,"Unexpected increment value: "+i);let s=e.node();if(f(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;let o=s.getValue();return typeof o!="number"?i:o+i},V7=function(t,e,n,i){return u0(e,new Ht(n,t),i)},h0=function(t,e,n){return u0(t,new Et(e),n)};function u0(t,e,n){let i=t.getPriority().val(),s=Hc(i,e.getImmediateChild(".priority"),n),c;if(t.isLeafNode()){let o=t,r=Hc(o.getValue(),e,n);return r!==o.getValue()||s!==o.getPriority().val()?new J4(r,k(s)):t}else{let o=t;return c=o,s!==o.getPriority().val()&&(c=c.updatePriority(new J4(s))),o.forEachChild(L,(r,a)=>{let l=u0(a,e.getImmediateChild(r),n);l!==a&&(c=c.updateImmediateChild(r,l))}),c}}var s2=class{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}};function Q3(t,e){let n=e instanceof V?e:new V(e),i=t,s=M(n);for(;s!==null;){let c=G1(i.node.children,s)||{children:{},childCount:0};i=new s2(s,i,c),n=T(n),s=M(n)}return i}function S4(t){return t.node.value}function d0(t,e){t.node.value=e,xt(t)}function E7(t){return t.node.childCount>0}function Ph(t){return S4(t)===void 0&&!E7(t)}function Z3(t,e){U(t.node.children,(n,i)=>{e(new s2(n,t,i))})}function H7(t,e,n,i){n&&!i&&e(t),Z3(t,s=>{H7(s,e,!0,i)}),n&&i&&e(t)}function qh(t,e,n){let i=n?t:t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function d2(t){return new V(t.parent===null?t.name:d2(t.parent)+"/"+t.name)}function xt(t){t.parent!==null&&Uh(t.parent,t.name,t)}function Uh(t,e,n){let i=Ph(n),s=v1(t.node.children,e);i&&s?(delete t.node.children[e],t.node.childCount--,xt(t)):!i&&!s&&(t.node.children[e]=n.node,t.node.childCount++,xt(t))}var jh=/[\[\].#$\/\u0000-\u001F\u007F]/,Wh=/[\[\].#$\u0000-\u001F\u007F]/,F6=10*1024*1024,X3=function(t){return typeof t=="string"&&t.length!==0&&!jh.test(t)},x7=function(t){return typeof t=="string"&&t.length!==0&&!Wh.test(t)},Gh=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),x7(t)},c2=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!U3(t)||t&&typeof t=="object"&&v1(t,".sv")},O1=function(t,e,n,i){i&&e===void 0||f2(e1(t,"value"),e,n)},f2=function(t,e,n){let i=n instanceof V?new X6(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+b4(i));if(typeof e=="function")throw new Error(t+"contains a function "+b4(i)+" with contents = "+e.toString());if(U3(e))throw new Error(t+"contains "+e.toString()+" "+b4(i));if(typeof e=="string"&&e.length>F6/3&&_e(e)>F6)throw new Error(t+"contains a string greater than "+F6+" utf8 bytes "+b4(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,c=!1;if(U(e,(o,r)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(c=!0,!X3(o)))throw new Error(t+" contains an invalid key ("+o+") "+b4(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);y9(i,o),f2(t,r,i),b9(i)}),s&&c)throw new Error(t+' contains ".value" child '+b4(i)+" in addition to actual children.")}},$h=function(t,e){let n,i;for(n=0;n<e.length;n++){i=e[n];let c=Ye(i);for(let o=0;o<c.length;o++)if(!(c[o]===".priority"&&o===c.length-1)){if(!X3(c[o]))throw new Error(t+"contains an invalid key ("+c[o]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(M9);let s=null;for(n=0;n<e.length;n++){if(i=e[n],s!==null&&m1(s,i))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+i.toString());s=i}},S7=function(t,e,n,i){if(i&&e===void 0)return;let s=e1(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");let c=[];U(e,(o,r)=>{let a=new V(o);if(f2(s,r,I(n,a)),Yt(a)===".priority"&&!c2(r))throw new Error(s+"contains an invalid value for '"+a.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");c.push(a)}),$h(s,c)},f0=function(t,e,n){if(!(n&&e===void 0)){if(U3(e))throw new Error(e1(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!c2(e))throw new Error(e1(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},v2=function(t,e,n,i){if(!(i&&n===void 0)&&!X3(n))throw new Error(e1(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},le=function(t,e,n,i){if(!(i&&n===void 0)&&!x7(n))throw new Error(e1(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Kh=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),le(t,e,n,i)},l1=function(t,e){if(M(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},T7=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!X3(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!Gh(n))throw new Error(e1(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var St=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function J3(t,e){let n=null;for(let i=0;i<e.length;i++){let s=e[i],c=s.getPath();n!==null&&!Qt(c,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:c}),n.events.push(s)}n&&t.eventLists_.push(n)}function L7(t,e,n){J3(t,n),A7(t,i=>Qt(i,e))}function h1(t,e,n){J3(t,n),A7(t,i=>m1(i,e)||m1(e,i))}function A7(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){let s=t.eventLists_[i];if(s){let c=s.path;e(c)?(Yh(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Yh(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let i=n.getEventRunner();V4&&q("event: "+n.toString()),oe(i)}}}var O7="repo_interrupt",Qh=25,Tt=class{constructor(e,n,i,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new St,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=E3(),this.transactionQueueTree_=new s2,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function Zh(t,e,n){if(t.stats_=Gt(t.repoInfo_),t.forceRestClient_||Ql())t.server_=new lt(t.repoInfo_,(i,s,c,o)=>{xc(t,i,s,c,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Sc(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{B(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new Zt(t.repoInfo_,e,(i,s,c,o)=>{xc(t,i,s,c,o)},i=>{Sc(t,i)},i=>{Xh(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=Xl(t.repoInfo_,()=>new vt(t.stats_,t.server_)),t.infoData_=new ht,t.infoSyncTree_=new k3({startListening:(i,s,c,o)=>{let r=[],a=t.infoData_.getNode(i._path);return a.isEmpty()||(r=u2(t.infoSyncTree_,i._path,a),setTimeout(()=>{o("ok")},0)),r},stopListening:()=>{}}),v0(t,"connected",!1),t.serverSyncTree_=new k3({startListening:(i,s,c,o)=>(t.server_.listen(i,c,s,(r,a)=>{let l=o(r,a);h1(t.eventQueue_,i._path,l)}),[]),stopListening:(i,s)=>{t.server_.unlisten(i,s)}})}function I7(t){let n=t.infoData_.getNode(new V(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function m2(t){return Rh({timestamp:I7(t)})}function xc(t,e,n,i,s){t.dataUpdateCount++;let c=new V(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(i){let a=ge(n,l=>k(l));o=Ah(t.serverSyncTree_,c,a,s)}else{let a=k(n);o=M7(t.serverSyncTree_,c,a,s)}else if(i){let a=ge(n,l=>k(l));o=Sh(t.serverSyncTree_,c,a)}else{let a=k(n);o=u2(t.serverSyncTree_,c,a)}let r=c;o.length>0&&(r=se(t,c)),h1(t.eventQueue_,r,o)}function Sc(t,e){v0(t,"connected",e),e===!1&&tu(t)}function Xh(t,e){U(e,(n,i)=>{v0(t,n,i)})}function v0(t,e,n){let i=new V("/.info/"+e),s=k(n);t.infoData_.updateSnapshot(i,s);let c=u2(t.infoSyncTree_,i,s);h1(t.eventQueue_,i,c)}function e8(t){return t.nextWriteId_++}function Jh(t,e,n){let i=Oh(t.serverSyncTree_,e);return i!=null?Promise.resolve(i):t.server_.get(e).then(s=>{let c=k(s).withIndex(e._queryParams.getIndex());Vt(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=u2(t.serverSyncTree_,e._path,c);else{let r=i2(t.serverSyncTree_,e);o=M7(t.serverSyncTree_,e._path,c,r)}return h1(t.eventQueue_,e._path,o),B3(t.serverSyncTree_,e,n,null,!0),c},s=>(he(t,"get for query "+B(e)+" failed: "+s),Promise.reject(new Error(s))))}function m0(t,e,n,i,s){he(t,"set",{path:e.toString(),value:n,priority:i});let c=m2(t),o=k(n,i),r=K3(t.serverSyncTree_,e),a=h0(o,r,c),l=e8(t),h=o0(t.serverSyncTree_,e,a,l,!0);J3(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(d,v)=>{let m=d==="ok";m||$("set at "+e+" failed: "+d);let w=e4(t.serverSyncTree_,l,!m);h1(t.eventQueue_,e,w),o4(t,s,d,v)});let u=g0(t,e);se(t,u),h1(t.eventQueue_,u,[])}function eu(t,e,n,i){he(t,"update",{path:e.toString(),value:n});let s=!0,c=m2(t),o={};if(U(n,(r,a)=>{s=!1,o[r]=V7(I(e,r),k(a),t.serverSyncTree_,c)}),s)q("update() called with empty data.  Don't do anything."),o4(t,i,"ok",void 0);else{let r=e8(t),a=xh(t.serverSyncTree_,e,o,r);J3(t.eventQueue_,a),t.server_.merge(e.toString(),n,(l,h)=>{let u=l==="ok";u||$("update at "+e+" failed: "+l);let d=e4(t.serverSyncTree_,r,!u),v=d.length>0?se(t,e):e;h1(t.eventQueue_,v,d),o4(t,i,l,h)}),U(n,l=>{let h=g0(t,I(e,l));se(t,h)}),h1(t.eventQueue_,e,[])}}function tu(t){he(t,"onDisconnectEvents");let e=m2(t),n=E3();dt(t.onDisconnect_,C(),(s,c)=>{let o=V7(s,c,t.serverSyncTree_,e);re(n,s,o)});let i=[];dt(n,C(),(s,c)=>{i=i.concat(u2(t.serverSyncTree_,s,c));let o=g0(t,s);se(t,o)}),t.onDisconnect_=E3(),h1(t.eventQueue_,C(),i)}function nu(t,e,n){t.server_.onDisconnectCancel(e.toString(),(i,s)=>{i==="ok"&&ut(t.onDisconnect_,e),o4(t,n,i,s)})}function Tc(t,e,n,i){let s=k(n);t.server_.onDisconnectPut(e.toString(),s.val(!0),(c,o)=>{c==="ok"&&re(t.onDisconnect_,e,s),o4(t,i,c,o)})}function iu(t,e,n,i,s){let c=k(n,i);t.server_.onDisconnectPut(e.toString(),c.val(!0),(o,r)=>{o==="ok"&&re(t.onDisconnect_,e,c),o4(t,s,o,r)})}function su(t,e,n,i){if(L2(n)){q("onDisconnect().update() called with empty data.  Don't do anything."),o4(t,i,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(s,c)=>{s==="ok"&&U(n,(o,r)=>{let a=k(r);re(t.onDisconnect_,I(e,o),a)}),o4(t,i,s,c)})}function cu(t,e,n){let i;M(e._path)===".info"?i=Vt(t.infoSyncTree_,e,n):i=Vt(t.serverSyncTree_,e,n),L7(t.eventQueue_,e._path,i)}function Lt(t,e,n){let i;M(e._path)===".info"?i=B3(t.infoSyncTree_,e,n):i=B3(t.serverSyncTree_,e,n),L7(t.eventQueue_,e._path,i)}function k7(t){t.persistentConnection_&&t.persistentConnection_.interrupt(O7)}function ou(t){t.persistentConnection_&&t.persistentConnection_.resume(O7)}function he(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),q(n,...e)}function o4(t,e,n,i){e&&oe(()=>{if(n==="ok")e(null);else{let s=(n||"error").toUpperCase(),c=s;i&&(c+=": "+i);let o=new Error(c);o.code=s,e(o)}})}function ru(t,e,n,i,s,c){he(t,"transaction on "+e);let o={path:e,update:n,onComplete:i,status:null,order:Uc(),applyLocally:c,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},r=p0(t,e,void 0);o.currentInputSnapshot=r;let a=o.update(r.val());if(a===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{f2("transaction failed: Data returned ",a,o.path),o.status=0;let l=Q3(t.transactionQueueTree_,e),h=S4(l)||[];h.push(o),d0(l,h);let u;typeof a=="object"&&a!==null&&v1(a,".priority")?(u=G1(a,".priority"),f(c2(u),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):u=(K3(t.serverSyncTree_,e)||z.EMPTY_NODE).getPriority().val();let d=m2(t),v=k(a,u),m=h0(v,r,d);o.currentOutputSnapshotRaw=v,o.currentOutputSnapshotResolved=m,o.currentWriteId=e8(t);let w=o0(t.serverSyncTree_,e,m,o.currentWriteId,o.applyLocally);h1(t.eventQueue_,e,w),t8(t,t.transactionQueueTree_)}}function p0(t,e,n){return K3(t.serverSyncTree_,e,n)||z.EMPTY_NODE}function t8(t,e=t.transactionQueueTree_){if(e||n8(t,e),S4(e)){let n=D7(t,e);f(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&au(t,d2(e),n)}else E7(e)&&Z3(e,n=>{t8(t,n)})}function au(t,e,n){let i=n.map(l=>l.currentWriteId),s=p0(t,e,i),c=s,o=s.hash();for(let l=0;l<n.length;l++){let h=n[l];f(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;let u=Z(e,h.path);c=c.updateChild(u,h.currentOutputSnapshotRaw)}let r=c.val(!0),a=e;t.server_.put(a.toString(),r,l=>{he(t,"transaction put response",{path:a.toString(),status:l});let h=[];if(l==="ok"){let u=[];for(let d=0;d<n.length;d++)n[d].status=2,h=h.concat(e4(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&u.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();n8(t,Q3(t.transactionQueueTree_,e)),t8(t,t.transactionQueueTree_),h1(t.eventQueue_,e,h);for(let d=0;d<u.length;d++)oe(u[d])}else{if(l==="datastale")for(let u=0;u<n.length;u++)n[u].status===3?n[u].status=4:n[u].status=0;else{$("transaction at "+a.toString()+" failed: "+l);for(let u=0;u<n.length;u++)n[u].status=4,n[u].abortReason=l}se(t,e)}},o)}function se(t,e){let n=B7(t,e),i=d2(n),s=D7(t,n);return lu(t,s,i),i}function lu(t,e,n){if(e.length===0)return;let i=[],s=[],o=e.filter(r=>r.status===0).map(r=>r.currentWriteId);for(let r=0;r<e.length;r++){let a=e[r],l=Z(n,a.path),h=!1,u;if(f(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)h=!0,u=a.abortReason,s=s.concat(e4(t.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=Qh)h=!0,u="maxretry",s=s.concat(e4(t.serverSyncTree_,a.currentWriteId,!0));else{let d=p0(t,a.path,o);a.currentInputSnapshot=d;let v=e[r].update(d.val());if(v!==void 0){f2("transaction failed: Data returned ",v,a.path);let m=k(v);typeof v=="object"&&v!=null&&v1(v,".priority")||(m=m.updatePriority(d.getPriority()));let x=a.currentWriteId,s1=m2(t),c1=h0(m,d,s1);a.currentOutputSnapshotRaw=m,a.currentOutputSnapshotResolved=c1,a.currentWriteId=e8(t),o.splice(o.indexOf(x),1),s=s.concat(o0(t.serverSyncTree_,a.path,c1,a.currentWriteId,a.applyLocally)),s=s.concat(e4(t.serverSyncTree_,x,!0))}else h=!0,u="nodata",s=s.concat(e4(t.serverSyncTree_,a.currentWriteId,!0))}h1(t.eventQueue_,n,s),s=[],h&&(e[r].status=2,function(d){setTimeout(d,Math.floor(0))}(e[r].unwatcher),e[r].onComplete&&(u==="nodata"?i.push(()=>e[r].onComplete(null,!1,e[r].currentInputSnapshot)):i.push(()=>e[r].onComplete(new Error(u),!1,null))))}n8(t,t.transactionQueueTree_);for(let r=0;r<i.length;r++)oe(i[r]);t8(t,t.transactionQueueTree_)}function B7(t,e){let n,i=t.transactionQueueTree_;for(n=M(e);n!==null&&S4(i)===void 0;)i=Q3(i,n),e=T(e),n=M(e);return i}function D7(t,e){let n=[];return R7(t,e,n),n.sort((i,s)=>i.order-s.order),n}function R7(t,e,n){let i=S4(e);if(i)for(let s=0;s<i.length;s++)n.push(i[s]);Z3(e,s=>{R7(t,s,n)})}function n8(t,e){let n=S4(e);if(n){let i=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[i]=n[s],i++);n.length=i,d0(e,n.length>0?n:void 0)}Z3(e,i=>{n8(t,i)})}function g0(t,e){let n=d2(B7(t,e)),i=Q3(t.transactionQueueTree_,e);return qh(i,s=>{N6(t,s)}),N6(t,i),H7(i,s=>{N6(t,s)}),n}function N6(t,e){let n=S4(e);if(n){let i=[],s=[],c=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(f(c===o-1,"All SENT items should be at beginning of queue."),c=o,n[o].status=3,n[o].abortReason="set"):(f(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(e4(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));c===-1?d0(e,void 0):n.length=c+1,h1(t.eventQueue_,d2(e),s);for(let o=0;o<i.length;o++)oe(i[o])}}function hu(t){let e="",n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let s=n[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function uu(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):$(`Invalid query segment '${n}' in query '${t}'`)}return e}var At=function(t,e){let n=du(t),i=n.namespace;n.domain==="firebase.com"&&L1(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&L1("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||Pl();let s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new z3(n.host,n.secure,i,s,e,"",i!==n.subdomain),path:new V(n.pathString)}},du=function(t){let e="",n="",i="",s="",c="",o=!0,r="https",a=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(r=t.substring(0,l-1),t=t.substring(l+2));let h=t.indexOf("/");h===-1&&(h=t.length);let u=t.indexOf("?");u===-1&&(u=t.length),e=t.substring(0,Math.min(h,u)),h<u&&(s=hu(t.substring(h,u)));let d=uu(t.substring(Math.min(t.length,u)));l=e.indexOf(":"),l>=0?(o=r==="https"||r==="wss",a=parseInt(e.substring(l+1),10)):l=e.length;let v=e.slice(0,l);if(v.toLowerCase()==="localhost")n="localhost";else if(v.split(".").length<=2)n=v;else{let m=e.indexOf(".");i=e.substring(0,m).toLowerCase(),n=e.substring(m+1),c=i}"ns"in d&&(c=d.ns)}return{host:e,port:a,domain:n,subdomain:i,secure:o,scheme:r,pathString:s,namespace:c}};var Lc="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",fu=function(){let t=0,e=[];return function(n){let i=n===t;t=n;let s,c=new Array(8);for(s=7;s>=0;s--)c[s]=Lc.charAt(n%64),n=Math.floor(n/64);f(n===0,"Cannot push at time == 0");let o=c.join("");if(i){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)o+=Lc.charAt(e[s]);return f(o.length===20,"nextPushId: Length should be 20."),o}}();var D3=class{constructor(e,n,i,s){this.eventType=e,this.eventRegistration=n,this.snapshot=i,this.prevName=s}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+B(this.snapshot.exportVal())}},R3=class{constructor(e,n,i){this.eventRegistration=e,this.error=n,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var o2=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return f(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var F3=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new P;return nu(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){l1("OnDisconnect.remove",this._path);let e=new P;return Tc(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){l1("OnDisconnect.set",this._path),O1("OnDisconnect.set",e,this._path,!1);let n=new P;return Tc(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){l1("OnDisconnect.setWithPriority",this._path),O1("OnDisconnect.setWithPriority",e,this._path,!1),f0("OnDisconnect.setWithPriority",n,!1);let i=new P;return iu(this._repo,this._path,e,n,i.wrapCallback(()=>{})),i.promise}update(e){l1("OnDisconnect.update",this._path),S7("OnDisconnect.update",e,this._path,!1);let n=new P;return su(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var J=class t{constructor(e,n,i,s){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=s}get key(){return y(this._path)?null:Yt(this._path)}get ref(){return new u1(this._repo,this._path)}get _queryIdentifier(){let e=gc(this._queryParams),n=Wt(e);return n==="{}"?"default":n}get _queryObject(){return gc(this._queryParams)}isEqual(e){if(e=K(e),!(e instanceof t))return!1;let n=this._repo===e._repo,i=Qt(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+w9(this._path)}};function i8(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function a4(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===T1){let i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==i4)throw new Error(i);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==N1)throw new Error(i);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===L){if(e!=null&&!c2(e)||n!=null&&!c2(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(f(t.getIndex()instanceof Qe||t.getIndex()===Jt,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function s8(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var u1=class t extends J{constructor(e,n){super(e,n,new e2,!1)}get parent(){let e=t7(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},ce=class t{constructor(e,n,i){this._node=e,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new V(e),i=r4(this.ref,e);return new t(this._node.getChild(n),i,L)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new t(s,r4(this.ref,i),L)))}hasChild(e){let n=new V(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function _0(t,e){return t=K(t),t._checkNotDeleted("ref"),e!==void 0?r4(t._root,e):t._root}function z0(t,e){t=K(t),t._checkNotDeleted("refFromURL");let n=At(e,t._repo.repoInfo_.nodeAdmin);T7("refFromURL",n);let i=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&i.host!==t._repo.repoInfo_.host&&L1("refFromURL: Host name does not match the current database: (found "+i.host+" but expected "+t._repo.repoInfo_.host+")"),_0(t,n.path.toString())}function r4(t,e){return t=K(t),M(t._path)===null?Kh("child","path",e,!1):le("child","path",e,!1),new u1(t._repo,I(t._path,e))}function F7(t,e){t=K(t),l1("push",t._path),O1("push",e,t._path,!0);let n=I7(t._repo),i=fu(n),s=r4(t,i),c=r4(t,i),o;return e!=null?o=c8(c,e).then(()=>c):o=Promise.resolve(c),s.then=o.then.bind(o),s.catch=o.then.bind(o,void 0),s}function N7(t){return l1("remove",t._path),c8(t,null)}function c8(t,e){t=K(t),l1("set",t._path),O1("set",e,t._path,!1);let n=new P;return m0(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function P7(t,e){t=K(t),l1("setPriority",t._path),f0("setPriority",e,!1);let n=new P;return m0(t._repo,I(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function q7(t,e,n){if(l1("setWithPriority",t._path),O1("setWithPriority",e,t._path,!1),f0("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let i=new P;return m0(t._repo,t._path,e,n,i.wrapCallback(()=>{})),i.promise}function U7(t,e){S7("update",e,t._path,!1);let n=new P;return eu(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function j7(t){t=K(t);let e=new o2(()=>{}),n=new r2(e);return Jh(t._repo,t,n).then(i=>new ce(i,new u1(t._repo,t._path),t._queryParams.getIndex()))}var r2=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let i=n._queryParams.getIndex();return new D3("value",this,new ce(e.snapshotNode,new u1(n._repo,n._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new R3(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},N3=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new R3(this,e,n):null}createEvent(e,n){f(e.childName!=null,"Child events should have a childName.");let i=r4(new u1(n._repo,n._path),e.childName),s=n._queryParams.getIndex();return new D3(e.type,this,new ce(e.snapshotNode,i,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function p2(t,e,n,i,s){let c;if(typeof i=="object"&&(c=void 0,s=i),typeof i=="function"&&(c=i),s&&s.onlyOnce){let a=n,l=(h,u)=>{Lt(t._repo,t,r),a(h,u)};l.userCallback=n.userCallback,l.context=n.context,n=l}let o=new o2(n,c||void 0),r=e==="value"?new r2(o):new N3(e,o);return cu(t._repo,t,r),()=>Lt(t._repo,t,r)}function o8(t,e,n,i){return p2(t,"value",e,n,i)}function w0(t,e,n,i){return p2(t,"child_added",e,n,i)}function M0(t,e,n,i){return p2(t,"child_changed",e,n,i)}function y0(t,e,n,i){return p2(t,"child_moved",e,n,i)}function b0(t,e,n,i){return p2(t,"child_removed",e,n,i)}function C0(t,e,n){let i=null,s=n?new o2(n):null;e==="value"?i=new r2(s):e&&(i=new N3(e,s)),Lt(t._repo,t,i)}var d1=class{},P3=class extends d1{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){O1("endAt",this._value,e._path,!0);let n=at(e._queryParams,this._value,this._key);if(s8(n),a4(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new J(e._repo,e._path,n,e._orderByCalled)}};function W7(t,e){return v2("endAt","key",e,!0),new P3(t,e)}var Ot=class extends d1{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){O1("endBefore",this._value,e._path,!1);let n=F9(e._queryParams,this._value,this._key);if(s8(n),a4(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new J(e._repo,e._path,n,e._orderByCalled)}};function G7(t,e){return v2("endBefore","key",e,!0),new Ot(t,e)}var q3=class extends d1{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){O1("startAt",this._value,e._path,!0);let n=rt(e._queryParams,this._value,this._key);if(s8(n),a4(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new J(e._repo,e._path,n,e._orderByCalled)}};function $7(t=null,e){return v2("startAt","key",e,!0),new q3(t,e)}var It=class extends d1{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){O1("startAfter",this._value,e._path,!1);let n=R9(e._queryParams,this._value,this._key);if(s8(n),a4(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new J(e._repo,e._path,n,e._orderByCalled)}};function K7(t,e){return v2("startAfter","key",e,!0),new It(t,e)}var kt=class extends d1{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new J(e._repo,e._path,B9(e._queryParams,this._limit),e._orderByCalled)}};function Y7(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new kt(t)}var Bt=class extends d1{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new J(e._repo,e._path,D9(e._queryParams,this._limit),e._orderByCalled)}};function Q7(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Bt(t)}var Dt=class extends d1{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){i8(e,"orderByChild");let n=new V(this._path);if(y(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let i=new Qe(n),s=j3(e._queryParams,i);return a4(s),new J(e._repo,e._path,s,!0)}};function Z7(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return le("orderByChild","path",t,!1),new Dt(t)}var Rt=class extends d1{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){i8(e,"orderByKey");let n=j3(e._queryParams,T1);return a4(n),new J(e._repo,e._path,n,!0)}};function X7(){return new Rt}var Ft=class extends d1{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){i8(e,"orderByPriority");let n=j3(e._queryParams,L);return a4(n),new J(e._repo,e._path,n,!0)}};function J7(){return new Ft}var Nt=class extends d1{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){i8(e,"orderByValue");let n=j3(e._queryParams,Jt);return a4(n),new J(e._repo,e._path,n,!0)}};function eo(){return new Nt}var Pt=class extends d1{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(O1("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new P3(this._value,this._key)._apply(new q3(this._value,this._key)._apply(e))}};function to(t,e){return v2("equalTo","key",e,!0),new Pt(t,e)}function g1(t,...e){let n=K(t);for(let i of e)n=i._apply(n);return n}wh(u1);Vh(u1);var vu="FIREBASE_DATABASE_EMULATOR_HOST",qt={},mu=!1;function pu(t,e,n,i){t.repoInfo_=new z3(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),i&&(t.authTokenProvider_=i)}function V0(t,e,n,i,s){let c=i||t.options.databaseURL;c===void 0&&(t.options.projectId||L1("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),q("Using default host for project ",t.options.projectId),c=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=At(c,s),r=o.repoInfo,a,l;typeof process<"u"&&process.env&&(l=process.env[vu]),l?(a=!0,c=`http://${l}?ns=${r.namespace}`,o=At(c,s),r=o.repoInfo):a=!o.repoInfo.secure;let h=s&&a?new Ue(Ue.OWNER):new K6(t.name,t.options,e);T7("Invalid Firebase Database URL",o),y(o.path)||L1("Database URL must point to the root of a Firebase Database (not including a child path).");let u=_u(r,t,h,new $6(t.name,n));return new Ut(u,t)}function gu(t,e){let n=qt[e];(!n||n[t.key]!==t)&&L1(`Database ${e}(${t.repoInfo_}) has already been deleted.`),k7(t),delete n[t.key]}function _u(t,e,n,i){let s=qt[e.name];s||(s={},qt[e.name]=s);let c=s[t.toURLString()];return c&&L1("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),c=new Tt(t,mu,n,i),s[t.toURLString()]=c,c}var Ut=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Zh(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new u1(this._repo,C())),this._rootInternal}_delete(){return this._rootInternal!==null&&(gu(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&L1("Cannot call "+e+" on a deleted database.")}};function no(){e7.IS_TRANSPORT_INITIALIZED&&$("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function io(){no(),Ke.forceDisallow()}function so(){no(),Y4.forceDisallow(),Ke.forceAllow()}function co(t,e,n,i={}){t=K(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&L1("Cannot call useEmulator() after instance has already been initialized.");let s=t._repoInternal,c;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&L1('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),c=new Ue(Ue.OWNER);else if(i.mockUserToken){let o=typeof i.mockUserToken=="string"?i.mockUserToken:Y0(i.mockUserToken,t.app.options.projectId);c=new Ue(o)}pu(s,e,n,c)}function oo(t){t=K(t),t._checkNotDeleted("goOffline"),k7(t._repo)}function ro(t){t=K(t),t._checkNotDeleted("goOnline"),ou(t._repo)}function ao(t,e){Wc(t,e)}function zu(t){Kt(on),ze(new B1("database",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),c=e.getProvider("app-check-internal");return V0(i,s,c,n)},"PUBLIC").setMultipleInstances(!0)),$1(nc,ic,t),$1(nc,ic,"esm2017")}var wu={".sv":"timestamp"};function lo(){return wu}function ho(t){return{".sv":{increment:t}}}var jt=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function uo(t,e,n){var i;if(t=K(t),l1("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let s=(i=n?.applyLocally)!==null&&i!==void 0?i:!0,c=new P,o=(a,l,h)=>{let u=null;a?c.reject(a):(u=new ce(h,new u1(t._repo,t._path),L),c.resolve(new jt(l,u)))},r=o8(t,()=>{});return ru(t._repo,t._path,e,o,r,s),c.promise}Zt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Zt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};t9(Ac.default.Client);zu("node");var Mu="@firebase/database-compat",yu="1.0.4";var bu=new B4("@firebase/database-compat"),fo=function(t){let e="FIREBASE WARNING: "+t;bu.warn(e)};var Cu=function(t,e,n,i){if(!(i&&n===void 0)&&typeof n!="boolean")throw new Error(e1(t,e)+"must be a boolean.")},Vu=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(e1(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var E0=class{constructor(e){this._delegate=e}cancel(e){_("OnDisconnect.cancel",0,1,arguments.length),D("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),i=>e(i)),n}remove(e){_("OnDisconnect.remove",0,1,arguments.length),D("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),i=>e(i)),n}set(e,n){_("OnDisconnect.set",1,2,arguments.length),D("OnDisconnect.set","onComplete",n,!0);let i=this._delegate.set(e);return n&&i.then(()=>n(null),s=>n(s)),i}setWithPriority(e,n,i){_("OnDisconnect.setWithPriority",2,3,arguments.length),D("OnDisconnect.setWithPriority","onComplete",i,!0);let s=this._delegate.setWithPriority(e,n);return i&&s.then(()=>i(null),c=>i(c)),s}update(e,n){if(_("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let s={};for(let c=0;c<e.length;++c)s[""+c]=e[c];e=s,fo("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}D("OnDisconnect.update","onComplete",n,!0);let i=this._delegate.update(e);return n&&i.then(()=>n(null),s=>n(s)),i}};var H0=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return _("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var T4=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return _("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return _("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return _("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return _("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return _("DataSnapshot.child",0,1,arguments.length),e=String(e),le("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return _("DataSnapshot.hasChild",1,1,arguments.length),le("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return _("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return _("DataSnapshot.forEach",1,1,arguments.length),D("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return _("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return _("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return _("DataSnapshot.ref",0,0,arguments.length),new P1(this._database,this._delegate.ref)}get ref(){return this.getRef()}},r8=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,i,s){var c;_("Query.on",2,4,arguments.length),D("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",i,s),r=(l,h)=>{n.call(o.context,new T4(this.database,l),h)};r.userCallback=n,r.context=o.context;let a=(c=o.cancel)===null||c===void 0?void 0:c.bind(o.context);switch(e){case"value":return o8(this._delegate,r,a),n;case"child_added":return w0(this._delegate,r,a),n;case"child_removed":return b0(this._delegate,r,a),n;case"child_changed":return M0(this._delegate,r,a),n;case"child_moved":return y0(this._delegate,r,a),n;default:throw new Error(e1("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,i){if(_("Query.off",0,3,arguments.length),Vu("Query.off",e,!0),D("Query.off","callback",n,!0),m8("Query.off","context",i,!0),n){let s=()=>{};s.userCallback=n,s.context=i,C0(this._delegate,e,s)}else C0(this._delegate,e)}get(){return j7(this._delegate).then(e=>new T4(this.database,e))}once(e,n,i,s){_("Query.once",1,4,arguments.length),D("Query.once","callback",n,!0);let c=t.getCancelAndContextArgs_("Query.once",i,s),o=new P,r=(l,h)=>{let u=new T4(this.database,l);n&&n.call(c.context,u,h),o.resolve(u)};r.userCallback=n,r.context=c.context;let a=l=>{c.cancel&&c.cancel.call(c.context,l),o.reject(l)};switch(e){case"value":o8(this._delegate,r,a,{onlyOnce:!0});break;case"child_added":w0(this._delegate,r,a,{onlyOnce:!0});break;case"child_removed":b0(this._delegate,r,a,{onlyOnce:!0});break;case"child_changed":M0(this._delegate,r,a,{onlyOnce:!0});break;case"child_moved":y0(this._delegate,r,a,{onlyOnce:!0});break;default:throw new Error(e1("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return _("Query.limitToFirst",1,1,arguments.length),new t(this.database,g1(this._delegate,Y7(e)))}limitToLast(e){return _("Query.limitToLast",1,1,arguments.length),new t(this.database,g1(this._delegate,Q7(e)))}orderByChild(e){return _("Query.orderByChild",1,1,arguments.length),new t(this.database,g1(this._delegate,Z7(e)))}orderByKey(){return _("Query.orderByKey",0,0,arguments.length),new t(this.database,g1(this._delegate,X7()))}orderByPriority(){return _("Query.orderByPriority",0,0,arguments.length),new t(this.database,g1(this._delegate,J7()))}orderByValue(){return _("Query.orderByValue",0,0,arguments.length),new t(this.database,g1(this._delegate,eo()))}startAt(e=null,n){return _("Query.startAt",0,2,arguments.length),new t(this.database,g1(this._delegate,$7(e,n)))}startAfter(e=null,n){return _("Query.startAfter",0,2,arguments.length),new t(this.database,g1(this._delegate,K7(e,n)))}endAt(e=null,n){return _("Query.endAt",0,2,arguments.length),new t(this.database,g1(this._delegate,W7(e,n)))}endBefore(e=null,n){return _("Query.endBefore",0,2,arguments.length),new t(this.database,g1(this._delegate,G7(e,n)))}equalTo(e,n){return _("Query.equalTo",1,2,arguments.length),new t(this.database,g1(this._delegate,to(e,n)))}toString(){return _("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return _("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(_("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,i){let s={cancel:void 0,context:void 0};if(n&&i)s.cancel=n,D(e,"cancel",s.cancel,!0),s.context=i,m8(e,"context",s.context,!0);else if(n)if(typeof n=="object"&&n!==null)s.context=n;else if(typeof n=="function")s.cancel=n;else throw new Error(e1(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return s}get ref(){return new P1(this.database,new u1(this._delegate._repo,this._delegate._path))}},P1=class t extends r8{constructor(e,n){super(e,new J(n._repo,n._path,new e2,!1)),this.database=e,this._delegate=n}getKey(){return _("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return _("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,r4(this._delegate,e))}getParent(){_("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return _("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){_("Reference.set",1,2,arguments.length),D("Reference.set","onComplete",n,!0);let i=c8(this._delegate,e);return n&&i.then(()=>n(null),s=>n(s)),i}update(e,n){if(_("Reference.update",1,2,arguments.length),Array.isArray(e)){let s={};for(let c=0;c<e.length;++c)s[""+c]=e[c];e=s,fo("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}l1("Reference.update",this._delegate._path),D("Reference.update","onComplete",n,!0);let i=U7(this._delegate,e);return n&&i.then(()=>n(null),s=>n(s)),i}setWithPriority(e,n,i){_("Reference.setWithPriority",2,3,arguments.length),D("Reference.setWithPriority","onComplete",i,!0);let s=q7(this._delegate,e,n);return i&&s.then(()=>i(null),c=>i(c)),s}remove(e){_("Reference.remove",0,1,arguments.length),D("Reference.remove","onComplete",e,!0);let n=N7(this._delegate);return e&&n.then(()=>e(null),i=>e(i)),n}transaction(e,n,i){_("Reference.transaction",1,3,arguments.length),D("Reference.transaction","transactionUpdate",e,!1),D("Reference.transaction","onComplete",n,!0),Cu("Reference.transaction","applyLocally",i,!0);let s=uo(this._delegate,e,{applyLocally:i}).then(c=>new H0(c.committed,new T4(this.database,c.snapshot)));return n&&s.then(c=>n(null,c.committed,c.snapshot),c=>n(c,!1,null)),s}setPriority(e,n){_("Reference.setPriority",1,2,arguments.length),D("Reference.setPriority","onComplete",n,!0);let i=P7(this._delegate,e);return n&&i.then(()=>n(null),s=>n(s)),i}push(e,n){_("Reference.push",0,2,arguments.length),D("Reference.push","onComplete",n,!0);let i=F7(this._delegate,e),s=i.then(o=>new t(this.database,o));n&&s.then(()=>n(null),o=>n(o));let c=new t(this.database,i);return c.then=s.then.bind(s),c.catch=s.catch.bind(s,void 0),c}onDisconnect(){return l1("Reference.onDisconnect",this._delegate._path),new E0(new F3(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var L4=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:io,forceLongPolling:so}}useEmulator(e,n,i={}){co(this._delegate,e,n,i)}ref(e){if(_("database.ref",0,1,arguments.length),e instanceof P1){let n=z0(this._delegate,e.toString());return new P1(this,n)}else{let n=_0(this._delegate,e);return new P1(this,n)}}refFromURL(e){_("database.refFromURL",1,1,arguments.length);let i=z0(this._delegate,e);return new P1(this,i)}goOffline(){return _("database.goOffline",0,0,arguments.length),oo(this._delegate)}goOnline(){return _("database.goOnline",0,0,arguments.length),ro(this._delegate)}};L4.ServerValue={TIMESTAMP:lo(),increment:t=>ho(t)};function Eu({app:t,url:e,version:n,customAuthImpl:i,customAppCheckImpl:s,namespace:c,nodeAdmin:o=!1}){Kt(n);let r=new p8("database-standalone"),a=new A2("auth-internal",r);a.setComponent(new B1("auth-internal",()=>i,"PRIVATE"));let l;return s&&(l=new A2("app-check-internal",r),l.setComponent(new B1("app-check-internal",()=>s,"PRIVATE"))),{instance:new L4(V0(t,a,l,e,o),t),namespace:c}}var Hu=Object.freeze({__proto__:null,initStandalone:Eu});var xu=L4.ServerValue;function Su(t){t.INTERNAL.registerComponent(new B1("database-compat",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app-compat").getImmediate(),s=e.getProvider("database").getImmediate({identifier:n});return new L4(s,i)},"PUBLIC").setServiceProps({Reference:P1,Query:r8,Database:L4,DataSnapshot:T4,enableLogging:ao,INTERNAL:Hu,ServerValue:xu}).setMultipleInstances(!0)),t.registerVersion(Mu,yu,"node")}Su(t1);function g2(t,e,n="on",i=_2){return new q1(s=>{let c=null;return c=t[n](e,(o,r)=>{i.schedule(()=>{s.next({snapshot:o,prevKey:r})}),n==="once"&&i.schedule(()=>s.complete())},o=>{i.schedule(()=>s.error(o))}),n==="on"?{unsubscribe(){c!=null&&t.off(e,c)}}:{unsubscribe(){}}}).pipe(G(s=>{let{snapshot:c,prevKey:o}=s,r=null;return c.exists()&&(r=c.key),{type:e,payload:c,prevKey:o,key:r}}),z2())}function Tu(t){return typeof t=="string"}function Lu(t){return typeof t.exportVal=="function"}function _o(t){return t==null}function zo(t){return typeof t.set=="function"}function vo(t,e){return zo(e)?e:t.ref(e)}function wo(t,e){if(Tu(t))return e.stringCase();if(zo(t))return e.firebaseCase();if(Lu(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function Mo(t){return(_o(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function yo(t,e,n){e=Mo(e);let i=e.map(s=>g2(t,s,"on",n));return ue(...i)}function Au(t,e,n){let i=yo(t,e).pipe(a8((s,c)=>[...s,c],[]));return Iu(t,i,n)}function Ou(t,e){return g2(t,"value","on",e).pipe(G(n=>{let i;return n.payload.forEach(s=>(i=s.key,!1)),{data:n,lastKeyToLoad:i}}))}function Iu(t,e,n){return Ou(t,n).pipe(D0(e),G(([s,c])=>{let o=s.lastKeyToLoad,r=c.map(a=>a.key);return{actions:c,lastKeyToLoad:o,loadedKeys:r}}),B0(s=>s.loadedKeys.indexOf(s.lastKeyToLoad)===-1),G(s=>s.actions))}function mo(t,e){return function(i,s){return wo(i,{stringCase:()=>t.child(i)[e](s),firebaseCase:()=>i[e](s),snapshotCase:()=>i.ref[e](s)})}}function ku(t){return function(n){return n?wo(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function Bu(t,e,n){return g2(t,"value","once",n).pipe(I1(i=>{let s=[z1(i)];return e.forEach(c=>s.push(g2(t,c,"on",n))),ue(...s).pipe(a8(Ru,[]))}),O0())}function bo(t,e){let n=t.length;for(let i=0;i<n;i++)if(t[i].payload.key===e)return i;return-1}function Du(t,e){if(_o(e))return 0;{let n=bo(t,e);return n===-1?t.length:n+1}}function Ru(t,e){let{payload:n,prevKey:i,key:s}=e,c=bo(t,s),o=Du(t,i);switch(e.type){case"value":if(e.payload?.exists()){let r=null;e.payload.forEach(a=>{let l={payload:a,type:"value",prevKey:r,key:a.key};return r=a.key,t=[...t,l],!1})}return t;case"child_added":if(c>-1)(t[c-1]?.key||null)!==i&&(t=t.filter(a=>a.payload.key!==n.key),t.splice(o,0,e));else{if(i==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(r=>r.payload.key!==n.key);case"child_changed":return t.map(r=>r.payload.key===s?e:r);case"child_moved":if(c>-1){let r=t.splice(c,1)[0];return t=t.slice(),t.splice(o,0,r),t}return t;default:return t}}function po(t,e,n){return e=Mo(e),Bu(t,e,n)}function Fu(t,e){let n=e.schedulers.outsideAngular,i=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:mo(i,"update"),set:mo(i,"set"),push:s=>i.push(s),remove:ku(i),snapshotChanges(s){return po(t,s,n).pipe(F1)},stateChanges(s){return yo(t,s,n).pipe(F1)},auditTrail(s){return Au(t,s,n).pipe(F1)},valueChanges(s,c){return po(t,s,n).pipe(G(r=>r.map(a=>c&&c.idField?f1(F({},a.payload.val()),{[c.idField]:a.key}):a.payload.val())),F1)}}}function go(t,e){return function(){return g2(t,"value","on",e)}}function Nu(t,e){return{query:t,snapshotChanges(){return go(t,e.schedulers.outsideAngular)().pipe(F1)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return go(t,e.schedulers.outsideAngular)().pipe(F1,G(i=>i.payload.exists()?i.payload.val():null))}}}var Pu=new H("angularfire2.realtimeDatabaseURL"),qu=new H("angularfire2.database.use-emulator"),Uu=(()=>{class t{schedulers;database;constructor(n,i,s,c,o,r,a,l,h,u,d,v,m,w,x){this.schedulers=r;let s1=a,c1=Ee(n,o,i);l&&J8(c1,o,h,d,v,m,u,w),this.database=J2(`${c1.name}.database.${s}`,"AngularFireDatabase",c1.name,()=>{let A=o.runOutsideAngular(()=>c1.database(s||void 0));return s1&&A.useEmulator(...s1),A},[s1])}list(n,i){let s=this.schedulers.ngZone.runOutsideAngular(()=>vo(this.database,n)),c=s;return i&&(c=i(s)),Fu(c,this)}object(n){let i=this.schedulers.ngZone.runOutsideAngular(()=>vo(this.database,n));return Nu(i,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(i){return new(i||t)(g(q4),g(U4,8),g(Pu,8),g(j1),g(k1),g(Z2),g(qu,8),g(_5,8),g($8,8),g(K8,8),g(Y8,8),g(Q8,8),g(Z8,8),g(X8,8),g(v4,8))};static \u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),cp=(()=>{class t{constructor(){t1.registerVersion("angularfire",P4.full,"rtdb-compat")}static \u0275fac=function(i){return new(i||t)};static \u0275mod=o1({type:t});static \u0275inj=r1({providers:[Uu]})}return t})();export{Pd as a,qd as b,Ud as c,jd as d,Hf as e,Ni as f,Yf as g,Qf as h,W2 as i,P2 as j,Xf as k,jr as l,Gr as m,Jf as n,ev as o,tv as p,wv as q,x1 as r,Uu as s,cp as t};
